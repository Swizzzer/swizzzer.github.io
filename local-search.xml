<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CryptoCTF 2024 Writeup</title>
    <link href="/CryptoCTF-2024.html"/>
    <url>/CryptoCTF-2024.html</url>
    
    <content type="html"><![CDATA[<p>CryptoCTFæœŸé—´åªé¡¾ç€å‡†å¤‡å›½èµ›ï¼Œç­‰åˆ°æƒ³èµ·æ¥çš„æ—¶å€™æ¯”èµ›å·²ç»ç»“æŸäº†...å§‘ä¸”æ…¢æ…¢å¤ç°å§</p><span id="more"></span><h2 id="easy">Easy</h2><h3 id="alibos">Alibos</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> d, flag<br><br>get_context().precision = <span class="hljs-number">1337</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">m, d</span>):<br><span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>(m)) &lt; d:<br>m = <span class="hljs-built_in">str</span>(m) + <span class="hljs-string">&#x27;1&#x27;</span> * (d - <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>(m)))<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">int</span>(m)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genkey</span>(<span class="hljs-params">d</span>):<br>skey = getRandomRange(<span class="hljs-number">10</span> ** (d - <span class="hljs-number">1</span>), <span class="hljs-number">10</span> ** d)<br>pkey = <span class="hljs-built_in">int</span>(<span class="hljs-number">10</span>**d * (sqrt(skey) - floor(sqrt(skey))))<br><span class="hljs-keyword">return</span> pkey, skey<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, pkey</span>):<br>m = pad(m, <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>(pkey)))<br>d = <span class="hljs-built_in">len</span>(<span class="hljs-built_in">str</span>(pkey))<br>c = (pkey + d ** <span class="hljs-number">2</span> * m) % (<span class="hljs-number">10</span> ** d)<br><span class="hljs-keyword">return</span> c<br><br>pkey, skey = genkey(d)<br><br>m = bytes_to_long(flag)<br>c = encrypt(m, pkey)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;pkey = <span class="hljs-subst">&#123;pkey&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;enc  = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>æ²¡ä»€ä¹ˆå¥½è¯´çš„ã€‚</p><blockquote><p>exp</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># sage</span><br>c = <br>pkey = <br>PR = Zmod(<span class="hljs-number">10</span>^<span class="hljs-number">313</span>)<br>d = <span class="hljs-number">313</span><br>m = PR(c-pkey)/PR(d^<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-comment"># 6170704326493336128242608193100736601774626903966803036318189045381903593682775829229200905376968543264526051111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111</span><br>m = <span class="hljs-number">617070432649333612824260819310073660177462690396680303631818904538190359368277582922920090537696854326452605</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment"># CCTF&#123;h0M3_m4De_cRyp70_5ySTeM_1N_CryptoCTF!!!&#125;</span><br></code></pre></td></tr></table></figure><h3 id="mashy">Mashy</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<br><span class="hljs-keyword">from</span> binascii <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> salt, flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">die</span>(<span class="hljs-params">*args</span>):<br>pr(*args)<br>quit()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pr</span>(<span class="hljs-params">*args</span>):<br>s = <span class="hljs-string">&quot; &quot;</span>.join(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">str</span>, args))<br>sys.stdout.write(s + <span class="hljs-string">&quot;\n&quot;</span>)<br>sys.stdout.flush()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sc</span>():<br><span class="hljs-keyword">return</span> sys.stdin.buffer.readline()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xor</span>(<span class="hljs-params">s1, s2</span>):<br><span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>([s1[_] ^ s2[_] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(s1))])<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>border = <span class="hljs-string">&quot;â”ƒ&quot;</span><br>pr(        <span class="hljs-string">&quot;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“&quot;</span>)<br>pr(border, <span class="hljs-string">&quot;.: Hi all, she did Mashy, you should do it too! Are you ready? :. &quot;</span>, border)<br>pr(        <span class="hljs-string">&quot;â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›&quot;</span>)<br><br>REC = []<br>cnt, STEP = <span class="hljs-number">0</span>, <span class="hljs-number">7</span><br>sh = md5(salt).digest()<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>pr(border, <span class="hljs-string">f&#x27;Please send your first input:  &#x27;</span>)<br>d1 = sc().strip()<br>pr(border, <span class="hljs-string">f&#x27;Please send your second input: &#x27;</span>)<br>d2 = sc().strip()<br><span class="hljs-keyword">try</span>:<br>d1 = hexlify(unhexlify(d1))<br>d2 = hexlify(unhexlify(d2))<br>h1 = md5(unhexlify(d1)).digest()<br>h2 = md5(unhexlify(d2)).digest()<br><span class="hljs-keyword">except</span>:<br>die(border, <span class="hljs-string">&#x27;Your inputs are not valid! Bye!!!&#x27;</span>)<br><span class="hljs-keyword">if</span> d1 != d2 <span class="hljs-keyword">and</span> d1 <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> REC <span class="hljs-keyword">and</span> d2 <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> REC:<br><span class="hljs-keyword">if</span> md5(xor(d1, d2)).hexdigest() != <span class="hljs-string">&#x27;ae09d7510659ca40eda3e45ca70e9606&#x27;</span>:<br><span class="hljs-keyword">if</span> hexlify(xor(xor(h1, h2), sh)) == <span class="hljs-string">b&#x27;a483b30944cbf762d4a3afc154aad825&#x27;</span>:<br>REC += [d1, d2]<br><span class="hljs-keyword">if</span> cnt == STEP:<br>die(border, <span class="hljs-string">f&#x27;Congrats! the flag: <span class="hljs-subst">&#123;flag&#125;</span>&#x27;</span>)<br>pr(border, <span class="hljs-string">&#x27;Good job, try next level :P&#x27;</span>)<br>cnt += <span class="hljs-number">1</span><br><span class="hljs-keyword">else</span>:<br>die(border, <span class="hljs-string">&#x27;Your input is not correct! Bye!&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>die(border, <span class="hljs-string">&#x27;No this one! Sorry!!&#x27;</span>)<br><span class="hljs-keyword">else</span>:<br>die(border, <span class="hljs-string">&#x27;Kidding me!? Bye!!&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>main()<br><br></code></pre></td></tr></table></figure><p>md5(salt)è¿˜è¦çŒœï¼ŒçœŸæ˜¯é…£ç•…æ·‹æ¼“çš„Cryptoå•ŠğŸ˜…ğŸ˜…ğŸ˜…</p><p>é‚£å°±ç›´æ¥èµŒa483b30944cbf762d4a3afc154aad825å°±æ˜¯md5(salt)ï¼Œæ²¡æƒ³åˆ°è¿˜çœŸæ˜¯...fastcollç§’äº†</p><h2 id="medium">Medium</h2><h3 id="melek">Melek</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env sage</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">msg, nbit</span>):<br>m, p = bytes_to_long(msg), getPrime(nbit)<br><span class="hljs-keyword">assert</span> m &lt; p<br>e, t = randint(<span class="hljs-number">1</span>, p - <span class="hljs-number">1</span>), randint(<span class="hljs-number">1</span>, nbit - <span class="hljs-number">1</span>)<br>C = [randint(<span class="hljs-number">0</span>, p - <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t - <span class="hljs-number">1</span>)] + [<span class="hljs-built_in">pow</span>(m, e, p)]<br>R.&lt;x&gt; = GF(p)[]<br>f = R(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t): f += x**(t - i - <span class="hljs-number">1</span>) * C[i]<br>P = [<span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(nbit))]<br>shuffle(P)<br>P = P[:t]<br>PT = [(a, f(a)) <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> [randint(<span class="hljs-number">1</span>, p - <span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t)]]<br><span class="hljs-keyword">return</span> e, p, PT<br><br>nbit = <span class="hljs-number">512</span><br>enc = encrypt(flag, nbit)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;enc = <span class="hljs-subst">&#123;enc&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>ç»™äº†ä¸€ä¸ª <span class="math inline">\(t-1\)</span>æ¬¡å¤šé¡¹å¼ä¸Šçš„tä¸ªç‚¹ï¼Œå¸¸æ•°é¡¹æ˜¯ <spanclass="math inline">\(m^{e}\bmod{p}\)</span>,ç›´æ¥Lagrangeæ’å€¼æ±‚å‡ºå¤šé¡¹å¼ç„¶åæ‹¿å¸¸æ•°é¡¹å»è§£RSAå°±è¡Œã€‚æ³¨æ„è¿™é‡Œeå’Œphinä¸äº’ç´ ã€‚</p><blockquote><p>exp</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-built_in">exec</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>).read())<br><br>e, p, PT = enc<br><br>R.&lt;x&gt; = PolynomialRing(Zmod(p))<br><br>poly = R.lagrange_polynomial(PT)<br>ct = poly.coefficients()[<span class="hljs-number">0</span>]<br><br><span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> GF(p)(ct).nth_root(e, <span class="hljs-built_in">all</span>=<span class="hljs-literal">True</span>):<br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(c)))<br><br><span class="hljs-comment"># b&#x27;CCTF&#123;SSS_iZ_4n_3fF!ciEn7_5ecr3T_ShArIn9_alGorItHm!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="nazdone">Nazdone</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> params, flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">sol</span>(<span class="hljs-params">m, a, z</span>):<br>p = m * (a - <span class="hljs-number">1</span>) % <span class="hljs-number">2</span> + <span class="hljs-number">1</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>R = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, a))<br>shuffle(R)<br><span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> R[:z]:<br>p += getRandomRange(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>) * m ** r<br><span class="hljs-keyword">if</span> isPrime(p):<br><span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">else</span>:<br>p = m * (a - <span class="hljs-number">1</span>) % <span class="hljs-number">2</span> + <span class="hljs-number">1</span><br><br><br>p, q, r = [sol(*params) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;007&#x27;</span>]<br>n = p * q * r<br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, params[<span class="hljs-number">0</span>] ** <span class="hljs-number">3</span> + params[<span class="hljs-number">2</span>] - <span class="hljs-number">2</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>å·²çŸ¥çš„ä¿¡æ¯åªæœ‰ç´ æ•°çš„ç”Ÿæˆæ–¹å¼ï¼Œéœ€è¦æƒ³åŠæ³•æŠŠnåˆ†è§£æ‰ã€‚</p><p>çœ‹åˆ°é¢˜ç›®é¦–å…ˆæƒ³åˆ°çš„æ˜¯mapleå‡ºè¿‡çš„ä¸€é“å¤šé¡¹å¼ä¸Šè¿›è¡ŒPollard's p-1åˆ†è§£çš„<ahref="https://github.com/maple3142/My-CTF-Challenges/tree/master/ImaginaryCTF%202023/Sus">é¢˜ç›®</a>ï¼Œä½†æ˜¯è¿™é‡Œå‹æ ¹ä¸çŸ¥é“ç”Ÿæˆå¤šé¡¹å¼é•¿ä»€ä¹ˆæ ·ï¼Œé‚£Pollard'sp-1åˆ†è§£è¿™æ¡è·¯å°±èµ°ä¸é€šäº†ã€‚</p><p>æ‰€ä»¥å¾—æƒ³åŠæ³•æŠŠparamsé‡Œçš„è‡³å°‘ä¸€é¡¹æ¢å¤å‡ºæ¥ã€‚äº‹å®ä¸Šé¢˜ç›®ç»™å‡ºçš„æ¡ä»¶æ˜¯åœ¨è¯´ï¼Œnçš„å› æ•°åœ¨mè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç³»æ•°éƒ½å¾ˆå°ï¼Œé™¤äº†æœ€ä½ä½ä»¥å¤–éƒ½æ˜¯0æˆ–1ï¼Œæ‰€ä»¥nåœ¨mè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç³»æ•°å…¶å®ä¹Ÿä¸ä¼šå¾ˆå¤§ã€‚ä»ç»Ÿè®¡å­¦ä¸Šæ¥çœ‹ï¼Œä¹Ÿå°±æ˜¯nåœ¨mè¿›åˆ¶è¡¨ç¤ºä¸‹çš„ç³»æ•°å’Œä¸ä¼šå¾ˆå¤§ï¼Œé‚£å°±å…ˆç”»ä¸ªå›¾ç»Ÿè®¡ä¸€ä¸‹må˜åŒ–æ—¶è¿™äº›ç³»æ•°å’Œçš„å˜åŒ–è¶‹åŠ¿ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># ipynb</span><br><span class="hljs-keyword">from</span> matplotlib <span class="hljs-keyword">import</span> pyplot <span class="hljs-keyword">as</span> plt<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base_expan</span>(<span class="hljs-params">n, m</span>):<br>    expan = []<br>    <span class="hljs-keyword">while</span> n!=<span class="hljs-number">0</span>:<br>        expan.append(n%m)<br>        n = n//m<br>    <span class="hljs-keyword">return</span> expan[::-<span class="hljs-number">1</span>]<br><br>n = <br>basesum = []<br><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>,<span class="hljs-number">1000</span>):<br>    bases = base_expan(n, m)<br>    basesum.append((m,<span class="hljs-built_in">sum</span>(bases)))<br><br>plt.plot(basesum)<br>plt.show()<br></code></pre></td></tr></table></figure><figure><img src="../assets/image-4.png" alt="å¾ˆæ˜æ˜¾çš„è·³å˜" /><figcaption aria-hidden="true">å¾ˆæ˜æ˜¾çš„è·³å˜</figcaption></figure><p>çœ‹ä¸‹è·³å˜ç‚¹å…·ä½“çš„å€¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># ipynb</span><br>msort = <span class="hljs-built_in">sorted</span>(basesum[<span class="hljs-number">300</span>:<span class="hljs-number">400</span>], key=<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-number">1</span>])<br><span class="hljs-built_in">print</span>(msort[<span class="hljs-number">0</span>])<br><br><span class="hljs-comment"># (361, 8497)</span><br></code></pre></td></tr></table></figure><p>çœ‹èµ·æ¥mæ˜¯361ï¼Œä½†æ˜¯éªŒè¯ä¸€ä¸‹å°±ä¼šå‘ç°è¿™æ ·æ±‚å¾—çš„ç³»æ•°å¹¶ä¸ç¬¦åˆé¢˜æ„ï¼š</p><figure><img src="../assets/image-5.png" alt="å¯„ï¼" /><figcaption aria-hidden="true">å¯„ï¼</figcaption></figure><p>è¿™æ ·æ±‚å‡ºæ¥çš„ç³»æ•°æœ‰ä¸åœ¨ <span class="math inline">\(\{0,1\}\)</span>å†…çš„æ•°ã€‚ä¸è¿‡å®ƒä»¬å…¨æ˜¯19çš„å€æ•°ï¼Œè€Œä¸”æˆ‘ä»¬æ­£å¥½è¿˜æœ‰ <spanclass="math inline">\(19^{2} == 361\)</span> ï¼Œé‚£å°±è¯´æ˜må…¶å®æ˜¯19ã€‚</p><p>æ¥ä¸‹æ¥å°±å¯ä»¥è€ƒè™‘åœ¨å¤šé¡¹å¼ç¯ä¸Šåˆ†è§£näº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># sage</span><br>n = <br>c = <br>m = <span class="hljs-number">19</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base_expan</span>(<span class="hljs-params">n, m</span>):<br>    expan = []<br>    <span class="hljs-keyword">while</span> n!=<span class="hljs-number">0</span>:<br>        expan.append(n%m)<br>        n = n//m<br>    <span class="hljs-keyword">return</span> expan<br><br>PR.&lt;x&gt; = PolynomialRing(ZZ)<br>f = PR(base_expan(n, m))<br>p = f.factor()<br><span class="hljs-built_in">print</span>(p)<br><span class="hljs-keyword">for</span> pp, i <span class="hljs-keyword">in</span> p:<br>    <span class="hljs-built_in">print</span>(pp(m))<br><br><span class="hljs-comment"># (x^106 + x^81 + x^77 + x^59 + x^47 + x^42 + x^22 + x^11 + x^7 + 2) * (x^107 + x^88 + x^51 + x^43 + x^37 + x^36 + x^35 + x^18 + x^14 + 2) * (x^108 + x^93 + x^74 + x^64 + x^31 + 2)</span><br><span class="hljs-comment"># 3530869780887683268140728773245395170410635845517928489976021534009516369358447511411853596093628646212566313257712207746790503704123439</span><br><span class="hljs-comment"># 67086525836865982094673880600810256005961617151283317566078153226175705789594094624822652838168627925461219084263915001883644637391279141</span><br><span class="hljs-comment"># 1274643990900453659882765495755380673132370043776742526720540623203930562265302201405804416214498793910236254519606076438989349099317154363</span><br></code></pre></td></tr></table></figure><p>ç„¶åè¿˜éœ€è¦çˆ†ä¸€ä¸‹zçš„å€¼å»å¾—åˆ°eã€‚æ ¹æ®æ¯ä¸ªå¤šé¡¹å¼å› å­çš„é¡¹æ•°å¯ä»¥çŒœåˆ°zå¤§æ¦‚åœ¨15å·¦å³ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>n = <br>c = <br>p = <br>q = <br>r = <br><br>m = <span class="hljs-number">19</span><br><span class="hljs-keyword">for</span> z <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">20</span>):<br>    <span class="hljs-keyword">try</span>:<br>        e = m ** <span class="hljs-number">3</span> + z - <span class="hljs-number">2</span><br>        phin = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)*(r-<span class="hljs-number">1</span>)<br>        d = inverse(e, phin)<br>        m_ = long_to_bytes(<span class="hljs-built_in">pow</span>(c, d, n))<br>        <span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;CCTF&#x27;</span> <span class="hljs-keyword">in</span> m_):<br>            <span class="hljs-built_in">print</span>(m_)<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">pass</span><br><br><span class="hljs-comment"># b&#x27;CCTF&#123;nUmb3r5_1N_D!fFerEn7_8As35_4r3_n!cE!?&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸã€‚(è¿˜å¥½æœ€åæ²¡å†æ¥ä¸€ä¸ªeå’Œphinä¸äº’ç´ ...)</p><h3 id="joe-19">Joe-19</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env sage</span><br><br><span class="hljs-keyword">from</span> GPT <span class="hljs-keyword">import</span> GPT6 <span class="hljs-comment"># deep fake </span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br>P = [GPT6(<span class="hljs-string">&#x27;A 512-bit prime appears in consecutive digits of e&#x27;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br>n, m = prod(P), bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">0x10001</span>, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>GPTçš„é¢˜é‚£å°±æ‰”ç»™GPTå§...4oæ¨¡å‹åå‡ºæ¥çš„ä»£ç é•¿ä¸‹é¢è¿™æ ·</p><blockquote><p>exp</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> mpmath<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> isprime<br><br><span class="hljs-comment"># è®¾ç½® mpmath è®¡ç®—ç²¾åº¦ï¼ˆå‡è®¾è®¡ç®— 20000 ä½å°æ•°ï¼‰</span><br><span class="hljs-comment"># è¿™é‡ŒAIé€‰å®šçš„æœ¬æ¥æ˜¯5000ï¼Œè¯•äº†å‡ æ¬¡å‘ç°åªæœ‰åœ¨15000-20000ä½ä¹‹é—´æ‰èƒ½æ‰¾åˆ°nçš„ç¬¬ä¸€ä¸ªè´¨å› æ•°</span><br>mpmath.mp.dps = <span class="hljs-number">20000</span><br>n = <br><span class="hljs-comment"># è·å–è‡ªç„¶å¸¸æ•° e çš„å°æ•°éƒ¨åˆ†ï¼ˆå»æ‰å°æ•°ç‚¹ï¼‰</span><br>e_str = <span class="hljs-built_in">str</span>(mpmath.e).replace(<span class="hljs-string">&#x27;.&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>)<br><br><span class="hljs-comment"># éå†æ¯ä¸€æ®µ 154 ä½é•¿çš„æ•°å­—ï¼Œå› ä¸º512bitåœ¨åè¿›åˆ¶ä¸‹é•¿åº¦çº¦ä¸º154</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e_str) - <span class="hljs-number">153</span>):<br>    number_str = e_str[i:i + <span class="hljs-number">154</span>]<br>    number = <span class="hljs-built_in">int</span>(number_str)<br>    <br>    <span class="hljs-keyword">if</span> isprime(number) <span class="hljs-keyword">and</span> (n % number == <span class="hljs-number">0</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found a prime number: <span class="hljs-subst">&#123;number&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">break</span>  <span class="hljs-comment"># æ‰¾åˆ°ä¸€ä¸ªå°±é€€å‡º</span><br><br><span class="hljs-comment"># 7728751393377105569802455757436190501772466214587592374418657530064998056688376964229825501195065837843125232135309371235243969149662310110328243570065781</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse,long_to_bytes<br><br>c = <br>p = <span class="hljs-number">7728751393377105569802455757436190501772466214587592374418657530064998056688376964229825501195065837843125232135309371235243969149662310110328243570065781</span><br><br>d = inverse(<span class="hljs-number">65537</span>,p-<span class="hljs-number">1</span>)<br>m = <span class="hljs-built_in">pow</span>(c,d,p)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment"># b&#x27;CCTF&#123;ASIS_h1r3_7aL3nT5_t0_cO1La8orAt3_!N_Crypto_CTF!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>å˜¿ï¼Œå¥¹è¿˜çœŸå°±åœ¨ç¬¬ä¸€ä¸ªè´¨å› æ•°çš„åœ°æ–¹å‡ºäº†ï¼</p><h3 id="honey">Honey</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> math <span class="hljs-keyword">import</span> sqrt<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_params</span>(<span class="hljs-params">nbit</span>):<br>p, Q, R, S = getPrime(nbit), [], [], []<br>d = <span class="hljs-built_in">int</span>(sqrt(nbit &lt;&lt; <span class="hljs-number">1</span>))<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(d):<br>Q.append(getRandomRange(<span class="hljs-number">1</span>, p - <span class="hljs-number">1</span>))<br>R.append(getRandomRange(<span class="hljs-number">0</span>, p - <span class="hljs-number">1</span>))<br>S.append(getRandomRange(<span class="hljs-number">0</span>, p - <span class="hljs-number">1</span>))<br><span class="hljs-keyword">return</span> p, Q, R, S<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, params</span>):<br>p, Q, R, S = params<br><span class="hljs-keyword">assert</span> m &lt; p<br>d = <span class="hljs-built_in">int</span>(sqrt(p.bit_length() &lt;&lt; <span class="hljs-number">1</span>))<br>C = []<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(d):<br>r, s = [getRandomNBitInteger(d) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-string">&#x27;01&#x27;</span>]<br>c = Q[_] * m + r * R[_] + s * S[_]<br>C.append(c % p)<br><span class="hljs-keyword">return</span> C<br><br><br>nbit = <span class="hljs-number">512</span><br>params = gen_params(<span class="hljs-number">512</span>)<br>m = bytes_to_long(flag)<br>C = encrypt(m, params)<br>f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;params_enc.txt&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>)<br>f.write(<span class="hljs-string">f&#x27;p = <span class="hljs-subst">&#123;params[<span class="hljs-number">0</span>]&#125;</span>\n&#x27;</span>)<br>f.write(<span class="hljs-string">f&#x27;Q = <span class="hljs-subst">&#123;params[<span class="hljs-number">1</span>]&#125;</span>\n&#x27;</span>)<br>f.write(<span class="hljs-string">f&#x27;R = <span class="hljs-subst">&#123;params[<span class="hljs-number">2</span>]&#125;</span>\n&#x27;</span>)<br>f.write(<span class="hljs-string">f&#x27;S = <span class="hljs-subst">&#123;params[<span class="hljs-number">3</span>]&#125;</span>\n&#x27;</span>)<br>f.write(<span class="hljs-string">f&#x27;C = <span class="hljs-subst">&#123;C&#125;</span>&#x27;</span>)<br>f.close()<br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“ <spanclass="math inline">\(mQ_{i}+r_{i}R_{i}+s_{i}S_{i}\equiv{C_{i}}\bmod{p}\)</span>,å¹¶ä¸”<span class="math inline">\(r_{i}, s_{i}\)</span>ç›¸è¾ƒäº <spanclass="math inline">\(Q, R, S\)</span>éƒ½æ˜¯æ¯”è¾ƒå°çš„ï¼Œæ‰€ä»¥å¾ˆè‡ªç„¶åœ°è€ƒè™‘LLLã€‚</p><p>å½¢å¼ä¸Šæ˜¯HNPçš„å¥—è·¯ï¼Œæ‹¿ä¸¤ç»„æ¶ˆå»må°±æ˜¯ç»å…¸HNPå½¢å¼ï¼Œå¤šå¼•å…¥å‡ ç»„æ„é€ ä¸ªæ ¼è‚¯å®šå°±æ‹¿ä¸‹äº†ã€‚ä½†æ˜¯æˆ‘æ‡’ï¼Œå…ˆè¯•è¯•çœ‹åªæ‹¿ä¸€ç»„æ„é€ çš„æ ¼èƒ½ä¸èƒ½å¹²å‡ºæ¥ï¼Œæ¯•ç«Ÿrå’Œså®åœ¨æ˜¯å¾ˆå°ã€‚</p><blockquote><p>exp</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = <br>Q =  <span class="hljs-comment"># Q_0</span><br>R =  <span class="hljs-comment"># R_0</span><br>S =  <span class="hljs-comment"># S_0</span><br>C =  <span class="hljs-comment"># C_0</span><br><br><br>L = Matrix(QQ,[<br>    [<span class="hljs-number">1</span>/<span class="hljs-number">2</span>^<span class="hljs-number">320</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,Q],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,R],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,S],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>^<span class="hljs-number">320</span>,-C],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,p]<br>])<br>L[:,-<span class="hljs-number">1</span>:] *= <span class="hljs-number">2</span>^<span class="hljs-number">320</span><br>L = L.LLL()<br><span class="hljs-built_in">print</span>(L)<br><br><span class="hljs-comment"># L[-1][-2] == 2^320</span><br><br>r0, s0 = L[-<span class="hljs-number">1</span>][<span class="hljs-number">1</span>], L[-<span class="hljs-number">1</span>][<span class="hljs-number">2</span>] <span class="hljs-comment"># 2638621544, 3219364802</span><br><br><br>m = (C - r0*R - s0*S)*inverse(Q,p) % p<br><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment"># b&#x27;CCTF&#123;3X7eNdED_H!dD3n_nNm8eR_pR0Bl3m_iN_CCTF!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç¨å¾®è°ƒä¸€ä¸‹æ ¼çš„å¤§å°ï¼Œç›´æ¥ä¸€ç»„å°±å‡ºäº†ï¼Œç»™çš„é‚£ä¹ˆå¤šç»„Q,R,Sç”šè‡³éƒ½æ²¡ä»€ä¹ˆç”¨...</p><h3 id="alilbols">Alilbols</h3><blockquote><p>task</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#!/usr/bin/env python3</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> d, flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">genkey</span>(<span class="hljs-params">d</span>):<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>f = getRandomRange(<span class="hljs-number">1</span>, <span class="hljs-built_in">int</span>(sqrt(<span class="hljs-number">2</span>) * <span class="hljs-number">10</span> ** d))<br>g = getRandomRange(<span class="hljs-number">10</span> ** d, <span class="hljs-built_in">int</span>(sqrt(<span class="hljs-number">2</span>) * <span class="hljs-number">10</span> ** d))<br><span class="hljs-keyword">if</span> gcd(f, <span class="hljs-number">10</span> * g) == <span class="hljs-number">1</span>:<br>q = <span class="hljs-number">4</span> * <span class="hljs-number">100</span> ** d<br>h = inverse(f, q) * g % q<br><span class="hljs-keyword">if</span> gcd(h, <span class="hljs-number">10</span> * d) == <span class="hljs-number">1</span>:<br><span class="hljs-keyword">break</span><br>pkey, skey = (d, h), (f, g)<br><span class="hljs-keyword">return</span> pkey, skey<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">m, pkey</span>):<br>d, h = pkey<br>q = <span class="hljs-number">4</span> * <span class="hljs-number">100</span> ** d<br><span class="hljs-keyword">assert</span> m &lt; <span class="hljs-number">10</span> ** d<br>r = getRandomRange(<span class="hljs-number">1</span>, <span class="hljs-number">10</span> ** d // <span class="hljs-number">2</span>)<br>c = (r * h + m + r) % q<br><span class="hljs-keyword">return</span> c<br><br>pkey, _ = genkey(d)<br>m = bytes_to_long(flag)<br>c = encrypt(m, pkey)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;h = <span class="hljs-subst">&#123;pkey[<span class="hljs-number">1</span>]&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><p>å¾ˆç»å…¸çš„NTRUï¼Œæˆ‘ä»¬æœ‰</p><p><span class="math display">\[c=(r(h+1)+m)\bmod{q}\]</span></p><p>å…¶ä¸­åªæœ‰hå·²çŸ¥ã€‚å„ä¸ªå‚æ•°çš„èŒƒå›´éƒ½åœ¨ä»£ç é‡Œï¼Œä¸èµ˜è¿°äº†ï¼Œæ€»ä¹‹è¿™é‡Œçš„qä¸çŸ¥é“ï¼Œå¾—æ‰¾åˆ°dçš„å€¼å»æ¢å¤qã€‚ç›´æ¥æšä¸¾æ˜¯å¯è¡Œçš„ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥å…ˆçŒœä¸€æ³¢hçš„åè¿›åˆ¶ä½æ•°æ°å¥½å°±æ˜¯2dä½ï¼Œè‹¥çœŸï¼Œåˆ™dä¸º563ã€‚</p><p>é€ ä¸ªæ ¼å­è·‘ä¸€ä¸‹ï¼š</p><blockquote><p>exp</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>h = <br>c = <br>d = <span class="hljs-number">563</span><br>q = <span class="hljs-number">4</span> * <span class="hljs-number">100</span> ** d<br>M = Matrix(ZZ,[<br>    [<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,h+<span class="hljs-number">1</span>],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">2</span>^<span class="hljs-number">2048</span>,-c],<br>    [<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,q]<br>])<br><br><br>M = M.LLL()<br><br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">abs</span>(M[-<span class="hljs-number">1</span>,-<span class="hljs-number">1</span>])))<br><br><span class="hljs-comment"># b&#x27;CCTF&#123;4_c0N9rU3n7!aL_Pu81iC_k3Y_cRyp70_5ySTeM_1N_CCTF!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>ç„¶åå°±çœŸçš„æ‹¿åˆ°äº†ã€‚</p><h3 id="ally">Ally</h3><p>éå¸¸æœ‰CryptoCTFå‘³é“çš„é¢˜ï¼Œ"åªéœ€"æ±‚è§£ä¸€ä¸ªDiophantineequationå³å¯ã€‚å¯¹æˆ‘è¿™ç§æ‡’äººï¼Œæ‰‹è§£æ˜¾ç„¶æ˜¯ä¸åœ¨è€ƒè™‘èŒƒå›´å†…çš„ï¼Œå…ˆæœç´¢ä¸€æ³¢å‰äººæ™ºæ…§ã€‚</p><p>æœäº†ä¸‹æ–¹ç¨‹çš„å½¢å¼è¿˜çœŸæœå‡ºæ¥<ahref="https://projecteuclid.org/journals/bulletin-of-the-belgian-mathematical-society-simon-stevin/volume-17/issue-2/On-a-Diophantine-Equation-of-Stroeker/10.36045/bbms/1274896199.full">ä¸€ç¯‡è®ºæ–‡</a></p><p>ä¸è¿‡å¾ˆé—æ†¾ï¼Œè®ºæ–‡å¼€ç¯‡å°±è¡¨ç¤ºNæ˜¯å¥‡æ•°çš„æƒ…å†µå·²ç»ç ”ç©¶è¿‡äº†ï¼Œå› æ­¤æœ¬ç¯‡åªç ”ç©¶å¶æ•°çš„æƒ…å†µ...æ›´æŠ½è±¡çš„æ˜¯Næ˜¯å¥‡æ•°æƒ…å†µæ—¶çš„å‚è€ƒæ–‡çŒ®æ ¹æœ¬æœä¸åˆ°ï¼ˆå¦‚æœæ­£åœ¨é˜…è¯»æœ¬æ–‡çš„ä½ æ°å¥½æ‰¾åˆ°äº†linkï¼Œéº»çƒ¦è´´åœ¨è¯„è®ºåŒºå¥½å—ğŸ˜ŠğŸ˜Šï¼‰</p><p>ä¸è¿‡è¿™ç¯‡æ–‡ç« é‡Œè¿˜æ˜¯æœ‰ä¸€äº›åœ°æ–¹æåˆ°äº†oddçš„æƒ…å†µï¼Œæ¯”å¦‚</p><p><code>If v = N, then 4u = N + 3, which is impossible since N + 3 is odd. Thus, v Ì¸= N</code></p><p>å¦‚æœæˆ‘åè¦v=Nå‘¢ï¼Ÿè¿™æ—¶æˆ‘ä»¬æœ‰</p><p><span class="math display">\[\begin{aligned}2x &amp;= vâˆ’u+l+1 \\2y &amp;= vâˆ’uâˆ’l+1 \\v &amp;= p \\p &amp;= N \\uv &amp;= Nl \\4u &amp;= p+3\end{aligned}\]</span></p><p>ä»£æ¢ä¸€ä¸‹æœ‰</p><p><span class="math display">\[\begin{aligned}2x &amp;= 3u+l-2 \\2y &amp;= 3u-l-2 \\u &amp;= l\end{aligned}\]</span></p><p>æ‰€ä»¥æˆ‘ä»¬å¾—åˆ° <span class="math inline">\(x=2u-1, y=u-1\)</span></p><p>éªŒä¸ªè¯å…ˆï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># sage</span><br>PR.&lt;u&gt; = PolynomialRing(ZZ)<br>p = <span class="hljs-number">4</span>*u-<span class="hljs-number">3</span><br>x = <span class="hljs-number">2</span>*u-<span class="hljs-number">1</span><br>y = u-<span class="hljs-number">1</span><br>LL = p*(x-y)^<span class="hljs-number">3</span><br>RR = (x^<span class="hljs-number">2</span>+y)*(x+y^<span class="hljs-number">2</span>)<br><br><span class="hljs-built_in">print</span>(LL==RR)<br></code></pre></td></tr></table></figure><figure><img src="../assets/image-6.png" alt="èƒ½Sagemathçš„ä¸ºä»€ä¹ˆè¦æ‰‹æ¨å‘¢" /><figcaption aria-hidden="true">èƒ½Sagemathçš„ä¸ºä»€ä¹ˆè¦æ‰‹æ¨å‘¢</figcaption></figure><p>æŒ‰è¿™ä¸ªæ ¼å¼æäº¤ç­”æ¡ˆå°±å¥½äº†ã€‚</p><blockquote><p>exp</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> getPrime<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> re<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_ans</span>(<span class="hljs-params">bits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = getPrime(bits)<br>        <span class="hljs-keyword">if</span> p % <span class="hljs-number">4</span> == <span class="hljs-number">1</span>:<br>            k = p // <span class="hljs-number">4</span><br>            x, y = <span class="hljs-number">2</span> * k + <span class="hljs-number">1</span>, k<br>            <span class="hljs-keyword">return</span> p, x, y<br>        <br>conn = remote(<span class="hljs-string">&#x27;00.cr.yp.toc.tf&#x27;</span>, <span class="hljs-number">13777</span>)<br>pattern = <span class="hljs-string">r&#x27;(.+?)-bit&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    conn.recvuntil(<span class="hljs-string">&#x27;send your&#x27;</span>)<br>    s = conn.recvline().decode()<br>    mat = re.search(pattern, s)<br>    bits = <span class="hljs-built_in">int</span>(mat.group(<span class="hljs-number">1</span>))<br>    p, x, y = get_ans(bits)<br>    conn.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;p&#125;</span>&#x27;</span>)<br>    conn.sendline(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;x&#125;</span>,<span class="hljs-subst">&#123;y&#125;</span>&#x27;</span>)<br><br>conn.interactive()<br><br><span class="hljs-comment"># Congratz! You got the flag: b&#x27;CCTF&#123;Di0phaNtinE_eQuaT1on_iZ_4n_equ4tion_wiTh_int3ger_solu7Ions_0nly!&#125;&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Writeups</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>imaginaryCTF round46</title>
    <link href="/imaginaryCTF-round46.html"/>
    <url>/imaginaryCTF-round46.html</url>
    
    <content type="html"><![CDATA[<h1 id="misc">Misc</h1><h2 id="spooky-sound">Spooky Sound</h2><p>wavï¼Œå…ˆæ‹–ä¸‹æ¥Audacityçœ‹ä¸€çœ¼é¢‘è°±ï¼Œæœç„¶å°±æœ‰flagã€‚</p><figure><img src="../assets/image.png" alt="flag" /><figcaption aria-hidden="true">flag</figcaption></figure><h2 id="last-minute">Last Minute</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br>    srand(time(<span class="hljs-literal">NULL</span>));<br><br>    <span class="hljs-type">const</span> <span class="hljs-type">char</span>* flag = <span class="hljs-string">&quot;[redacted]&quot;</span>;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">strlen</span>(flag); i++) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02x&quot;</span>, flag[i] ^ (rand() % <span class="hljs-number">256</span>));<br>    &#125;<br><br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ç›´æˆªäº†å½“çš„çˆ†ç ´ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;time.h&gt;</span></span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> &#123;<br>    <span class="hljs-type">long</span> <span class="hljs-type">int</span> flag[]=&#123;<span class="hljs-number">0x94</span>,<span class="hljs-number">0x1e</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0xd2</span>,<span class="hljs-number">0x87</span>,<span class="hljs-number">0xfa</span>,<span class="hljs-number">0xb0</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0xfd</span>,<span class="hljs-number">0xe5</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-number">0x0a</span>,<span class="hljs-number">0x1b</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0x39</span>,<span class="hljs-number">0xee</span>,<span class="hljs-number">0x4d</span>,<span class="hljs-number">0x55</span>,<span class="hljs-number">0xb7</span>,<span class="hljs-number">0x08</span>,<span class="hljs-number">0x70</span>,<span class="hljs-number">0xf1</span>,<span class="hljs-number">0x29</span>,<span class="hljs-number">0xba</span>,<span class="hljs-number">0x6b</span>,<span class="hljs-number">0x2a</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0xe4</span>,<span class="hljs-number">0xce</span>,<span class="hljs-number">0xea</span>,<span class="hljs-number">0x1c</span>,<span class="hljs-number">0xc0</span>,<span class="hljs-number">0xb2</span>,<span class="hljs-number">0x5d</span>,<span class="hljs-number">0x01</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0x7c</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x4c</span>,<span class="hljs-number">0xb4</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0x28</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0x96</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0xfc</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xc8</span>,<span class="hljs-number">0x6f</span>&#125;;<br><br>    <span class="hljs-type">int</span> len = <span class="hljs-keyword">sizeof</span>(flag) / <span class="hljs-keyword">sizeof</span>(flag[<span class="hljs-number">0</span>]);<br>    <span class="hljs-type">char</span> decrypted[len + <span class="hljs-number">1</span>]; <br><br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">long</span> <span class="hljs-type">int</span> seed = <span class="hljs-number">1715867640</span>; seed &lt; <span class="hljs-number">1715878940</span>; seed++) &#123;<br>        srand(seed);<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> j = <span class="hljs-number">0</span>; j &lt; len; j++) &#123;<br>            decrypted[j] = flag[j] ^ (rand() % <span class="hljs-number">256</span>);<br>        &#125;<br>        decrypted[len] = <span class="hljs-string">&#x27;\0&#x27;</span>; <br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strstr</span>(decrypted, <span class="hljs-string">&quot;ictf&quot;</span>) != <span class="hljs-literal">NULL</span>) &#123;<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Seed: %ld\n&quot;</span>, seed);<br>            <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Decrypted string: %s\n&quot;</span>, decrypted);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h1 id="crypto">Crypto</h1><h2 id="xorsar">xorsar</h2><p><code>hbugzchu^gmhqqhof^guv&gt;^0e8c3028|</code></p><p>å®éªŒå¯çŸ¥<span class="math inline">\(cipher[i] = flag[i] \oplus1\)</span>ï¼Œxorå›å»å³å¯ã€‚</p><h2 id="random-base">Random Base</h2><p><code>OED8WECRFCS6/TC9$DUICGPEFQEGS6BM6*.CN-DZ2</code></p><p>å­—æ¯ç‰¹å¾çŒœå‡ºæ˜¯base45ã€‚</p><h2 id="strange-base">Strange Base</h2><p><code>aQ==Yw==dA==Zg==ew==dg==Mw==cg==eQ==Xw==NQ==Nw==cg==NA==bg==Zw==Mw==Xw==Yg==NA==cw==Mw==Xw==Ng==NA==IQ==fQ==</code></p><p>å¾ˆå®¹æ˜“çœ‹å‡ºæ¥æ˜¯é€å­—ç¬¦çš„base64ï¼Œ4å­—ä¸€ç»„decodeå³å¯ã€‚</p><h2 id="so-much-xor">So much XOR</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor <span class="hljs-comment"># pwntools xor function</span><br><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>key1 = <span class="hljs-string">b&#x27;supersecurekey&#x27;</span><br>key2=<span class="hljs-string">b&#x27;verysecretkey&#x27;</span><br>iters1 = random.randint(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>)<br>iters2 = random.randint(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>)<br>enc = flag<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(iters1):<br>    enc = xor(enc,key1)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(iters2):<br>        enc = xor(enc,key2)<br><br><span class="hljs-comment"># b&#x27;\x1a\x16\x04\x03\t\x00\n&lt;\x18\x07\x06\x03:\x00\x16\x01/\x16\x1d,\t\n\x01\x06\t\x0e\x18&#x27;</span><br></code></pre></td></tr></table></figure><p>å¼‚æˆ–æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ï¼Œå¹¶ä¸”å’ŒåŒä¸€ä¸ªæ•°å¼‚æˆ–ä¸¤æ¬¡ä¼šè¿˜åŸè‡ªèº«ï¼Œæ‰€ä»¥åšçš„è¿™ä¹ˆå¤šå¼‚æˆ–æ— éå°±æ˜¯å¼‚æˆ–äº†0æ¬¡æˆ–è€…1æ¬¡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> xor <span class="hljs-comment"># pwntools xor function</span><br><br>cipher = <span class="hljs-string">b&#x27;\x1a\x16\x04\x03\t\x00\n&lt;\x18\x07\x06\x03:\x00\x16\x01/\x16\x1d,\t\n\x01\x06\t\x0e\x18&#x27;</span><br>key1 = <span class="hljs-string">b&#x27;supersecurekey&#x27;</span><br>key2=<span class="hljs-string">b&#x27;verysecretkey&#x27;</span><br><span class="hljs-built_in">print</span>(xor(cipher, key1))<br><span class="hljs-built_in">print</span>(xor(cipher, key2))<br><span class="hljs-built_in">print</span>(xor(xor(cipher, key1),key2))<br></code></pre></td></tr></table></figure><h1 id="reverse">Reverse</h1><h2 id="tape-reader">Tape Reader</h2><p>ç¨‹åºä¼šç®€å•åœ°è¯»å–çº¸å¸¦åšå¯¹åº”æ“ä½œã€‚çº¸å¸¦å’Œæ“ä½œéƒ½æ˜ç¡®ç»™å‡ºäº†ï¼Œé€†æ“ä½œå³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒBinaryNinjaä¼¼ä¹è§£æçº¸å¸¦æ•°ç»„æ—¶ä¼šå‡ºç°é”™è¯¯ï¼Œè¿™éƒ¨åˆ†æœ€å¥½ç”¨IDAå»åšã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SIZE 21</span><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-type">char</span> command[] = <span class="hljs-string">&quot;aaiasiasassaiaasaiaiaaasssiasisaasiasissaiaasaiasisaisaisaiiaasaiassissaiasii&quot;</span>;<br>    <span class="hljs-type">int</span> arr[SIZE] = &#123;<span class="hljs-number">0x81</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x74</span>&#125;;<br>    <span class="hljs-type">int</span> v4 = <span class="hljs-number">21</span>;<br>    <span class="hljs-type">int</span> i, len = <span class="hljs-built_in">strlen</span>(command);<br><br>    <span class="hljs-keyword">for</span> (i = len - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; --i) &#123;<br>        <span class="hljs-keyword">switch</span> (command[i]) &#123;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;a&#x27;</span>:<br>                arr[v4] -= <span class="hljs-number">5</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;i&#x27;</span>:<br>                --v4;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;s&#x27;</span>:<br>                arr[v4] += <span class="hljs-number">3</span>;<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;x&#x27;</span>:<br>                arr[v4] ^= arr[v4 + <span class="hljs-number">1</span>];<br>                <span class="hljs-keyword">break</span>;<br>            <span class="hljs-keyword">default</span>:<br>                <span class="hljs-keyword">continue</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; SIZE; ++i) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;0x%x&quot;</span>, arr[i]);<br>    &#125;<br>    <br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Writeups</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>DragonKnight CTF 2024 Writeup</title>
    <link href="/DragonKnight-CTF-2024-Writeup.html"/>
    <url>/DragonKnight-CTF-2024-Writeup.html</url>
    
    <content type="html"><![CDATA[<p>åœ¨Del0n1xé‡Œæ‰“çš„ä¸€åœºæ¯”èµ›ï¼ŒæŠŠCryptoæ–¹å‘çš„å…¨è§£äº†â€”â€”å½“ç„¶ï¼Œä¸»è¦æ˜¯å¾—ç›Šäºé¢˜ç›®çš„ideaå¤§éƒ¨åˆ†éƒ½æ˜¯å€Ÿé‰´çš„ï¼Œæ‰€ä»¥åªè¦æ£€ç´¢èƒ½åŠ›å¼ºåŸºæœ¬å°±èƒ½AKã€‚</p><h1 id="crypto">Crypto</h1><h2 id="crypto_ç­¾åˆ°">Crypto_ç­¾åˆ°</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>m = <span class="hljs-string">b&#x27;flag&#123;********&#125;&#x27;</span><br>a =  getPrime(<span class="hljs-number">247</span>)<br>b =  getPrime(<span class="hljs-number">247</span>)<br>n =  getPrime(<span class="hljs-number">247</span>)<br><br>seed = bytes_to_long(m)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed, a, b, m</span>):<br>        self.seed = seed  <br>        self.a = a  <br>        self.b = b  <br>        self.m = m  <br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.a * self.seed + self.b) % self.m<br>        self.seed = (self.a * self.seed + self.b) % self.m<br>        <span class="hljs-keyword">return</span> self.seed<br><br>seed = bytes_to_long(m)<br><br>output = LCG(seed,a,b,n)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(getPrime(<span class="hljs-number">16</span>)):<br>    output.generate()<br><br><span class="hljs-built_in">print</span>(output.generate())<br><span class="hljs-built_in">print</span>(output.generate())<br><span class="hljs-built_in">print</span>(output.generate())<br><span class="hljs-built_in">print</span>(output.generate())<br><span class="hljs-built_in">print</span>(output.generate())<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">5944442525761903973219225838876172353829065175803203250803344015146870499</span><br><span class="hljs-string">141002272698398325287408425994092371191022957387708398440724215884974524650</span><br><span class="hljs-string">42216026849704835847606250691811468183437263898865832489347515649912153042</span><br><span class="hljs-string">67696624031762373831757634064133996220332196053248058707361437259689848885</span><br><span class="hljs-string">19724224939085795542564952999993739673429585489399516522926780014664745253</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>æ¯æ¬¡è¾“å‡ºæ›´æ–°ä¸¤æ¬¡å†…éƒ¨çŠ¶æ€çš„LCGã€‚çœ‹æˆä¸€ä¸ªæ–°çš„ç³»æ•°åˆ†åˆ«ä¸º<spanclass="math inline">\(a&#39;=a^{2},b&#39;=(a+1)b\)</span>çš„LCGå°±å¥½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> gmpy2<br><br>output = [<span class="hljs-number">5944442525761903973219225838876172353829065175803203250803344015146870499</span>,<span class="hljs-number">141002272698398325287408425994092371191022957387708398440724215884974524650</span>,<span class="hljs-number">42216026849704835847606250691811468183437263898865832489347515649912153042</span>,<span class="hljs-number">67696624031762373831757634064133996220332196053248058707361437259689848885</span>,<span class="hljs-number">19724224939085795542564952999993739673429585489399516522926780014664745253</span>]<br>t = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(output)):<br>    t.append(output[i]-output[i-<span class="hljs-number">1</span>])<br><br>T = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">len</span>(t)-<span class="hljs-number">1</span>):<br>    T.append(t[i+<span class="hljs-number">1</span>]*t[i-<span class="hljs-number">1</span>] - t[i]**<span class="hljs-number">2</span>)<br><br>m = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(T)-<span class="hljs-number">1</span>):<br>    mm = gmpy2.gcd(T[i],T[i+<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">if</span> isPrime(mm):<br>        m.append(<span class="hljs-built_in">int</span>(mm))<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>            <span class="hljs-keyword">if</span> isPrime(mm // i):<br>                mm = mm // i<br>                m.append(<span class="hljs-built_in">int</span>(mm))<br>                <span class="hljs-keyword">break</span><br>    <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> m:<br>    a = gmpy2.invert(t[<span class="hljs-number">0</span>],i) * t[<span class="hljs-number">1</span>] % i<br>    b = output[<span class="hljs-number">1</span>] - a*output[<span class="hljs-number">0</span>] % i<br>    a_ = gmpy2.invert(a,i)<br><br>    seed = a_ * (output[<span class="hljs-number">0</span>]-b) % i<br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>**<span class="hljs-number">16</span>):<br>        seed = a_ * (seed - b) % i<br>        flag = long_to_bytes(seed)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;flag&#x27;</span> <span class="hljs-keyword">in</span> flag:<br>            <span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><h2 id="matrixrsa_revenge">MatrixRSA_Revenge</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># Sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br><br>flag = <span class="hljs-string">b&quot;DRKCTF&#123;??????????????&#125;&quot;</span> + os.urandom(<span class="hljs-number">212</span>)<br><br>p = getPrime(<span class="hljs-number">120</span>)<br>q = getPrime(<span class="hljs-number">120</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p = <span class="hljs-subst">&#123;p&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;q = <span class="hljs-subst">&#123;q&#125;</span>&quot;</span>)<br><br>part = [bytes_to_long(flag[<span class="hljs-number">16</span>*i:<span class="hljs-number">16</span>*(i+<span class="hljs-number">1</span>)]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br><br>M = Matrix(Zmod(n),[<br>    [part[<span class="hljs-number">4</span>*i+j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)<br>])<br><br>e = <span class="hljs-number">65537</span><br>C = M ** e<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;C = <span class="hljs-subst">&#123;<span class="hljs-built_in">list</span>(C)&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p = 724011645798721468405549293573288113   </span><br><span class="hljs-string">q = 712853480230590736297703668944546433</span><br><span class="hljs-string">C = [(354904294318305224658454053059339790915904962123902870614765704810196137, 307912599668649689143528844269686459695648563337814923172488152872006235, 143644686443811064172873392982322248654471792394264352463341325181752577, 22995887787365556743279529792687264972121816670422146768160153217903088), (111349308911096779758451570594323566987628804920420784718347230085486245, 370237591900013263581099395076767089468466012835217658851568690263421449, 305451886364184428434479088589515273362629589399867618474106045683764897, 454103583344277343974714791669312753685583930212748198341578178464249150), (168497521640129742759262423369385500102664740971338844248603058993335309, 228941893018899960301839898935872289351667488000643221589230804176281482, 340080333594340128998141220817079770261711483018587969623825086357581002, 122922413789905368029659916865893297311475500951645918611759627764993518), (10332477229415731242316540110058798318207430965033579181240340751539101, 238172263316130590821973648893483382211906906298557131324791759298887701, 487586702165464601760230182019344052665496627253691596871783460314632260, 12238020921585443139790088280608644406695242899000592355653073240122626)]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>åŠ å¯†è¿‡ç¨‹å°±æ˜¯åœ¨<spanclass="math inline">\(Z/nZ\)</span>ä¸Šå¯¹æ˜æ–‡çŸ©é˜µåšäº†å¹‚è¿ç®—ã€‚ä¸€ä¸ªç›´è§‚çš„æ€è·¯æ˜¯æŠŠCåˆ†åˆ«æ”¾åœ¨æ¨¡på’Œæ¨¡qä¸‹å»è€ƒè™‘ï¼Œå› ä¸ºæˆ‘ä»¬çŸ¥é“ä¸€èˆ¬çº¿æ€§ç¾¤<spanclass="math inline">\(GL_4(F_p)\)</span>æ˜¯æœ‰é™ç¾¤ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªç¾¤ä¸Šé¢<spanclass="math inline">\(M^{n}=M^{n\ mod\ od}\)</span>ï¼Œ<spanclass="math inline">\(od\)</span>ä¸ºç¾¤é˜¶ã€‚</p><p>orderçš„è®¡ç®—æ–¹æ³•å¯ä»¥å‚è€ƒ<ahref="https://math.stackexchange.com/questions/34271/order-of-general-and-special-linear-groups-over-finite-fields">è¿™é‡Œ</a></p><p><spanclass="math inline">\(C=M^{e}\)</span>ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æ°å½“é€‰å–æŒ‡æ•°å°±å¯ä»¥è®©æ¨¡på’Œæ¨¡qä¸‹çš„Cç»è¿‡å¹‚è¿ç®—ä¹‹åå¾—åˆ°æ¨¡på’Œæ¨¡qçš„<spanclass="math inline">\(M\)</span>ï¼Œæ¥ä¸‹æ¥CRTç»„åˆå›å»å°±å¥½ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># Sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>C = [[<span class="hljs-number">354904294318305224658454053059339790915904962123902870614765704810196137</span>, <span class="hljs-number">307912599668649689143528844269686459695648563337814923172488152872006235</span>, <span class="hljs-number">143644686443811064172873392982322248654471792394264352463341325181752577</span>, <span class="hljs-number">22995887787365556743279529792687264972121816670422146768160153217903088</span>], [<span class="hljs-number">111349308911096779758451570594323566987628804920420784718347230085486245</span>, <span class="hljs-number">370237591900013263581099395076767089468466012835217658851568690263421449</span>, <span class="hljs-number">305451886364184428434479088589515273362629589399867618474106045683764897</span>, <span class="hljs-number">454103583344277343974714791669312753685583930212748198341578178464249150</span>], [<span class="hljs-number">168497521640129742759262423369385500102664740971338844248603058993335309</span>, <span class="hljs-number">228941893018899960301839898935872289351667488000643221589230804176281482</span>, <span class="hljs-number">340080333594340128998141220817079770261711483018587969623825086357581002</span>, <span class="hljs-number">122922413789905368029659916865893297311475500951645918611759627764993518</span>], [<span class="hljs-number">10332477229415731242316540110058798318207430965033579181240340751539101</span>, <span class="hljs-number">238172263316130590821973648893483382211906906298557131324791759298887701</span>, <span class="hljs-number">487586702165464601760230182019344052665496627253691596871783460314632260</span>, <span class="hljs-number">12238020921585443139790088280608644406695242899000592355653073240122626</span>]]<br><br>p = <span class="hljs-number">724011645798721468405549293573288113</span><br>q = <span class="hljs-number">712853480230590736297703668944546433</span><br>e = <span class="hljs-number">65537</span><br>G1 = matrix(GF(p), <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, C)<br>G2 = matrix(GF(q), <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, C)<br><span class="hljs-comment"># åˆ†åˆ«è€ƒè™‘mod på’Œmod qçš„finite fieldæƒ…å†µ</span><br>od_p = product([p ^ <span class="hljs-number">4</span> - p ^ i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<br>od_q = product([q ^ <span class="hljs-number">4</span> - q ^ i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)])<br><span class="hljs-comment"># æœ‰é™ç¾¤ï¼Œé€‚å½“é€‰å–æŒ‡æ•°ä½¿å¾—è¿ç®—ç»“æœä¸ºè‡ªèº«</span><br>inv_p = inverse(e, od_p)<br>inv_q = inverse(e, od_q)<br>dic1 = <span class="hljs-built_in">list</span>((G1^inv_p)[<span class="hljs-number">0</span>])<br>dic2 = <span class="hljs-built_in">list</span>((G2^inv_q)[<span class="hljs-number">0</span>])<br><br><span class="hljs-comment"># CRTç»„åˆå›å»</span><br>p = <span class="hljs-number">724011645798721468405549293573288113</span><br>q = <span class="hljs-number">712853480230590736297703668944546433</span><br><span class="hljs-keyword">for</span> mp, mq <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(dic1,dic2):<br>m = crt([ZZ(mp), ZZ(mq)], [p, q])<br>res = long_to_bytes(m)<br><span class="hljs-built_in">print</span>(res)<br><br><span class="hljs-comment"># b&#x27;DRKCTF&#123;a58986e7-&#x27;</span><br><span class="hljs-comment"># b&#x27;33e5-4f65-8c22-b&#x27;</span><br><span class="hljs-comment"># b&#x27;8a5e620752d&#125;V%\x17\xf1&#x27;</span><br><span class="hljs-comment"># b&#x27;K\xe0d\x0e\xde\xc2\xd1\xf1\xc0\xa4v\xe7\xcb\x13\x9c\x13&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="ezdes">EzDES</h2><p>åŠ å¯†ç”¨çš„DESå¼±å¯†é’¥ï¼Œç›´æ¥è§£å¯†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> DES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><br>key = <span class="hljs-string">b&#x27;\x01\x01\x01\x01\x01\x01\x01\x01&#x27;</span><br>des = DES.new(key, DES.MODE_ECB)<br>enc = <span class="hljs-string">b&#x27;t\xe4f\x19\xc6\xef\xaaL\xc3R&#125;\x08;K\xc9\x88\xa6|\nF\xc3\x12h\xcd\xd3x\xc3(\x91\x08\x841\xca\x8b\xc1\x94\xb5\x9f[\xcd\xc6\x9f\xf9\xf6\xca\xf5\x1a\xda\x16\xcf\x89\x154\xa1\xfe\xc5\x16\xcf\x89\x154\xa1\xfe\xc5&#x27;</span><br><br>dec = des.decrypt(enc)<br><span class="hljs-built_in">print</span>(dec)<br><br><span class="hljs-comment"># DRKCTF&#123;We4k_K3y_1s_V3ry_D4nger0us_In_DES&#125;</span><br></code></pre></td></tr></table></figure><h2 id="midrsa">MidRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_Key1</span>(<span class="hljs-params">ebits</span>):<br>    e = [getPrime(ebits) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br>    <span class="hljs-keyword">return</span> e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt1</span>(<span class="hljs-params">message,e</span>):<br>    n = gmpy2.next_prime(bytes_to_long(message) &lt;&lt; <span class="hljs-number">300</span>)<br>    m = getPrime(<span class="hljs-number">256</span>)<br>    c = [<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(m,e[i],n)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e))]<br>    <span class="hljs-keyword">return</span> c<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_Key2</span>(<span class="hljs-params">nbits</span>):<br>    p = getPrime(nbits // <span class="hljs-number">2</span>)<br>    q = getPrime(nbits // <span class="hljs-number">2</span>)<br>    n = p*q<br>    e = [random.getrandbits(nbits // <span class="hljs-number">4</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]<br>    <span class="hljs-keyword">return</span> n,e<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt2</span>(<span class="hljs-params">message,e,n</span>):<br>    m = bytes_to_long(message)<br>    c = [<span class="hljs-built_in">int</span>(<span class="hljs-built_in">pow</span>(m,e[i],n)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(e))]<br>    <span class="hljs-keyword">return</span> c<br>    <br><span class="hljs-keyword">assert</span> flag.startswith(<span class="hljs-string">b&quot;DRKCTF&#123;&quot;</span>)<br><br>flag1 = flag[:<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>]<br>flag2 = flag[<span class="hljs-built_in">len</span>(flag)//<span class="hljs-number">2</span>:]<br><br>ebits = <span class="hljs-number">7</span><br>e1 = generate_Key1(ebits)<br>cipher1 = encrypt1(flag1,e1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e1 =&quot;</span>,e1)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cipher1 =&quot;</span>,cipher1)<br><br>nbits = <span class="hljs-number">1024</span><br>n,e2 = generate_Key2(nbits)<br>cipher2 = encrypt2(flag2,e2,n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;e2 =&quot;</span>,e2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;cipher2 =&quot;</span>,cipher2)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>,n)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">e1 = [109, 71, 109, 73]</span><br><span class="hljs-string">cipher1 = [36272047346364825234770733058042613197790911431212158822254782055957208837848605160852567043492625692783344073921185227328379941291979083011033, 13421582077901767047291741873622169312010984740586925881415103229648835151589774736786336965745532072099996467445790339749720696886313635920080, 36272047346364825234770733058042613197790911431212158822254782055957208837848605160852567043492625692783344073921185227328379941291979083011033, 41425183140413487232780768389488969603566343428250573532166425276868000949579663990819005141199597640625439816343697426958648927294289659127871]</span><br><span class="hljs-string">e2 = [79572758141493570128961125255246129069540961757778793209698370333142346488381, 80555585862127636800866563977080055603517001358195529410497461746213789997225, 44651921320695090688745333790065512192118202496468714141526113242887125432380]</span><br><span class="hljs-string">cipher2 = [58600444300331800249882073146233995912287198739549440714207984476331259754331716531491187240053630185776787152600165426285021284302994699108557023545574315706006132536588848833818758624067461985444940651823107522770906474037882323326792755635934081822967331031854184791299228513024491344725765476710816941057, 16511944800191885973496391252612222059697387587833308714567450121364756390806094606646424594583975159634952911600665271092389815248477961923357683297311169260578508157717777465241680062644118354471550223231057620392252324514411927096940875466794869671163453991620492008856178108060167556176019729800517994337, 80885008609388989196377721090246742575908473911131498982960117640742106565184297197238656375198284856442596226398287448931285735903463892735111244609358611618958293002176923706195402338331128766464276441210238388187625107435781170368017908610916585774514676482124401329575553658828115269495158818527164441546]</span><br><span class="hljs-string">n = 93468142044831350317940409833603031534515663349871776634867176846669780024082517910566484997161088199091160371537367121403194814422867749777235397168852158723228851090445429617275680206703935781244466363279841409768649097588586494453125840436600639420286950914680651600232197982546122764845043227394567787283</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>encrypt1ä¸€çœ¼LLL+GCDæ±‚è§£ï¼Œæ€è·¯å‚è€ƒ<ahref="https://github.com/maple3142/My-CTF-Challenges/tree/master/ImaginaryCTF/Round%2026/no_modulus">mapleä½¬çš„è¿™é“é¢˜ç›®</a>ï¼Œencrypt2ç›´æ¥å…±æ¨¡æ”»å‡»ã€‚</p><p>æ³¨æ„æ‰“çš„æ—¶å€™å»æ‰encrypt1é‡Œé‡å¤çš„ä¸€ç»„eå’Œcã€‚</p><p>(å…¶å®encrypt1å°±æ˜¯æŠ„çš„mapleçš„è¿™é“é¢˜å§...)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># Sage</span><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-built_in">exec</span>(<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;output.txt&quot;</span>).read())<br><br>L = matrix(es).T.augment(matrix.identity(<span class="hljs-built_in">len</span>(es)))<br>L[:, <span class="hljs-number">0</span>] *= <span class="hljs-number">2</span> ^ <span class="hljs-number">2048</span><br>L = L.LLL()<br><span class="hljs-built_in">print</span>(L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:])<br><span class="hljs-built_in">print</span>(L[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>:])<br>xx = product([ZZ(y) ^ x <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(L[<span class="hljs-number">0</span>][<span class="hljs-number">1</span>:], cs)])<br>yy = product([ZZ(y) ^ x <span class="hljs-keyword">for</span> x, y <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(L[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>:], cs)])<br>n = gcd(xx.numer() - xx.denom(), yy.numer() - yy.denom())<br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(long_to_bytes(n&gt;&gt;<span class="hljs-number">300</span>))<br><br><span class="hljs-comment"># Python</span><br><span class="hljs-keyword">import</span> gmpy2 <span class="hljs-keyword">as</span> gp<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">egcd</span>(<span class="hljs-params">a, b</span>):<br><span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:<br><span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br><span class="hljs-keyword">else</span>:<br>g, y, x = egcd(b % a, a)<br><span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)<br><br>n = <span class="hljs-number">93468142044831350317940409833603031534515663349871776634867176846669780024082517910566484997161088199091160371537367121403194814422867749777235397168852158723228851090445429617275680206703935781244466363279841409768649097588586494453125840436600639420286950914680651600232197982546122764845043227394567787283</span><br>c1 = <span class="hljs-number">58600444300331800249882073146233995912287198739549440714207984476331259754331716531491187240053630185776787152600165426285021284302994699108557023545574315706006132536588848833818758624067461985444940651823107522770906474037882323326792755635934081822967331031854184791299228513024491344725765476710816941057</span><br>c2 = <span class="hljs-number">16511944800191885973496391252612222059697387587833308714567450121364756390806094606646424594583975159634952911600665271092389815248477961923357683297311169260578508157717777465241680062644118354471550223231057620392252324514411927096940875466794869671163453991620492008856178108060167556176019729800517994337</span><br>e1 = <span class="hljs-number">79572758141493570128961125255246129069540961757778793209698370333142346488381</span><br>e2 = <span class="hljs-number">80555585862127636800866563977080055603517001358195529410497461746213789997225</span><br>s = egcd(e1, e2)<br>s1 = s[<span class="hljs-number">1</span>]<br>s2 = s[<span class="hljs-number">2</span>]<br><span class="hljs-keyword">if</span> s1&lt;<span class="hljs-number">0</span>:<br>s1 = - s1<br>c1 = gp.invert(c1, n)<br><span class="hljs-keyword">elif</span> s2&lt;<span class="hljs-number">0</span>:<br>s2 = - s2<br>c2 = gp.invert(c2, n)<br><br>m = <span class="hljs-built_in">pow</span>(c1,s1,n)*<span class="hljs-built_in">pow</span>(c2,s2,n) % n<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:])<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(m)[<span class="hljs-number">2</span>:]))<br><br><br><span class="hljs-comment"># DRKCTF&#123;5d0b96e8-e069-4378-82e7-120e4b761a0b&#125;</span><br></code></pre></td></tr></table></figure><h2 id="myencrypto">MyEncrypto</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag      <br><span class="hljs-keyword">import</span> random<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getMyPrime</span>():              <br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:              <br>        r = random.getrandbits(<span class="hljs-number">64</span>)              <br>        _p = r**<span class="hljs-number">6</span> -<span class="hljs-number">3</span>*r**<span class="hljs-number">5</span> - r**<span class="hljs-number">4</span> + r**<span class="hljs-number">2</span> - r - <span class="hljs-number">6</span><br>        _q = r**<span class="hljs-number">7</span> + <span class="hljs-number">2</span>*r**<span class="hljs-number">6</span> + r**<span class="hljs-number">5</span> + <span class="hljs-number">4</span>*r**<span class="hljs-number">4</span> + <span class="hljs-number">7</span>*r**<span class="hljs-number">2</span> + r + <span class="hljs-number">4653</span><br>        <span class="hljs-keyword">if</span> isPrime(_p) <span class="hljs-keyword">and</span> isPrime(_q):              <br>            <span class="hljs-keyword">return</span> _p, _q<br>                      <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">enc</span>(<span class="hljs-params">m, n</span>):                        <br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(m, <span class="hljs-number">65537</span>, n)              <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">LCG</span>(<span class="hljs-params">s,a,b,n</span>):<br>    <span class="hljs-keyword">return</span> (a*s + b) % n<br><br><br>seed = bytes_to_long(flag)<br>P = getPrime(<span class="hljs-number">512</span>)<br>a = random.randrange(<span class="hljs-number">0</span>,P)<br>b = random.randrange(<span class="hljs-number">0</span>,P)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Roll</span>():<br>    <span class="hljs-keyword">global</span> seed<br>    seed = LCG(seed,a,b,P)<br>    <span class="hljs-keyword">return</span> seed % <span class="hljs-number">2</span>**<span class="hljs-number">16</span><br><br>p, q = getMyPrime()<br>n = p * q              <br>enc_P = enc(P, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)              <br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;enc_P = <span class="hljs-subst">&#123;enc_P&#125;</span>&quot;</span>)<br><br>out = []<br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">40</span>):<br>    out.append(Roll())<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a = <span class="hljs-subst">&#123;a&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;b = <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;out = <span class="hljs-subst">&#123;out&#125;</span>&quot;</span>)<br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">r = 1248775963213848425</span><br><span class="hljs-string">P = 10679387699123200522776360035184725927822172255453595568464894884736102462568579313264894449779104030120028056158023524486966766295648236135714849745610937</span><br><span class="hljs-string">n = 17959692613208124553115435318871530105762927141420294800783695207170608966804977782615874404539156257549097962410144332053383210075663138848832474791712256427111304125146378883542387121684653496644116081809328796925343393644118376497507</span><br><span class="hljs-string">enc_P = 17215745298239635988196009014709535403293865406390546681749129213899045156482782458937447412919331336842808052179915132663427715069134196783415529688715962754860563850858056507148936427379551986735103284388996678146580229028006898491552</span><br><span class="hljs-string">a = 2759277675743644814124420138047586760905070650864591936190199977578763421196999718749092450720072564786874114432179104175692800471519816376692104515142375</span><br><span class="hljs-string">b = 8111240578821759579875175166986910195923820191652867334412871591814076020421468033017946066268237980082938735686222173713853299600396887041341974719819186</span><br><span class="hljs-string">out = [39566, 15295, 19818, 55685, 49100, 6517, 2675, 9567, 37243, 40312, 42906, 35874, 44178, 1256, 40298, 29149, 35721, 19886, 63020, 50116, 6844, 39897, 16134, 50218, 44609, 46188, 52712, 49903, 20933, 5441, 19411, 8330, 6904, 39350, 60853, 43446, 35910, 43728, 61533, 13757]</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>æ ¸å¿ƒideaæŠ„äº†osu!gaming CTF 2024çš„<ahref="https://tiefsee5037008.github.io/posts/Osu!gaming-CTF-Writeup/#lucky-roll-gaming">lucky-roll-gaming</a>ï¼Œæ‹¿ç°æˆçš„expç›´æ¥æ‰“å°±è¡Œã€‚</p><p>å¤šé¡¹å¼æ±‚æ ¹å°±èƒ½åˆ†è§£nç„¶åæ‹¿åˆ°Pã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment"># Sage</span><br><br><span class="hljs-comment"># R = PolynomialRing(QQ, &#x27;r&#x27;)</span><br><span class="hljs-comment"># f = r^13 - r^12 - 6*r^11 - r^10 - 12*r^9 + 4*r^8 - 27*r^7 + 4634*r^6 - 13970*r^5 - 4670*r^4 - 6*r^3 + 4610*r^2 - 4659*r - 27918 - 17959692613208124553115435318871530105762927141420294800783695207170608966804977782615874404539156257549097962410144332053383210075663138848832474791712256427111304125146378883542387121684653496644116081809328796925343393644118376497507</span><br><span class="hljs-comment"># print(f.roots())</span><br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">10679387699123200522776360035184725927822172255453595568464894884736102462568579313264894449779104030120028056158023524486966766295648236135714849745610937</span><br>a = <span class="hljs-number">2759277675743644814124420138047586760905070650864591936190199977578763421196999718749092450720072564786874114432179104175692800471519816376692104515142375</span><br>b = <span class="hljs-number">8111240578821759579875175166986910195923820191652867334412871591814076020421468033017946066268237980082938735686222173713853299600396887041341974719819186</span><br>out = [<span class="hljs-number">39566</span>, <span class="hljs-number">15295</span>, <span class="hljs-number">19818</span>, <span class="hljs-number">55685</span>, <span class="hljs-number">49100</span>, <span class="hljs-number">6517</span>, <span class="hljs-number">2675</span>, <span class="hljs-number">9567</span>, <span class="hljs-number">37243</span>, <span class="hljs-number">40312</span>, <span class="hljs-number">42906</span>, <span class="hljs-number">35874</span>, <span class="hljs-number">44178</span>, <span class="hljs-number">1256</span>, <span class="hljs-number">40298</span>, <span class="hljs-number">29149</span>, <span class="hljs-number">35721</span>, <span class="hljs-number">19886</span>, <span class="hljs-number">63020</span>, <span class="hljs-number">50116</span>, <span class="hljs-number">6844</span>, <span class="hljs-number">39897</span>, <span class="hljs-number">16134</span>, <span class="hljs-number">50218</span>, <span class="hljs-number">44609</span>, <span class="hljs-number">46188</span>, <span class="hljs-number">52712</span>, <span class="hljs-number">49903</span>, <span class="hljs-number">20933</span>, <span class="hljs-number">5441</span>, <span class="hljs-number">19411</span>, <span class="hljs-number">8330</span>, <span class="hljs-number">6904</span>, <span class="hljs-number">39350</span>, <span class="hljs-number">60853</span>, <span class="hljs-number">43446</span>, <span class="hljs-number">35910</span>, <span class="hljs-number">43728</span>, <span class="hljs-number">61533</span>, <span class="hljs-number">13757</span>]<br><br>l = out<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lcg</span>(<span class="hljs-params">s, a, b, p</span>):<br>    <span class="hljs-keyword">return</span> (a * s + b) % p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_roll</span>():<br>    <span class="hljs-keyword">global</span> seed<br>    seed = lcg(seed, a, b, p)<br>    <span class="hljs-keyword">return</span> seed % (<span class="hljs-number">2</span>**<span class="hljs-number">16</span>)<br>n = <span class="hljs-built_in">len</span>(out)<br>A = [[<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)] <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n+<span class="hljs-number">1</span>)] <br>inv100 = <span class="hljs-built_in">pow</span>((<span class="hljs-number">2</span>**<span class="hljs-number">16</span>),-<span class="hljs-number">1</span>,p)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n-<span class="hljs-number">1</span>):<br>    A[i][i] = p<br>    A[n-<span class="hljs-number">1</span>][i] = a**(i+<span class="hljs-number">1</span>)%p<br>    A[n][i] = (a*l[<span class="hljs-number">0</span>]+b-l[<span class="hljs-number">1</span>])*inv100%p <span class="hljs-keyword">if</span> i==<span class="hljs-number">0</span> <span class="hljs-keyword">else</span> (a*A[n][i-<span class="hljs-number">1</span>] + (a*l[i]+b-l[i+<span class="hljs-number">1</span>])*inv100)%p<br>A[n-<span class="hljs-number">1</span>][n-<span class="hljs-number">1</span>] = <span class="hljs-number">1</span><br>A[n][n] = p//(<span class="hljs-number">2</span>**<span class="hljs-number">15</span>)<br>A = Matrix(A)<br>B = A.LLL()<br>h0 = B[<span class="hljs-number">0</span>][-<span class="hljs-number">2</span>]<br>s0 = h0*(<span class="hljs-number">2</span>**<span class="hljs-number">16</span>)+l[<span class="hljs-number">0</span>]<br><span class="hljs-built_in">print</span>(s0)<br><span class="hljs-comment"># s0-b = 1483033737693873089096042460610839746772642846474405267737556964198658333296466607424613619372059057716295177556213725041644228019066398600830469791395036</span><br>message = ((s0-b)*inverse(a,p))%p<br><span class="hljs-built_in">print</span>(long_to_bytes(message))<br><br><span class="hljs-comment"># b&#x27;DRKCTF&#123;a57b63a6-ecf5-46d3-a501-2d359a4fd168&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>èŠ±çµ®ï¼šèµ›åœºä¸Šè‡ªå·±å­å“§å­å“§é€ äº†ä¸ªæ ¼ï¼Œç»“æœpåªè¦å¤§ä¸€ç‚¹å°±ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œä¸€åº¦ä»¥ä¸ºè¿™ä¸€é¢˜å¡ç•Œäº†...æœ€åæ‹¿åˆ«äººçš„expä¸€éè¿‡ï¼Œè¿˜å¥½æ²¡æœ‰é”™è¿‡ä¸€è¡€ğŸ˜‡</p><h1 id="misc">Misc</h1><h2 id="func_pixels">func_pixels</h2><figure><img src="../assets/LEIMU_encoded.png" alt="å”‰å”‰ï¼ŒäºŒæ¬¡å…ƒ" /><figcaption aria-hidden="true">å”‰å”‰ï¼ŒäºŒæ¬¡å…ƒ</figcaption></figure><p>æ‹¿åˆ°å›¾ç‰‡å‘ç°å·¦ä¸Šæœ‰ä¸€äº›å¼‚å¸¸åƒç´ ï¼Œç»“åˆé¢˜ç›®çš„funcè€ƒè™‘flagåƒç´ çš„åˆ†å¸ƒåº”è¯¥ç±»ä¼¼å‡½æ•°å›¾åƒï¼Œè„šæœ¬æå–<spanclass="math inline">\(y=x^2\)</span>å’Œ<spanclass="math inline">\(y=x^3\)</span>çš„åƒç´ å€¼ï¼Œä¸¤ä¸ªèåˆèµ·æ¥å°±æ˜¯flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>image_path = <span class="hljs-string">&#x27;LEIMU_encoded.png&#x27;</span><br>image = Image.<span class="hljs-built_in">open</span>(image_path)<br><br>str1 = <span class="hljs-string">&quot;&quot;</span><br>str2 = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    pixel_value = image.getpixel((i, i**<span class="hljs-number">2</span>))<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">chr</span>(pixel_value[j]).isascii()):<br>            str1 += <span class="hljs-built_in">chr</span>(pixel_value[j])<br>        <span class="hljs-keyword">else</span>:<br>            str1 += <span class="hljs-string">&quot; &quot;</span><br><span class="hljs-built_in">print</span>(str1)<br><span class="hljs-comment"># for i in range(10):</span><br><span class="hljs-comment">#     pixel_value = image.getpixel((i, i))</span><br><span class="hljs-comment">#     print(f&#x27;Linear: &#123;chr(pixel_value[0]), chr(pixel_value[1]), chr(pixel_value[2])&#125;&#x27;)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>    pixel_value = image.getpixel((i, i**<span class="hljs-number">3</span>))<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">chr</span>(pixel_value[j]).isascii()):<br>            str2 += <span class="hljs-built_in">chr</span>(pixel_value[j])<br>        <span class="hljs-keyword">else</span>:<br>            str2 += <span class="hljs-string">&quot; &quot;</span><br><span class="hljs-built_in">print</span>(str2)<br><br><span class="hljs-comment"># DRKCTF&#123;H HA AH _L iM Is oC te </span><br><span class="hljs-comment"># DRKCTF&#123; AH HA A_ ei uI So ut &#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Writeups</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CISCN 2024 Qual Writeup</title>
    <link href="/CISCN-2024-Qual-Writeup.html"/>
    <url>/CISCN-2024-Qual-Writeup.html</url>
    
    <content type="html"><![CDATA[<p>è§£äº†ç‚¹Cryptoå’ŒMiscé¢˜ç›®ï¼Œè®°å½•ä¸‹è‡ªå·±çš„é¢˜è§£ã€‚é¢˜ç›®çš„é™„ä»¶åœ¨æ¢å§¬ä½¬çš„<ahref="https://github.com/CTF-Archives/CISCN2024">repo</a>é‡Œå¯ä»¥æ‰¾åˆ°ï¼Œå°±ä¸å†é¢å¤–è¯´æ˜é¢˜ç›®äº†ã€‚</p><h1 id="misc">Misc</h1><h2 id="é€šé£æœº">é€šé£æœº</h2><p>TriIDè¯†åˆ«å‡ºæ˜¯SybaseiAnywhereçš„databaseï¼Œä¸è¿‡ä¼¼ä¹å¹¶ä¸å¯¹ã€‚Googleäº†ä¸€ä¸‹åŸºæœ¬éƒ½æŒ‡å‘Siemensçš„S7-200Programï¼Œéšä¾¿æ‰¾äº†ä¸ª<ahref="https://plc4me.com/download-step-7_v4-s7-200-siemens-plc-software-real-100/">ä¸‹è½½ç«™</a>ä¸‹è½½å®‰è£…ã€‚è¿™é‡Œå»ºè®®è£…åœ¨è™šæ‹Ÿæœºï¼Œæ¯•ç«Ÿæˆ‘å¯¹äºè¿™ç±»ä¸‹è½½ç«™éƒ½ä¸å¾ˆä¿¡ä»»ï¼Œå¹¶ä¸”è¿™ä¸ªä¸Šå¤è½¯ä»¶æœ¬èº«å°±å¾ˆè„...</p><p>å®‰è£…ä¹‹åä¹Ÿå¹¶ä¸èƒ½ç›´æ¥æ‰“å¼€è¿™ä¸ªmwpæ–‡ä»¶ï¼Œæ‰¾ä¸€ä»½mwpæ–‡ä»¶å¯¹æ¯”ä¸€ä¸‹+å„æ–¹æœç´¢ï¼Œç¡®è®¤æ˜¯æ–‡ä»¶å¤´ç¼ºå°‘äº†3å­—èŠ‚ã€‚æ·»åŠ ä¸Š<code>47 4A 4B</code>ä¹‹åæ­£å¸¸æ‰“å¼€ï¼Œåœ¨SymbolTableé‡Œæœ‰</p><figure><img src="../assets/7f920daec9affbe2765bb844dc0d0875.png"alt="é€šé£æœº" /><figcaption aria-hidden="true">é€šé£æœº</figcaption></figure><p>base64 decodeå³å¯ã€‚</p><p><code>flag&#123;2467ce26-fff9-4008-8d55-17df83ecbfc2&#125;</code></p><p>Update: å¤ç°å‘ç°ç›´æ¥binwalk-eåˆ†ç¦»æ–‡ä»¶åstringså°±èƒ½æ‹¿åˆ°é‚£ä¸²base64ã€‚è¿™ä¸ªå¥—è·¯æˆ‘æœ¬æ¥è¿˜æŒºç†Ÿæ‚‰çš„ï¼Œç»“æœèµ›åœºä¸Šè¿˜æ˜¯å¤ªè·¯å¾„ä¾èµ–äº†...</p><h2 id="ç›—ç‰ˆè½¯ä»¶">ç›—ç‰ˆè½¯ä»¶</h2><p>å¾ˆç¥å¥‡çš„é¢˜ç›®ï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ªdmpå’Œä¸€ä¸ªexeã€‚æœ€åˆç›´æ¥010editoräººè‚‰ç›¯å¸§dmpæ–‡ä»¶æ‰¾åˆ°äº†ä¸ª<code>www.waodown.com</code>ï¼Œäº¤flagç¢°å£æ•°åæ¬¡ä¹‹åè§‰å¾—åº”è¯¥ä¸æ˜¯è¿™ä¸ªåŸŸå...åæ¥å’Œé˜Ÿå‹å¤´è„‘é£æš´äº†åŠä¸ªå°æ—¶ï¼Œæƒ³èµ·æ¥å¤´å¤©æ™šä¸Šå¤ç›˜å‰äº›å¹´çš„CISCNæ—¶ç”¨åˆ°çš„gimpï¼ŒæŠ±ç€è¯•è¯•çœ‹çš„å¿ƒæ€å°†dmpä½œä¸ºrawdataæ‰“å¼€å›¾åƒï¼Œæ‰‹å·¥fuzzäº†ä½ç§»å’Œå®½é«˜(unintendedsolutionå¯èƒ½ï¼ŸæŠ½è±¡åšæ³•)åæ•´å‡ºæ¥äº†ï¼š</p><figure><img src="../assets/æˆªå±2024-05-19%2017.30.15.png" alt="gimp-yyds" /><figcaption aria-hidden="true">gimp-yyds</figcaption></figure><p>IPåœ°å€è¿˜å¾—ä»exeå…¥æ‰‹ï¼Œæ‰”æ²™ç®±é‡Œçœ‹åˆ°exeè¿è¡Œåç”Ÿæˆäº†loader.exeå’Œä¸€ä¸ªpngã€‚å¯¹malwareæœ‰ç»éªŒçš„åº”è¯¥é©¬ä¸Šå°±èƒ½ååº”è¿‡æ¥pngé‡Œå¤§æ¦‚æœ‰shellcodeï¼Œè€Œloaderå°±æ˜¯åŠ è½½Shellcodeè¿æ¥C2æ‰§è¡Œåç»­æ¶æ„è¡Œä¸ºçš„ã€‚pngä¸¢åˆ°Stegsolveé‡Œç›¯å‡ºæ¥äº†LSBéšå†™ï¼š</p><figure><img src="../assets/image-1.png" alt="&quot;ç¨€ç–åµŒå…¥&quot;" /><figcaption aria-hidden="true">"ç¨€ç–åµŒå…¥"</figcaption></figure><p>å…¸å‹çš„<code>50 4B 03 04</code>ï¼Œzipå¤´ã€‚è®©GPTæ“ä¸ªè„šæœ¬æå–å‡ºzipï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_bytes</span>(<span class="hljs-params">input_file, output_file</span>):<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(input_file, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f_in, <span class="hljs-built_in">open</span>(output_file, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f_out:<br>            byte_index = <span class="hljs-number">0</span><br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>                byte = f_in.read(<span class="hljs-number">1</span>)  <span class="hljs-comment"># è¯»å–ä¸€ä¸ªå­—èŠ‚</span><br>                <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> byte:  <span class="hljs-comment"># åˆ¤æ–­æ˜¯å¦å·²ç»è¯»åˆ°æ–‡ä»¶æœ«å°¾</span><br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">if</span> byte_index % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:  <span class="hljs-comment"># æ¯éš”ä¸€ä¸ªå­—èŠ‚æå–ä¸€ä¸ªå­—èŠ‚</span><br>                    f_out.write(byte)  <span class="hljs-comment"># å†™å…¥æå–çš„å­—èŠ‚</span><br>                byte_index += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;An error occurred: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><br><span class="hljs-comment"># æŒ‡å®šè¾“å…¥æ–‡ä»¶å’Œè¾“å‡ºæ–‡ä»¶çš„è·¯å¾„</span><br>input_file = <span class="hljs-string">&quot;1.bin&quot;</span><br>output_file = <span class="hljs-string">&quot;output.zip&quot;</span><br><br><span class="hljs-comment"># è°ƒç”¨æå–å­—èŠ‚çš„å‡½æ•°</span><br>extract_bytes(input_file, output_file)<br></code></pre></td></tr></table></figure><p>æå–ä¹‹ååˆ é™¤å¤šä½™çš„ä¸€å¨æ–‡ä»¶å°¾ï¼Œè§£å‹å¾—åˆ°.bã€‚.bçœ‹èµ·æ¥å¾ˆåƒbase85ï¼ŒçŒœæµ‹è§£ç ä¹‹åå°±æ˜¯Shellcodeâ€”â€”ä½ è¯´çš„å¯¹ï¼Œä½†æ˜¯é¢˜ç›®ç»™çš„loader.exeå‹æ ¹å°±ä¸æ˜¯exeè€Œæ˜¯ä¸€å¨0xff(æˆ–è®¸æˆ‘çš„é™„ä»¶æœ‰é—®é¢˜ï¼Ÿ)ï¼Œæˆ‘ä¸€åº¦ä»¥ä¸ºè¿˜éœ€è¦æ‰‹æ“ShellcodeloaderğŸ˜…</p><p>è§£ç åçš„æ–‡ä»¶ä¸¢VTä¸Šä¸€å †æŠ¥æ¯’(è²Œä¼¼æ˜¯MetaSploitå®¶æ—çš„ï¼Ÿ)ï¼Œä½†æ˜¯YARAè§„åˆ™æ²¡è¯†åˆ«å‡ºIPã€‚ä¸¢<ahref="https://s.threatbook.com/report/file/a97946c34d2d8642820f196a54a6e8d78cf4f58a97e417be9696d7fd19e7fc95">å¾®æ­¥</a>å‘ç°å·²ç»æœ‰ç»“æœäº†ï¼Œåº”è¯¥æ˜¯åšå‡ºæ¥çš„å‰äººä¼ çš„å§ï¼š</p><figure><img src="../assets/image-2.png" alt="å‰äººçš„æ™ºæ…§" /><figcaption aria-hidden="true">å‰äººçš„æ™ºæ…§</figcaption></figure><p>MD5ä¹‹åï¼Œæäº¤ï¼Œgetã€‚</p><p>å¯æƒœæ­¤æ—¶å·²ç»é»‘ç¯äº†ï¼Œå¯¼è‡´åæ¥é˜Ÿå‹å‡ºçš„å¦å¤–ä¸¤é“é¢˜åªèƒ½æŒ‘ä¸€é“æäº¤ï¼Œä¸è¿‡å¥½åœ¨å¦ä¸¤é“æœ€åéƒ½æ˜¯50åˆ†ï¼Œå€’ä¹Ÿæ²¡æœ‰äºä»€ä¹ˆåˆ†æ•°ğŸ˜‡</p><p>flag{096e8b0f9daf10869f013c1b7efda3fd}</p><h2 id="ç¥ç§˜æ–‡ä»¶">ç¥ç§˜æ–‡ä»¶</h2><p>å’Œé˜Ÿå‹åˆåŠ›è§£çš„ï¼Œç¡¬æ§3hæ˜¯çœŸçš„åç‰¢ğŸ¤ª</p><p>ç»†èŠ‚ä¸æƒ³å†™äº†ï¼Œå¤§æ¦‚è¯´ä¸€ä¸‹å¡ä½çš„å‡ ä¸ªç‚¹å§ã€‚</p><ol type="1"><li><p>å®é‡Œé¢çš„RC4æ²¡æœ‰å¯†é’¥ï¼Œä¸”å¯†ç å­¦å·¥å…·ç®±ä¸èƒ½æ­£å¸¸è§£å¯†(ä¹Ÿå¯èƒ½æˆ‘æ“ä½œä¸å½“ï¼Œæ¬¢è¿äº¤æµ)ã€‚(æ‰¾äº†ä¸€ä¸‹åˆå¯†é’¥ä½ å‘Šè¯‰æˆ‘å¯†é’¥ä¸ºç©ºï¼Ÿ)</p></li><li><p>å±æ€§é‡Œçš„<code>ha?again?</code>æ˜¯æ²¡ç”¨çš„</p></li><li><p>ç¬¬å››å¼ PPTé‡Œæ£€æŸ¥é˜…è¯»é¡ºåºå¯ä»¥æ‹¿åˆ°Part7</p></li><li><p>å¹»ç¯ç‰‡æ¯ç‰ˆé‡Œæœ‰Part8ã€‚å…¶å®è¿™é‡Œç›´æ¥è§£å‹PPTä¼šå‘ç°ä¸€ä¸ªçœ‹ä¼¼æ²¡æœ‰ç”¨åˆ°çš„æ–‡æœ¬æ¡†ï¼Œä½œä¸ºçº¿ç´¢å¯ä»¥æ‰¾åˆ°è¿™ä¸ªç‚¹ã€‚</p></li></ol><h1 id="crypto">Crypto</h1><h2 id="å¤å…¸å¯†ç ">å¤å…¸å¯†ç </h2><p>æ„Ÿè°¢cyberchefï¼Œåœ¨æˆ‘èµ°æŠ•æ— è·¯çš„æ—¶å€™ä¿¡æ‰‹ç­›é€‰äº†ä¸‹Cipherï¼ŒæŠŠç¬¬ä¸€ä¸ªAtbashCipheræ‹–è¿›å»ç›´æ¥å°±é­”æ³•æ£’äº†ğŸª„</p><figure><img src="../assets/image-3.png" alt="å¤§å¨æˆ‘å¥½å–œæ¬¢ä½ å•Š" /><figcaption aria-hidden="true">å¤§å¨æˆ‘å¥½å–œæ¬¢ä½ å•Š</figcaption></figure><h2 id="ovo">OvO</h2><p>æŒºä¸é”™çš„æ•°å­¦é¢˜ï¼Œå¬äººè¯´è·ŸXYçš„æŸä¸ªCopperæ˜¯åŒä¸€ç¯‡Paperï¼Ÿä¸è¿‡æˆ‘æ˜¯æ²¡çœ‹å‡ºæ¥ï¼Œæ¬¢è¿å„ä½æŒ‡æ•™ã€‚</p><p>ä¸€ä¸ªæœ‰ç”¨çš„è§‚å¯Ÿæ˜¯<span class="math inline">\(e//n =rr\)</span>ï¼Œè¿™æ ·å°±æ¶ˆå»äº†ä¸€ä¸ªå˜é‡ã€‚æˆ‘ä»¬æ‹¿åˆ°çš„eç»è¿‡äº†æˆªä½ï¼Œå¹¶ä¸”é«˜ä½ä¿¡æ¯æ˜æ˜¾è·Ÿpï¼Œqæœ‰å…³ï¼Œæ‰€ä»¥éœ€è¦æƒ³åŠæ³•æŠ å‡ºç‚¹pæˆ–è€…qçš„é«˜ä½ä¿¡æ¯ã€‚</p><p>åœ¨çº¸ä¸Šæ¨ç®—ä¸€ä¼šå„¿å¯ä»¥å‘ç°ï¼Œ<span class="math inline">\(65537 + kk * p+ rr * ((p+1) * (q+1)) +1\)</span>è¿™ä¸ªå¼å­ä¹˜ä¸Špæ˜¯å¯ä»¥å†æ¶ˆå»ä¸€ä¸ªå˜é‡çš„ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥å°è¯•å¤šé¡¹å¼æ±‚æ ¹äº†ã€‚</p><p>å¦‚æœeæ²¡æœ‰æˆªä½ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‹¿åˆ°<span class="math inline">\(f = (65537*x +kk*x^2 + (kk+2)*n*x + (kk+2)*x^2 + (kk+2)*n + (kk+3)*x) -e*x\)</span>ä¹‹åç›´æ¥f.roots()å°±å¯ä»¥å¾—åˆ°pã€‚ä½†æ˜¯eç»è¿‡äº†æˆªä½ï¼Œæ‰€ä»¥å¾—åˆ°çš„xå…¶å®æ¯”pè¦å¤§/å°ä¸€ç‚¹ï¼Œä¸è¿‡è¿™å·²ç»å¯ä»¥è®©æˆ‘ä»¬æ‹¿åˆ°pçš„é«˜ä½äº†â€”â€”æ‹¿åˆ°é«˜ä½å°±å¤Ÿäº†ã€‚åé¢å°±æ˜¯ç®€å•çš„pé«˜ä½æ³„éœ²ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Sage</span><br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">111922722351752356094117957341697336848130397712588425954225300832977768690114834703654895285440684751636198779555891692340301590396539921700125219784729325979197290342352480495970455903120265334661588516182848933843212275742914269686197484648288073599387074325226321407600351615258973610780463417788580083967</span><br>e = <span class="hljs-number">37059679294843322451875129178470872595128216054082068877693632035071251762179299783152435312052608685562859680569924924133175684413544051218945466380415013172416093939670064185752780945383069447693745538721548393982857225386614608359109463927663728739248286686902750649766277564516226052064304547032760477638585302695605907950461140971727150383104</span><br>c = <span class="hljs-number">14999622534973796113769052025256345914577762432817016713135991450161695032250733213228587506601968633155119211807176051329626895125610484405486794783282214597165875393081405999090879096563311452831794796859427268724737377560053552626220191435015101496941337770496898383092414492348672126813183368337602023823</span><br><span class="hljs-comment"># rr = e//n, rr == 331118458487559161870846961263454730639,ä»¥ä¸‹çš„rräº‹å®ä¸Šæ˜¯kkï¼ˆ</span><br>rr = <span class="hljs-number">331118458487559161870846961263454730637</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Copper</span>(<span class="hljs-params">n, c, e, rr</span>):<br>R.&lt;x&gt; = PolynomialRing(RealField(<span class="hljs-number">1024</span>))<br>f = (<span class="hljs-number">65537</span>*x + rr*x^<span class="hljs-number">2</span> + (rr+<span class="hljs-number">2</span>)*n*x + (rr+<span class="hljs-number">2</span>)*x^<span class="hljs-number">2</span> + (rr+<span class="hljs-number">2</span>)*n + (rr+<span class="hljs-number">3</span>)*x) - e*x<br>f = f.monic()<br>res = f.roots()<br><span class="hljs-keyword">if</span>(res):<br><span class="hljs-keyword">return</span> res<br><br>res = Copper(n, c, e, rr)<br><span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> res:<br>    p_hi = <span class="hljs-built_in">int</span> (root[<span class="hljs-number">0</span>])<br>    PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>    ff = x + p_hi<br>    roots_1 = ff.monic().small_roots(X=<span class="hljs-number">2</span>^<span class="hljs-number">200</span>, beta=<span class="hljs-number">0.3</span>)<br>    <span class="hljs-keyword">if</span> roots_1:<br>        p = <span class="hljs-built_in">int</span>(roots_1[<span class="hljs-number">0</span>]) + p_hi<br>        q = n//p<br>        e = <span class="hljs-number">65537</span> + rr * p + (rr+<span class="hljs-number">2</span>) * (p+<span class="hljs-number">1</span>) * (q+<span class="hljs-number">1</span>) + <span class="hljs-number">1</span><br>        d = inverse(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>        m = <span class="hljs-built_in">pow</span>(c, d, n)<br>        <span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure><p>å—¯ï¼Œexpé‡Œçš„Copperå‡½æ•°å…¶å®ä¸æ˜¯CopperSmithï¼Œä¹‹æ‰€ä»¥å«è¿™ä¸ªæ˜¯å› ä¸ºæ˜¯ä»CopperSmithçš„æ¿å­æ”¹è¿‡æ¥çš„ï¼Œæˆ‘æ‡’å¾—æ”¹åå­—äº†ï¼ˆè½»å–·qwq</p><h2 id="hash">*hash</h2><p>Python 2.7å†…ç½®çš„hashæ˜¯é­”æ”¹äº†ä¸€ç‚¹çš„fnvhashï¼Œé—®é—®GPTå°±å¯ä»¥å¾—åˆ°å®ç°ç»†èŠ‚ã€‚çˆ†ç ´çš„æ—¶å€™ä½¿ç”¨ä¸­é—´ç›¸é‡çš„æ‰‹æ³•ï¼Œå¯ä»¥å¤§å¹…é™ä½æ—¶é—´å¤æ‚åº¦ã€‚</p><p>å› ä¸ºèµ›åœºä¸Šæ²¡å»ç¿»æºç åˆç†è§£é”™äº†GPTçš„å›å¤ï¼Œä»¥ä¸ºè¾“å‡ºå‰å¼‚æˆ–çš„æ˜¯bitlengthï¼Œæ‰€ä»¥æœ€åä¸flagå¤±ä¹‹äº¤è‡‚ğŸ˜­ğŸ˜­å…¶å®Python 2.7çš„hashæœ€åæ˜¯ä¸bytelengthåšå¼‚æˆ–åè¾“å‡ºã€‚ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> inverse<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> trange<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>():<br>    start_time = time.time()<br>    mask = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">64</span>) - <span class="hljs-number">1</span><br>    lookup_table = &#123;&#125;<br><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> trange(<span class="hljs-number">256</span>, desc=<span class="hljs-string">&quot;Building table&quot;</span>):<br>        x = <span class="hljs-number">0</span><br>        x = (x ^ (a &lt;&lt; <span class="hljs-number">7</span>)) &amp; mask<br>        x = ((x * <span class="hljs-number">1000003</span>) ^ a) &amp; mask<br>        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            x2 = ((x * <span class="hljs-number">1000003</span>) ^ b) &amp; mask<br>            <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                x3 = ((x2 * <span class="hljs-number">1000003</span>) ^ c) &amp; mask<br>                lookup_table[x3] = <span class="hljs-built_in">bytes</span>([a, b, c])<br><br>    ni = inverse(<span class="hljs-number">1000003</span>, <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">64</span>)<br>    target_value = <span class="hljs-number">7457312583301101235</span><br><br>    <span class="hljs-keyword">for</span> a <span class="hljs-keyword">in</span> trange(<span class="hljs-number">256</span>, desc=<span class="hljs-string">&quot;Searching&quot;</span>):<br>        <span class="hljs-comment"># è¿™é‡Œå¼‚æˆ–çš„æ˜¯å­—èŠ‚é•¿åº¦</span><br>        r1 = (target_value ^ <span class="hljs-number">7</span>) &amp; mask<br>        r1 = ((r1 ^ a) * ni) &amp; mask<br>        <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>            r2 = ((r1 ^ b) * ni) &amp; mask<br>            <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                r3 = ((r2 ^ c) * ni) &amp; mask<br>                <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>                    r4 = ((r3 ^ d) * ni) &amp; mask<br>                    <span class="hljs-keyword">if</span> r4 <span class="hljs-keyword">in</span> lookup_table:<br>                        <span class="hljs-built_in">print</span>(lookup_table[r4] + <span class="hljs-built_in">bytes</span>([d, c, b, a]))<br>                        end_time = time.time()<br>                        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Time elapsed: <span class="hljs-subst">&#123;(end_time - start_time) / <span class="hljs-number">60</span>&#125;</span> minutes&quot;</span>)<br>                        <span class="hljs-keyword">return</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    main()<br></code></pre></td></tr></table></figure></p><figure><img src="../assets/yyds.png" alt="6åˆ†é’Ÿå°±å¯ä»¥äº†" /><figcaption aria-hidden="true">6åˆ†é’Ÿå°±å¯ä»¥äº†</figcaption></figure><p>ç¿»äº†ä¸€ä¸‹CTFwikiï¼Œå‘ç°ç›´æ¥æ‹¿æ ¼å­å»æ‰“ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå®éªŒäº†ä¸€ä¸‹é€Ÿåº¦ç¡®å®å¿«ä¸Šä¸å°‘ã€‚åªèƒ½è¯´å­¦æµ·æ— æ¶¯äº†ã€‚</p><h1 id="reverse">Reverse</h1><h2 id="asm_re">asm_re</h2><p>ä¸‰è„šçŒ«æ°´å¹³çš„æˆ‘ä¹Ÿåªèƒ½åšåšReç­¾åˆ°äº†ï¼ˆ</p><p>æ±‡ç¼–å¾ˆé•¿ï¼Œä¸æƒ³çœ‹çš„è¯ç›´æ¥ä¸¢ç»™GPTï¼ŒGPTå¤§æ¦‚ç‡ä¼šå‘Šè¯‰ä½ è¿™ç©æ„å„¿çš„ä¸»ä½“é€»è¾‘çš„ä½ç½®ã€‚ç¨å¾®å®¡è®¡ä¸€ä¸‹å‘ç°å°±æ˜¯ä¸ªä»¿å°„+å¼‚æˆ–ï¼Œç›´æ¥é€†å›å»å°±è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">expected_data = [<span class="hljs-number">0x1fd7</span>,<span class="hljs-number">0x21b7</span>,<span class="hljs-number">0x1e47</span>,<span class="hljs-number">0x2027</span>,<span class="hljs-number">0x26e7</span>,<span class="hljs-number">0x10d7</span>,<span class="hljs-number">0x1127</span>,<span class="hljs-number">0x2007</span>,<span class="hljs-number">0x11c7</span>,<span class="hljs-number">0x1e47</span>,<span class="hljs-number">0x1017</span>,<span class="hljs-number">0x1017</span>,<span class="hljs-number">0x11f7</span>,<span class="hljs-number">0x2007</span>,<span class="hljs-number">0x1037</span>,<span class="hljs-number">0x1107</span>,<span class="hljs-number">0x1f17</span>,<span class="hljs-number">0x10d7</span>,<span class="hljs-number">0x1017</span>,<span class="hljs-number">0x1017</span>,<span class="hljs-number">0x1f67</span>,<span class="hljs-number">0x1017</span>,<span class="hljs-number">0x11c7</span>,<span class="hljs-number">0x11c7</span>,<span class="hljs-number">0x1017</span>,<span class="hljs-number">0x1fd7</span>,<span class="hljs-number">0x1f17</span>,<span class="hljs-number">0x1107</span>,<span class="hljs-number">0x0f47</span>,<span class="hljs-number">0x1127</span>,<span class="hljs-number">0x1037</span>,<span class="hljs-number">0x1e47</span>,<span class="hljs-number">0x1037</span>,<span class="hljs-number">0x1fd7</span>,<span class="hljs-number">0x1107</span>,<span class="hljs-number">0x1fd7</span>,<span class="hljs-number">0x1107</span>,<span class="hljs-number">0x2787</span>]<br><br><span class="hljs-comment"># å°†é¢„æœŸæ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span><br>flag_chars = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(expected_data)):<br>    byte_value = expected_data[i]<br>    char = <span class="hljs-built_in">chr</span>((((byte_value - <span class="hljs-number">0x1E</span>)^ <span class="hljs-number">0x4D</span>) - <span class="hljs-number">0x14</span> ) // <span class="hljs-number">0x50</span>)<br>    flag_chars.append(char)<br><br><span class="hljs-comment"># æ¢å¤çš„ flag</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span>.join(flag_chars)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Recovered flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ³¨æ„æå–ç›®æ ‡çš„æ•°ç»„çš„æ—¶å€™è°ƒä¸€ä¸‹åˆ†ç»„å¤§å°å’Œç«¯åºå°±è¡Œã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Writeups</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
      <tag>Misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>imaginaryCTF-round45</title>
    <link href="/imaginaryCTF-round45.html"/>
    <url>/imaginaryCTF-round45.html</url>
    
    <content type="html"><![CDATA[<h1 id="imaginaryctf-round45-crypto-writeup">imaginaryCTF Round45 CryptoWriteup</h1><p>ä»¥Ciprocaminçš„åä¹‰soloçš„æ¯”èµ›,é¢„è®¡ä»¥åæ¯ä¸ªæœˆéƒ½ä¼šå†™ä¸€æ¬¡Cryptoæ–¹å‘çš„wp,å§‘ä¸”é­ç­–ä¸‹è‡ªå·±.</p><span id="more"></span><h2 id="time">time</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/local/bin/python</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">message, key</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    ciphertext = cipher.encrypt(pad(message, AES.block_size))<br>    <span class="hljs-keyword">return</span> ciphertext<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read().strip()<br>random.seed(<span class="hljs-built_in">int</span>(time.time()))<br>key = random.randbytes(<span class="hljs-number">16</span>)<br><br>encrypted_flag = encrypt(flag, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Encrypted flag (in hex):&quot;</span>, encrypted_flag.<span class="hljs-built_in">hex</span>())<br></code></pre></td></tr></table></figure><p>ncè¿ä¸Šä¹‹åä¼šæ ¹æ®æœåŠ¡å™¨ç«¯çš„æ—¶é—´è®¾ç½®seed,ç®€å•çˆ†ç ´ä¸€ä¸‹å°±å¯ä»¥è·å¾—AESkey.</p><h2 id="time2">time2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/local/bin/python</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">message, key</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    ciphertext = cipher.encrypt(pad(message, AES.block_size))<br>    <span class="hljs-keyword">return</span> ciphertext<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read().strip()<br>random.seed(<span class="hljs-built_in">int</span>(os.urandom(<span class="hljs-number">64</span>).<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>)) <span class="hljs-comment"># super secure!</span><br>key = <span class="hljs-string">b&#x27;&#x27;</span><br>x=random.randbytes(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>key += x<br>random.seed(<span class="hljs-built_in">int</span>(x.<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>))<br>x = random.randbytes(<span class="hljs-number">1</span>)<br>encrypted_flag = encrypt(flag, key)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Encrypted flag (in hex):&quot;</span>, encrypted_flag.<span class="hljs-built_in">hex</span>())<br><br><span class="hljs-comment"># Encrypted flag (in hex): 04b5b9e11ee236a1c0784882d3f8efe9cc28b2993971a83413907e9833190e2a99e611c748966d61489f84ea2f331c7c</span><br></code></pre></td></tr></table></figure><p>çˆ†ç ´keyçš„é¦–å­—èŠ‚å³å¯. <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad, unpad<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    plaintext = unpad(cipher.decrypt(ciphertext), AES.block_size)<br>    <span class="hljs-keyword">return</span> plaintext<br><br><br>ciphertext = long_to_bytes(<span class="hljs-number">0x04b5b9e11ee236a1c0784882d3f8efe9cc28b2993971a83413907e9833190e2a99e611c748966d61489f84ea2f331c7c</span>)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">256</span>):<br>key = <span class="hljs-string">b&#x27;&#x27;</span><br>x = <span class="hljs-built_in">bytes</span>([i])<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>key += x<br>random.seed(<span class="hljs-built_in">int</span>(x.<span class="hljs-built_in">hex</span>(),<span class="hljs-number">16</span>))<br>x=random.randbytes(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">try</span>:<br>flag = decrypt(ciphertext,key)<br><span class="hljs-keyword">if</span>(<span class="hljs-string">b&#x27;ictf&#x27;</span> <span class="hljs-keyword">in</span> flag):<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">except</span>:<br><span class="hljs-keyword">continue</span><br><br><br></code></pre></td></tr></table></figure></p><h2 id="crack">crack</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#!/usr/local/bin/python</span><br><span class="hljs-keyword">import</span> random<br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>).read()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Welcome! Let&#x27;s play a game!&quot;</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">print_menu</span>():<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&quot;&quot;1) Get random bits</span><br><span class="hljs-string">2) Guess number</span><br><span class="hljs-string">3) Exit&quot;&quot;&quot;</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>print_menu()<br>x = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Choice: &quot;</span>))<br><span class="hljs-keyword">if</span> x == <span class="hljs-number">1</span>:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;How many random numbers do you want?&quot;</span>)<br>r = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>())<br>arr = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r):<br>arr.append(random.getrandbits(<span class="hljs-number">32</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;Here you go: <span class="hljs-subst">&#123;arr&#125;</span>&#x27;</span>)<br><span class="hljs-keyword">if</span> x == <span class="hljs-number">2</span>:<br>to_guess = random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">65535</span>*<span class="hljs-number">65537</span>)<br>guess = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;Enter guess: &quot;</span>))<br><span class="hljs-keyword">if</span> guess == to_guess:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Wow! Here&#x27;s your flag: <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br><span class="hljs-keyword">else</span>:<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Incorrect!&#x27;</span>)<br>exit()<br><span class="hljs-keyword">if</span> x == <span class="hljs-number">3</span>:<br>exit()<br></code></pre></td></tr></table></figure><p>å¯ä»¥é€‰æ‹©è·å–çš„éšæœºæ•°çš„æ•°é‡,ç„¶åè¦æ±‚é¢„æµ‹ä¸€ä¸ªéšæœºæ•°.Pythoné»˜è®¤å†…ç½®çš„éšæœºæ•°å‘ç”Ÿå™¨æ˜¯MT19937,åªè¦è·å–è¿ç»­è¾“å‡ºçš„624ä¸ª32-bitéšæœºæ•°å°±å¯ä»¥é¢„æµ‹éšåçš„éšæœºæ•°åºåˆ—.è¿™é‡Œä½¿ç”¨randcrackä¸€æŠŠæ¢­.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random, time<br><span class="hljs-keyword">from</span> randcrack <span class="hljs-keyword">import</span> RandCrack<br><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><br>io = remote(<span class="hljs-string">&#x27;34.72.43.223&#x27;</span>,<span class="hljs-string">&#x27;49133&#x27;</span>)<br>io.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>io.sendline(<span class="hljs-string">b&#x27;624&#x27;</span>)<br>io.readuntil(<span class="hljs-string">b&#x27;Here you go: &#x27;</span>)<br>arr = (io.readline().strip())<br>x = <span class="hljs-string">b&#x27;arr = &#x27;</span> + arr<br><span class="hljs-built_in">exec</span>(x)<br><br>rc = RandCrack()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">624</span>):<br>rc.submit(arr[i])<br><br>answer = rc.predict_randint(<span class="hljs-number">0</span>, <span class="hljs-number">65535</span>*<span class="hljs-number">65537</span>)<br>io.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>io.sendline(<span class="hljs-built_in">str</span>(answer).encode())<br>io.readuntil(<span class="hljs-string">b&quot;Wow! Here&#x27;s your flag: &quot;</span>)<br><span class="hljs-built_in">print</span>(io.readline().strip())<br></code></pre></td></tr></table></figure></p><h2 id="scissor">Scissor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python">flag = <span class="hljs-string">&#x27;REDACTED&#x27;</span><br>ciphertext = <span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>ciphertext += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(i)+<span class="hljs-number">0x1337</span>).encode()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;ciphertext = <span class="hljs-subst">&#123;ciphertext.<span class="hljs-built_in">hex</span>()&#125;</span>&#x27;</span>)<br><br><span class="hljs-comment"># ciphertext = e18ea0e18e9ae18eabe18e9de18eb2e18e9ae18daae18ea9e18daee18da8e18e9de18da8e18daae18e9be18e96e18da8e18daae18daae18daee18e96e18e9fe18dabe18eafe18da7e18ea9e18d98e18eb4</span><br></code></pre></td></tr></table></figure><p>è§‚å¯Ÿè¾“å‡ºçš„å¯†æ–‡å¯ä»¥å‘ç°æ¯6å­—èŠ‚ä¸€ç»„,æ¯ç»„å‡å»0x1337å³å¯.<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>c_list = [<span class="hljs-number">0xe18ea0</span>,<span class="hljs-number">0xe18e9a</span>,<span class="hljs-number">0xe18eab</span>,<span class="hljs-number">0xe18e9d</span>,<span class="hljs-number">0xe18eb2</span>,<span class="hljs-number">0xe18e9a</span>,<span class="hljs-number">0xe18daa</span>,<span class="hljs-number">0xe18ea9</span>,<span class="hljs-number">0xe18dae</span>,<span class="hljs-number">0xe18da8</span>,<span class="hljs-number">0xe18e9d</span>,<span class="hljs-number">0xe18da8</span>,<span class="hljs-number">0xe18daa</span>,<span class="hljs-number">0xe18e9b</span>,<span class="hljs-number">0xe18e96</span>,<span class="hljs-number">0xe18da8</span>,<span class="hljs-number">0xe18daa</span>,<span class="hljs-number">0xe18daa</span>,<span class="hljs-number">0xe18dae</span>,<span class="hljs-number">0xe18e96</span>,<span class="hljs-number">0xe18e9f</span>,<span class="hljs-number">0xe18dab</span>,<span class="hljs-number">0xe18eaf</span>,<span class="hljs-number">0xe18da7</span>,<span class="hljs-number">0xe18ea9</span>,<span class="hljs-number">0xe18d98</span>,<span class="hljs-number">0xe18eb4</span>]<br>s = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> c_list:<br>    s+=<span class="hljs-built_in">chr</span>(<span class="hljs-built_in">ord</span>(long_to_bytes(i).decode())-<span class="hljs-number">0x1337</span>)<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure></p><h2 id="moonjump">Moonjump</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">u</span><span class="hljs-params">(s)</span></span><br>    <span class="hljs-keyword">local</span> r = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> i = #s, <span class="hljs-number">1</span>, <span class="hljs-number">-1</span> <span class="hljs-keyword">do</span><br>        r = r * <span class="hljs-number">256</span><br>        r = r + <span class="hljs-built_in">string</span>.<span class="hljs-built_in">byte</span>(<span class="hljs-built_in">string</span>.<span class="hljs-built_in">sub</span>(s, i, i))<br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">return</span> r<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sw</span><span class="hljs-params">(t, a, b)</span></span><br>    <span class="hljs-keyword">local</span> x = t[a]<br>    t[a] = t[b]<br>    t[b] = x<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">s</span><span class="hljs-params">(k)</span></span><br>    <span class="hljs-keyword">local</span> r = &#123;&#125;<br><br>    <span class="hljs-keyword">for</span> i = <span class="hljs-number">0</span>, <span class="hljs-number">255</span> <span class="hljs-keyword">do</span><br>        r[i] = i<br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">local</span> j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">local</span> idx = <span class="hljs-number">0</span><br><br>    <span class="hljs-keyword">for</span> i = <span class="hljs-number">0</span>, <span class="hljs-number">255</span> <span class="hljs-keyword">do</span><br>        idx = (i % #k) + <span class="hljs-number">1</span><br>        j = (j + r[i] + k:<span class="hljs-built_in">sub</span>(idx, idx):<span class="hljs-built_in">byte</span>()) % <span class="hljs-number">256</span><br>        sw(r, i, j)<br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">return</span> r<br><span class="hljs-keyword">end</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">e</span><span class="hljs-params">(p, k)</span></span><br>    <span class="hljs-keyword">local</span> i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">local</span> j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">local</span> r = <span class="hljs-string">&quot;&quot;</span><br><br>    <span class="hljs-keyword">for</span> l = <span class="hljs-number">1</span>, <span class="hljs-number">3072</span> <span class="hljs-keyword">do</span><br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + k[i]) % <span class="hljs-number">256</span><br>        sw(k, i, j)<br>        t = (k[i] + k[j]) % <span class="hljs-number">256</span><br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">for</span> l = <span class="hljs-number">1</span>, #p <span class="hljs-keyword">do</span><br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + k[i]) % <span class="hljs-number">256</span><br>        sw(k, i, j)<br>        t = (k[i] + k[j]) % <span class="hljs-number">256</span><br>        r = r .. <span class="hljs-built_in">string</span>.<span class="hljs-built_in">char</span>(p:<span class="hljs-built_in">sub</span>(l, l):<span class="hljs-built_in">byte</span>() ~ k[t])<br>    <span class="hljs-keyword">end</span><br><br>    <span class="hljs-keyword">return</span> r<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> f = <span class="hljs-built_in">assert</span>(<span class="hljs-built_in">io</span>.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;moon.bmp&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>))<br><span class="hljs-keyword">local</span> d = f:<span class="hljs-built_in">read</span>(<span class="hljs-string">&quot;*all&quot;</span>)<br>f:<span class="hljs-built_in">close</span>()<br><br><span class="hljs-keyword">local</span> t = <span class="hljs-built_in">os</span>.<span class="hljs-built_in">time</span>()<br><span class="hljs-built_in">math</span>.<span class="hljs-built_in">randomseed</span>(t)<br><br><span class="hljs-keyword">local</span> o = u(<span class="hljs-built_in">string</span>.<span class="hljs-built_in">sub</span>(d, <span class="hljs-number">11</span>, <span class="hljs-number">14</span>)) + <span class="hljs-number">1</span><br><span class="hljs-keyword">local</span> p = <span class="hljs-built_in">string</span>.<span class="hljs-built_in">sub</span>(d, o, #d)<br><br><span class="hljs-keyword">for</span> i = <span class="hljs-number">1</span>, <span class="hljs-number">1000000000000000</span> <span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">math</span>.<span class="hljs-built_in">random</span>()<br><span class="hljs-keyword">end</span><br><br><span class="hljs-keyword">local</span> ks = s(<span class="hljs-built_in">tostring</span>(<span class="hljs-built_in">math</span>.<span class="hljs-built_in">random</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>^<span class="hljs-number">32</span> - <span class="hljs-number">1</span>)))<br><span class="hljs-keyword">local</span> ct = e(p, ks)<br><br>f = <span class="hljs-built_in">assert</span>(<span class="hljs-built_in">io</span>.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;chall.bmp&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>))<br>f:<span class="hljs-built_in">write</span>(<span class="hljs-built_in">string</span>.<span class="hljs-built_in">sub</span>(d, <span class="hljs-number">0</span>, o - <span class="hljs-number">1</span>) .. ct .. <span class="hljs-built_in">os</span>.<span class="hljs-built_in">date</span>(<span class="hljs-string">&quot;!%d %h %Y, %H:%M&quot;</span>, t))<br>f:<span class="hljs-built_in">close</span>()<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨éšæœºæ•°ç”Ÿæˆå¯†é’¥åå¯¹ä½å›¾çš„ä¸€éƒ¨åˆ†åƒç´ åšäº†RC4åŠ å¯†.ç»™å‡ºäº†æ—¶é—´æˆ³,éšæœºæ•°çš„ç§å­æ˜¯å¯ä»¥çˆ†ç ´çš„,æ— éå°±60ç§æƒ…å†µ;ä½†æ˜¯PRNGçš„ä¸­é—´çŠ¶æ€ä¸å°‘äº1000000000000000ç§,ç›´æ¥ä»å¤´è¾“å‡ºçš„è¯,è€—æ—¶æ˜¯ä¸å¯æ¥å—çš„.</p><p>é€šè¿‡æœç´¢äº†è§£åˆ°Lua4.2ä¹‹åå†…ç½®çš„éšæœºæ•°å‘ç”Ÿå™¨ä¸ºXorshiro256**,å…¶æä¾›äº†ä¸€ä¸ªjumpæ“ä½œ,æ‰§è¡Œä¸€æ¬¡å¯ä»¥è·³è¿‡<span class="math inline">\(2^{128}\)</span>ä¸ªçŠ¶æ€,ä¸è¿‡ç®€å•æ¨æ¼”å°±èƒ½çŸ¥é“ä¸é€‚ç”¨äºæœ¬é¢˜.</p><p>èƒ½ä¸èƒ½ä»¿ç…§jumpæ“ä½œ,è‡ªè¡Œå®ç°ä¸€ä¸ªæ›´å°æ­¥é•¿çš„jumpå‘¢?å®¡äº†å®¡Luaä¸­Xorshiro256**çš„æºç ,å‘ç°å…¶å®æ˜¯ä¸ªlinearçš„PRNG,æœ€åè¾“å‡ºæ—¶åšäº†ä¸ªtruncate.æ˜¯çº¿æ€§çš„å°±èƒ½ç®—å‡ºä¸ªçŸ©é˜µ,è¿™æ ·è½¬åŒ–åˆ°äº†å¯¹çŸ©é˜µåšå¹‚è¿ç®—,ç”¨ä¸Šå¿«é€Ÿå¹‚ä¹‹åæ—¶é—´å¤æ‚åº¦ç›´æ¥å°±å¯ä»¥ä¸‹æ¥.</p><p>æœ€ç»ˆexpå¦‚ä¸‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># sage</span><br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> ARC4<br><span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">rotl</span>(<span class="hljs-params">x, n, nbits=<span class="hljs-number">64</span></span>):<br>    <span class="hljs-keyword">return</span> ((x &lt;&lt; n) % (<span class="hljs-number">2</span>**nbits)) | (x &gt;&gt; (<span class="hljs-number">64</span> - n))<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LuaXoshiro</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed=<span class="hljs-number">0</span></span>):<br>        self.seed(seed)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">seed</span>(<span class="hljs-params">self, seed</span>):<br>        self.state = [seed, <span class="hljs-number">0xff</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">raw_seed</span>(<span class="hljs-params">self, state</span>):<br>        self.state = [state &gt;&gt; <span class="hljs-number">192</span>, (state &gt;&gt; <span class="hljs-number">128</span>) % (<span class="hljs-number">2</span>**<span class="hljs-number">64</span>), (state &gt;&gt; <span class="hljs-number">64</span>) % (<span class="hljs-number">2</span>**<span class="hljs-number">64</span>), state % (<span class="hljs-number">2</span>**<span class="hljs-number">64</span>)]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        [s0, s1, s2, s3] = self.state<br>        s2 ^^= s0<br>        s3 ^^= s1<br>        res = rotl((s1 * <span class="hljs-number">5</span>) % (<span class="hljs-number">2</span>**<span class="hljs-number">64</span>), <span class="hljs-number">7</span>) * <span class="hljs-number">9</span> % (<span class="hljs-number">2</span>**<span class="hljs-number">64</span>)<br>        self.state[<span class="hljs-number">0</span>] = s0 ^^ s3<br>        self.state[<span class="hljs-number">1</span>] = s1 ^^ s2<br>        self.state[<span class="hljs-number">2</span>] = s2 ^^ ((s1 &lt;&lt; <span class="hljs-number">17</span>) % (<span class="hljs-number">2</span>**<span class="hljs-number">64</span>))<br>        self.state[<span class="hljs-number">3</span>] = rotl(s3, <span class="hljs-number">45</span>)<br>        <span class="hljs-keyword">return</span> res<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">raw_state</span>(<span class="hljs-params">self</span>):<br>        [s0, s1, s2, s3] = self.state<br>        <span class="hljs-keyword">return</span> (s0 &lt;&lt; <span class="hljs-number">192</span>) + (s1 &lt;&lt; <span class="hljs-number">128</span>) + (s2 &lt;&lt; <span class="hljs-number">64</span>) + s3<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next_state</span>(<span class="hljs-params">self</span>):<br>        self.<span class="hljs-built_in">next</span>()<br>        <span class="hljs-keyword">return</span> self.raw_state()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">n_to_bit_list</span>(<span class="hljs-params">n, nbits=<span class="hljs-number">256</span></span>):<br>    F = GF(<span class="hljs-number">2</span>)<br>    result = [<span class="hljs-literal">None</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits)]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits):<br>        result[i] = F((n &gt;&gt; (nbits - i - <span class="hljs-number">1</span>)) % <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">return</span> result<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">bit_list_to_n</span>(<span class="hljs-params">bl</span>):<br>    result = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> b <span class="hljs-keyword">in</span> bl:<br>        result *= <span class="hljs-number">2</span><br>        result += <span class="hljs-built_in">int</span>(b)<br>    <span class="hljs-keyword">return</span> result<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">transition_matrix</span>(<span class="hljs-params">engine, nbits=<span class="hljs-number">256</span></span>):<br>    state = engine.state<br>    columns = []<br>    <span class="hljs-comment"># calculate the standard matrix</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(nbits):<br>        seed = <span class="hljs-number">1</span> &lt;&lt; (nbits - i - <span class="hljs-number">1</span>)<br>        engine.raw_seed(seed)<br>        columns.append(n_to_bit_list(engine.next_state()))<br><br>    engine.state = state<br>    <span class="hljs-keyword">return</span> matrix(GF(<span class="hljs-number">2</span>), columns).transpose()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">jump</span>(<span class="hljs-params">engine, num_steps, mat=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> mat <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>        mat = transition_matrix(engine)<br><br>    state = engine.raw_state()<br>    v = vector(n_to_bit_list(state))<br>    v2 = mat^num_steps * v<br>    newstate = bit_list_to_n(v2)<br>    engine.raw_seed(newstate)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lua_nth_random</span>(<span class="hljs-params">e, n, mat=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-comment"># lua advances the state 16 times after setting the seed in math.randomseed</span><br>    jump(e, n + <span class="hljs-number">16</span>, mat)<br>    <span class="hljs-keyword">return</span> e.<span class="hljs-built_in">next</span>() &amp; (<span class="hljs-number">2</span>**<span class="hljs-number">32</span> - <span class="hljs-number">1</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">solve</span>():<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;chall.bmp&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        data = f.read()<br>    header = data[:<span class="hljs-number">0x8a</span>]<br>    enc = data[<span class="hljs-number">0x8a</span>:]<br>    dt = datetime.strptime(<span class="hljs-string">&#x27;31 Jan 2020, 20:38 +0000&#x27;</span>, <span class="hljs-string">&#x27;%d %b %Y, %H:%M %z&#x27;</span>)<br>    e = LuaXoshiro()<br>    mat = transition_matrix(e)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">60</span>):<br>        seed = <span class="hljs-built_in">int</span>(dt.timestamp() + i)<br>        e.seed(seed)<br>        key = <span class="hljs-built_in">str</span>(lua_nth_random(e, <span class="hljs-number">1_000_000_000_000_000</span>)).encode()<br>        cipher = ARC4.new(key, drop=<span class="hljs-number">3072</span>)<br>        dec = cipher.decrypt(enc)<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;decrypted/<span class="hljs-subst">&#123;i:02&#125;</span>.bmp&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(header + dec)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    solve()<br><br><span class="hljs-comment"># ictf&#123;xoshiro_jumps_in_lua_like_a_pro&#125;</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>Writeups</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2024 XYCTF éƒ¨åˆ†é¢˜è§£</title>
    <link href="/2024-XYCTF-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3.html"/>
    <url>/2024-XYCTF-%E9%83%A8%E5%88%86%E9%A2%98%E8%A7%A3.html</url>
    
    <content type="html"><![CDATA[<p>å’ŒåŒå­¦keyboard,furinaä¸€èµ·ç»„äº†ä¸ªxingæˆ˜é˜Ÿæ‰“äº†è¿™åœºXYCTF.è¯´æ˜¯æ–°ç”Ÿèµ›ä½†é¢˜ç›®ä¸ç®—å¾ˆå®¹æ˜“,æ‰€ä»¥å§‘ä¸”è®°å½•ä¸€ä¸‹.</p><p>æ ‡*çš„æ˜¯èµ›åå¤ç›˜çš„é¢˜ç›®.</p><h2 id="crypto-happy_to_solve1">Crypto-happy_to_solve1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> sympy<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_happy_prime</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = sympy.nextprime(p ^ ((<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>) - <span class="hljs-number">1</span>))<br>    <span class="hljs-keyword">return</span> p, q<br><br><br>m = bytes_to_long(flag)<br>p, q = get_happy_prime()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-comment"># 24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br><span class="hljs-comment"># 14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br></code></pre></td></tr></table></figure><p>ä»é¢˜ç›®æ¡ä»¶å¯ä»¥æ¨å‡º <span class="math inline">\(p+q=2^{512}+k\)</span>ï¼Œå…¶ä¸­kçš„å¤§å°ä¸ä¼šå¾ˆå¤§ã€‚å› æ­¤æ„é€ æ–¹ç¨‹ <spanclass="math inline">\(x^2-(2^{512}+k)x+n=0\)</span>ï¼Œåˆ©ç”¨è¯¥æ–¹ç¨‹æš´åŠ›æœç´¢p+qå³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span><br>c = <span class="hljs-number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span><br><br>P.&lt;x&gt; = ZZ[]<br><br>t = <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    f = x ^ <span class="hljs-number">2</span> - t * x + n<br>    rs = f.roots()<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(rs) &gt; <span class="hljs-number">0</span>:<br>        p = rs[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]<br>        q = n // p<br>        <span class="hljs-keyword">assert</span> p * q == n<br>        <span class="hljs-keyword">break</span><br>    t += <span class="hljs-number">1</span><br>d = inverse_mod(<span class="hljs-number">65537</span>, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))<br>m = power_mod(c, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m).decode())<br><span class="hljs-comment"># XYCTF&#123;3f22f4efe3bbbc71bbcc999a0a622a1a23303cdc&#125;</span><br></code></pre></td></tr></table></figure><h2 id="crypto-x0y">Crypto-x0y</h2><p>é¢˜ç›®å¦‚ä¸‹ <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> Crypto.Util.Padding <span class="hljs-keyword">import</span> pad<br><span class="hljs-keyword">import</span> os<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag.txt&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>).read()<br>key = os.urandom(<span class="hljs-number">16</span>)<br>iv = os.urandom(<span class="hljs-number">16</span>)<br>flag = pad(flag, <span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">aes_encrypt</span>(<span class="hljs-params">key, plaintext</span>):<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    <span class="hljs-keyword">return</span> cipher.encrypt(plaintext)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key, plaintext, iv</span>):<br>    ciphertext = <span class="hljs-string">b&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(plaintext), AES.block_size):<br>        key_block = aes_encrypt(key, iv)<br>        ciphertext_block = <span class="hljs-built_in">bytes</span>(<br>            [plaintext[i + j] ^ key_block[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(AES.block_size)]<br>        )<br>        ciphertext += ciphertext_block<br>        iv = key_block<br>    <span class="hljs-keyword">return</span> ciphertext<br><br><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1.print\n2.input\n3.exit&quot;</span>)<br>        a = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt; &quot;</span>)<br>        <span class="hljs-keyword">if</span> a == <span class="hljs-string">&quot;1&quot;</span>:<br>            <span class="hljs-built_in">print</span>((iv + encrypt(key, flag, iv)).<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">elif</span> a == <span class="hljs-string">&quot;2&quot;</span>:<br>            ivs = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;iv: &quot;</span>))<br>            inputs = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;message: &quot;</span>))<br>            <span class="hljs-built_in">print</span>(encrypt(key, inputs, ivs).<span class="hljs-built_in">hex</span>())<br>        <span class="hljs-keyword">elif</span> a == <span class="hljs-string">&quot;3&quot;</span>:<br>            exit(<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You need input 1,2,3&quot;</span>)<br>    <span class="hljs-keyword">except</span>:exit(<span class="hljs-number">0</span>)<br><span class="hljs-comment"># b8bade451e6cc96d6f1b1f3a9e0c76cddc21942c4adf94561b4003c7473df446caf7d88b8911ebde71c0716a67cba57460ffe68b84ccea0906dddfb19d9a7223</span><br></code></pre></td></tr></table></figure></p><p>å·²çŸ¥ivï¼Œä¸”keyæ˜¯é€‰å®šä¹‹åä¸€ç›´ä¸å˜çš„ï¼Œæ‰€ä»¥key_blockå…¶å®ä¹Ÿæ˜¯ä¸€ç›´ä¸å˜çš„ã€‚æ„é€ ä¸€ä¸ªä¸å¯†æ–‡ç­‰é•¿çš„'0'åºåˆ—è¾“å…¥å³å¯è·å–åˆ°key_blockçš„å€¼ï¼Œéšåä¸å¯†æ–‡xorå³å¾—ã€‚</p><p>exp: <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Python">cipher=[<span class="hljs-number">0xdc</span>,<span class="hljs-number">0x21</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x2c</span>,<span class="hljs-number">0x4a</span>,<span class="hljs-number">0xdf</span>,<span class="hljs-number">0x94</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0x1b</span>,<span class="hljs-number">0x40</span>,<span class="hljs-number">0x03</span>,<span class="hljs-number">0xc7</span>,<span class="hljs-number">0x47</span>,<span class="hljs-number">0x3d</span>,<span class="hljs-number">0xf4</span>,<span class="hljs-number">0x46</span>,<span class="hljs-number">0xca</span>,<span class="hljs-number">0xf7</span>,<span class="hljs-number">0xd8</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x89</span>,<span class="hljs-number">0x11</span>,<span class="hljs-number">0xeb</span>,<span class="hljs-number">0xde</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0xc0</span>,<span class="hljs-number">0x71</span>,<span class="hljs-number">0x6a</span>,<span class="hljs-number">0x67</span>,<span class="hljs-number">0xcb</span>,<span class="hljs-number">0xa5</span>,<span class="hljs-number">0x74</span>,<span class="hljs-number">0x60</span>,<span class="hljs-number">0xff</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0x8b</span>,<span class="hljs-number">0x84</span>,<span class="hljs-number">0xcc</span>,<span class="hljs-number">0xea</span>,<span class="hljs-number">0x09</span>,<span class="hljs-number">0x06</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0xdf</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0x9d</span>,<span class="hljs-number">0x9a</span>,<span class="hljs-number">0x72</span>,<span class="hljs-number">0x23</span>]<br>key=[<span class="hljs-number">0x84</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0xd7</span>,<span class="hljs-number">0x78</span>,<span class="hljs-number">0x0c</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0xf5</span>,<span class="hljs-number">0x6e</span>,<span class="hljs-number">0x7a</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x37</span>,<span class="hljs-number">0xa4</span>,<span class="hljs-number">0x24</span>,<span class="hljs-number">0x58</span>,<span class="hljs-number">0xd9</span>,<span class="hljs-number">0x7f</span>,<span class="hljs-number">0xab</span>,<span class="hljs-number">0xc4</span>,<span class="hljs-number">0xed</span>,<span class="hljs-number">0xa6</span>,<span class="hljs-number">0xbd</span>,<span class="hljs-number">0x20</span>,<span class="hljs-number">0xdd</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0x5c</span>,<span class="hljs-number">0xf9</span>,<span class="hljs-number">0x14</span>,<span class="hljs-number">0x5e</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xe6</span>,<span class="hljs-number">0x95</span>,<span class="hljs-number">0x43</span>,<span class="hljs-number">0x56</span>,<span class="hljs-number">0xca</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0xe9</span>,<span class="hljs-number">0xb1</span>,<span class="hljs-number">0xaa</span>,<span class="hljs-number">0x8e</span>,<span class="hljs-number">0x3e</span>,<span class="hljs-number">0x36</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0xa2</span>,<span class="hljs-number">0xbb</span>,<span class="hljs-number">0x99</span>,<span class="hljs-number">0x9e</span>,<span class="hljs-number">0x76</span>,<span class="hljs-number">0x27</span>]<br>plain=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(cipher)):<br>    plain+=<span class="hljs-built_in">chr</span>(cipher[i]^key[i])<br><span class="hljs-built_in">print</span>(plain)<br></code></pre></td></tr></table></figure></p><h2 id="crypto-babyrsamax">Crypto-babyRSAMAX</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> choice<br><br>flag = <span class="hljs-string">b&#x27;XYCTF&#123;******&#125;&#x27;</span><br>e = <span class="hljs-string">&#x27;?&#x27;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getBabyPrime</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = <span class="hljs-number">1</span><br>        <span class="hljs-keyword">while</span> p.bit_length() &lt;= nbits:<br>            p *= choice(sieve_base)<br>        <br>        <span class="hljs-keyword">if</span> isPrime(p+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">return</span> p+<span class="hljs-number">1</span><br><br>p = getBabyPrime(<span class="hljs-number">512</span>)<br>q = getBabyPrime(<span class="hljs-number">512</span>)<br>n = p*q<br>gift1 = (<span class="hljs-built_in">pow</span>(p,e,n)-<span class="hljs-built_in">pow</span>(q,e,n)) % n<br>gift2 = <span class="hljs-built_in">pow</span>(p+q,e,n)<br><br>t = <span class="hljs-number">65537</span><br>x = bytes_to_long(e)<br>y = <span class="hljs-built_in">pow</span>(x, t, n)<br><br>m = bytes_to_long(flag)<br>c = powmod(m, e, n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;n = <span class="hljs-subst">&#123;n&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;gift1 = <span class="hljs-subst">&#123;gift1&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;gift2 = <span class="hljs-subst">&#123;gift2&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;c = <span class="hljs-subst">&#123;c&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;y = <span class="hljs-subst">&#123;y&#125;</span>&#x27;</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span><br><span class="hljs-string">gift1 = 4549402444746338327349007235818187793950285105091726167573552412678416759694660166956782755631447271662108564084382098562999950228708300902201571583419116299932264478381197034402338481872937576172197202519770782458343606060544694608852844228400457232100904217062914047342663534138668490328400022651816597367310</span><br><span class="hljs-string">gift2 = 111061215998959709920736448050860427855012026815376672067601244053580566359594802604251992986382187891022583247997994146019970445247509119719411310760491983876636264003942870756402328634092146799825005835867245563420135253048223898334460067523975023732153230791136870324302259127159852763634051238811969161011462</span><br><span class="hljs-string">c = 16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br><span class="hljs-string">y = 1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure><p>gift1å’Œgift2ç›¸åŠ åä¸nè¿›è¡Œgcdå³å¯å¾—åˆ°pï¼Œç”±æ­¤åˆ†è§£å‡ºp,qï¼Œè¿åˆƒè€Œè§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">import</span> gmpy2<br><br>  <br><br>t = <span class="hljs-number">65537</span><br><br>n = <span class="hljs-number">39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span><br><br>gift1 = <span class="hljs-number">4549402444746338327349007235818187793950285105091726167573552412678416759694660166956782755631447271662108564084382098562999950228708300902201571583419116299932264478381197034402338481872937576172197202519770782458343606060544694608852844228400457232100904217062914047342663534138668490328400022651816597367310</span><br><br>gift2 = <span class="hljs-number">111061215998959709920736448050860427855012026815376672067601244053580566359594802604251992986382187891022583247997994146019970445247509119719411310760491983876636264003942870756402328634092146799825005835867245563420135253048223898334460067523975023732153230791136870324302259127159852763634051238811969161011462</span><br><br>c = <span class="hljs-number">16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br><br>y = <span class="hljs-number">1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217</span><br><br>gift3 = gift1+gift2<br>p = gcd(gift3,n)<br>q = n//p<br>phi = (p - <span class="hljs-number">1</span>)*(q - <span class="hljs-number">1</span>)<br><br>  <br><br><span class="hljs-comment">#è§£e</span><br><br>d1 = gmpy2.invert(t,phi)<br>e=<span class="hljs-built_in">pow</span>(y,d1,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(e)) <span class="hljs-comment">#å› ä¸ºé€†å¤©çš„å‡ºé¢˜äººæŠŠeå¥—äº†ä¸€å±‚bytesæ‰€ä»¥è½¬ä¸€ä¸‹</span><br><br><span class="hljs-comment"># XYCTF&#123;e==4096&#125;</span><br><br><span class="hljs-comment"># eå’Œphinä¸äº’ç´ ï¼ŒCRTå¯åŠ¨ï¼</span><br><br>  <br><br><span class="hljs-string">&#x27;&#x27;&#x27;Sage</span><br><span class="hljs-string"></span><br><span class="hljs-string">c = 16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span><br><span class="hljs-string"></span><br><span class="hljs-string">p=166353789373057352195268575168397750362643822201253508941052835945420624983216456266478176579651490080696973849607356408696043718492499993062863415424578199</span><br><span class="hljs-string"></span><br><span class="hljs-string">q=236438400477521597922950445153796265199072404577183190953114805170522875904551780358338769440558816351105253794964040981919231484098097671084895302287425479</span><br><span class="hljs-string"></span><br><span class="hljs-string">e = 4096</span><br><span class="hljs-string"></span><br><span class="hljs-string">  </span><br><span class="hljs-string"></span><br><span class="hljs-string">for mp in GF(p)(c).nth_root(e, all=True):</span><br><span class="hljs-string">    for mq in GF(q)(c).nth_root(e, all=True):</span><br><span class="hljs-string">        m = crt([ZZ(mp), ZZ(mq)], [p, q])</span><br><span class="hljs-string">        try:</span><br><span class="hljs-string">            res = bytes.fromhex(hex(m)[2:])</span><br><span class="hljs-string">            if res.isascii():</span><br><span class="hljs-string">                print(res)</span><br><span class="hljs-string">        except:</span><br><span class="hljs-string">            pass</span><br><span class="hljs-string"></span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><br><span class="hljs-comment"># b&#x27;XYCTF&#123;Rabin_is_so_biggggg!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="crypto-factor1">Crypto-factor1</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> gmpy2<br><br><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>d = getPrime(<span class="hljs-number">512</span>)<br>e = gmpy2.invert(d, (p**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>) * (q**<span class="hljs-number">3</span> - <span class="hljs-number">1</span>))<br>flag = <span class="hljs-string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(<span class="hljs-built_in">str</span>(p + q).encode()).hexdigest() + <span class="hljs-string">&quot;&#125;&quot;</span><br><span class="hljs-built_in">print</span>(e)<br><span class="hljs-built_in">print</span>(p * q)<br><span class="hljs-comment"># 172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br><br><span class="hljs-comment"># 99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br></code></pre></td></tr></table></figure><p>eè¿‡å¤§ï¼Œä¸€çœ¼Wiener Attackã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ä»é¢˜ç›®ä¸­çš„æ¡ä»¶å¯ä»¥æ¨çŸ¥<span class="math inline">\(ed\equiv 1 \bmod(\phi(N))\)</span>ï¼Œä½†æ˜¯å› ä¸ºdçš„èŒƒå›´ï¼Œä½¿ç”¨ <span class="math inline">\(N\)</span>å»æ”»å‡»å¹¶ä¸èƒ½æˆåŠŸï¼Œè€Œæ˜¯è¦æ ¹æ®é¢˜ç›®ä¸­çš„å½¢å¼éœ€è¦ä½¿ç”¨ <spanclass="math inline">\(N^3\)</span> ï¼Œä½¿å¾—dè½åœ¨å¯æ”»å‡»èŒƒå›´ä¹‹å†…ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">factor_rsa_wiener</span>(<span class="hljs-params">N, e</span>):<br>    N = Integer(N)<br>    e = Integer(e)<br>    cf = (e / N).continued_fraction().convergents()<br>    <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> cf:<br>        k = f.numer()<br>        d = f.denom()<br>        <span class="hljs-keyword">if</span> k == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">continue</span><br>        phi_N = ((e * d) - <span class="hljs-number">1</span>) / k<br>        b = -(N - phi_N + <span class="hljs-number">1</span>)<br>        dis = b ^ <span class="hljs-number">2</span> - <span class="hljs-number">4</span> * N<br>        <span class="hljs-keyword">if</span> dis.sign() == <span class="hljs-number">1</span>:<br>            dis_sqrt = sqrt(dis)<br>            p = (-b + dis_sqrt) / <span class="hljs-number">2</span><br>            q = (-b - dis_sqrt) / <span class="hljs-number">2</span><br>            <span class="hljs-keyword">if</span> p.is_integer() <span class="hljs-keyword">and</span> q.is_integer() <span class="hljs-keyword">and</span> (p * q) % N == <span class="hljs-number">0</span>:<br>                p = p % N<br>                q = q % N<br>                <span class="hljs-keyword">if</span> p &gt; q:<br>                    <span class="hljs-keyword">return</span> (p, q)<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-keyword">return</span> (q, p)<br>e=<span class="hljs-number">172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span><br>n=<span class="hljs-number">99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span><br><span class="hljs-built_in">print</span>(factor_rsa_wiener(n**<span class="hljs-number">3</span>,e))    <br><span class="hljs-comment"># p**3 = 1244017062789857764422667689197770411561706061389715742852841131131435478039738844788314076541516819766126607314172841730975726749473298781835130842627454629568985724966925735905579282826322467200321805458818184179125514763621834851652092846169460275768772863952106838841006859603856275880383937805904493971997262155516186649395940112478889012377196708598220178020268381188803264308066063878770942584129304104857476445838035070537472243418121420612877337721035139</span><br><span class="hljs-comment"># q**3 = 781750817102250814081402150839349648838094352331200646064329593739249658509293014822407869754909590964961253627998562104967609046600602463761387625281775226114093766468854130062539304801906723482222402079346881907551622221610829587775870117982981382377420719340275829723435212262439715988059683115133464900926751096727854874698447640032293397116617936988359535830766353635342613807991926780460233344065075367609934736815239097217192394502104370100558611689435563</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œè§£å‡ºçš„æ˜¯ <span class="math inline">\(p^{3}, q^{3}\)</span>ï¼Œå¼€æ ¹åå³å¾—p,qã€‚</p><h2 id="crypto-åæ–¹å‘çš„å¯†ç -ç›¸æ€">Crypto-åæ–¹å‘çš„å¯†ç  ç›¸æ€</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br><span class="hljs-keyword">return</span> hashlib.sha256(x.encode()).digest()<br><br>  <br>  <br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">message</span>):<br><span class="hljs-keyword">return</span> message + <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(message)))<br><br><br>m = bytes_to_long(pad(flag))<br>p = getStrongPrime(<span class="hljs-number">512</span>)<br>q = getStrongPrime(<span class="hljs-number">512</span>)<br>n = p * q<br>e = <span class="hljs-number">3</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-built_in">print</span>(n)<br><br><span class="hljs-comment"># 120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br><br><span class="hljs-comment"># 143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°é¢˜ç›®åå¯ä»¥å‘ç°paddingæ˜¯å¾ˆå®¹æ˜“çˆ†ç ´çš„,å› æ­¤ç›¸å½“äºmçš„ä½ä½å·²çŸ¥ï¼Œè€ƒè™‘ä½¿ç”¨ä¸€å…ƒCopperSmithæ”»å‡»å¦‚ä¸‹ç­‰å¼:<span class="math display">\[(low_m+x)^{3}-c\equiv{0}\bmod {n}\]</span>æˆ‘ä»¬è¦æ±‚xçš„ä½256bitséƒ½æ˜¯0ï¼Œå› æ­¤å®é™…ä¸Šå¯ä»¥åŒ–å½’ä¸º</p><p><spanclass="math display">\[(low_m+x&lt;&lt;256)^{3}-c\equiv{0}\bmod{n}\]</span></p><p>ç„¶åä½¿ç”¨monicæ–¹æ³•åŒ–ä¸ºé¦–ä¸€å¤šé¡¹å¼ï¼Œå³å¯å¥—ç”¨CopperSmithæ”»å‡»å¹¶ç¼©å°xçš„æ”»å‡»èŒƒå›´ã€‚</p><p>äº‹å®ä¸Šé¢˜ç›®ä¸­è¿˜ç»™å‡ºäº†flagçš„é«˜ä½<code>XYCTF&#123;</code>ï¼Œå› æ­¤æ„é€ æœ€ç»ˆexpå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Copper</span>(<span class="hljs-params">low_m, n, c, LEN</span>):<br>R.&lt;x&gt; = PolynomialRing(Zmod(n), implementation=<span class="hljs-string">&#x27;NTL&#x27;</span>)<br>f = (x*<span class="hljs-number">2</span>^<span class="hljs-number">256</span> + low_m + <span class="hljs-number">97140404930171</span>*<span class="hljs-number">2</span>^(<span class="hljs-number">256</span>+<span class="hljs-number">8</span>*(LEN-<span class="hljs-number">6</span>)))^<span class="hljs-number">3</span> - c<br>f = f.monic()<br>root = f.small_roots(X=<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(LEN-<span class="hljs-number">6</span>)),beta=<span class="hljs-number">0.5</span>,epsilon=<span class="hljs-number">0.015</span>)<br><span class="hljs-keyword">if</span>(root):<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;root =&#x27;</span>,long_to_bytes(<span class="hljs-built_in">int</span>(root[<span class="hljs-number">0</span>])))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br><span class="hljs-keyword">return</span> bytes_to_long(hashlib.sha256(x.encode()).digest())<br><br>  <br><br>n = <span class="hljs-number">143413213355903851638663645270518081058249439863120739973910994223793329606595495141951165221740599158773181585002460087410975579141155680671886930801733174300593785562287068287654547100320094291092508723488470015821072834947151827362715749438612812148855627557719115676595686347541785037035334177162406305243</span><br><br>c = <span class="hljs-number">120440199294949712392334113337541924034371176306546446428347114627162894108760435789068328282135879182130546564535108930827440004987170619301799710272329673259390065147556073101312748104743572369383346039000998822862286001416166288971531241789864076857299162050026949096919395896174243383291126202796610039053</span><br><br><span class="hljs-keyword">for</span> LEN <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>,<span class="hljs-number">40</span>):<br>low_m = <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(LEN))<br>Copper(low_m, n, c, LEN)<br><span class="hljs-comment"># root = b&#x27;!__d3ng__hu0__1@n__3h@n__Chu__!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><p>ï¼ˆæ¯”èµ›ä¸­è¿™ä¸€é¢˜è¸©äº†ç›¸å½“ä¸¥é‡çš„å‘...Sagemathçš„small_rootsæ–¹æ³•é»˜è®¤æƒ…å†µä¸‹<span class="math inline">\(\varepsilon=\frac{\beta}{8}\)</span>ï¼Œå¦‚æœä¸è°ƒå°çš„è¯æ˜¯æ— æ³•æ”»å‡»æˆåŠŸçš„ğŸ˜“GPTç»™å‡ºçš„å»ºè®®åè€Œæ˜¯è°ƒå¤§ <spanclass="math inline">\(\varepsilon\)</span>å¯¼è‡´ç™½ç™½æµªè´¹äº†ä¸¤å¤©çš„æ—¶é—´ï¼Œæ‰€ä»¥åªèƒ½è¯´æœ‰ç–‘é—®è¿˜æ˜¯å¾—çœ‹æ–‡æ¡£ï¼‰</p><h2 id="crypto-happy_to_solve2">Crypto-happy_to_solve2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_happy_prime</span>():<br>    <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>        p = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([random.choice(<span class="hljs-string">&quot;123&quot;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        q = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;&quot;</span>.join([random.choice(<span class="hljs-string">&quot;567&quot;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">512</span>)]))<br>        <span class="hljs-keyword">if</span> isPrime(p) <span class="hljs-keyword">and</span> isPrime(q):<br>            <span class="hljs-keyword">return</span> (p,q)<br><br>m = bytes_to_long(flag)<br>p ,q= get_happy_prime()<br>n = p * q<br>e = <span class="hljs-number">65537</span><br><span class="hljs-built_in">print</span>(n)<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">pow</span>(m, e, n))<br><span class="hljs-comment"># 697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span><br><span class="hljs-comment"># 153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span><br><br></code></pre></td></tr></table></figure><p>é¢˜ç›®åŸå‹æ˜¯osu!gaming CTF2024çš„wysi-primeã€‚p,qçš„åè¿›åˆ¶æ•°ä½åˆ†åˆ«åªèƒ½æ˜¯<code>1,2,3</code>å’Œ<code>5,6,7</code>ï¼Œç›´æ¥æ„é€ pï¼Œqådfså³å¯ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> itertools <span class="hljs-keyword">import</span> product<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><br>n = <span class="hljs-number">697906506747097082736076931509594586899561519277373830451275402914416296858960649459482027106166486723487162428522597262774248272216088755005277069446993003521270487750989061229071167729138628583207229945902389632065500739730301375338674342457656803764567184544685006193130563116558641331897204457729877920989968662546183628637193220770495938729301979912328865798266631957128761871326655572836258178871966196973138373358029531478246243442559418904559585334351259080578222274926069834941166567112522869638854253933559832822899069320370733424453856240903784235604251466010104012061821038897933884352804297256364409157501116832788696434711523621632436970698827611375698724661553712549209133526623456888111161142213830821361143023186927163314212097199831985368310770663850851571934739809387798422381702174820982531508641022827776262236373967579266271031713520262606203067411268482553539580686495739014567368858613520107678565628269250835478345171330669316220473129104495659093134763261751546990704365966783697780787341963138501</span><br>e = <span class="hljs-number">65537</span><br>ciphertext = <span class="hljs-number">153383826085102296581238539677668696644156148059026868813759015106139131297135097831661048493079405226972222492151356105759235749502324303047037349410709021152255315429280760639113724345836532087970918453353723090554450581657930847674930226113840172368662838756446364482977092478979838209396761279326533419699056209983721842484996150025403009644653678928025861445324715419893797015875541525590135843027312322236085581571452084477262582966972702577136904385741443870527205640874446616413917231260133364227248928492574610248881137364204914001412269740461851747883355414968499272944590071623223603501698004227753335552646715567802825755799597955409228004284739743749531270833084850113574712041224896044525292591264637452797151098802604186311724597450780520140413704697374209653369969451501627583467893160412780732575085846467289134920886789952338174193202234175299652687560232593212131693456966318670843605238958724126368185289703563591477049105538528244632434869965333722691837462591128379816582723367039674028619947057144546</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">base10</span>(<span class="hljs-params">ss</span>):<br>    r = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> ss[::-<span class="hljs-number">1</span>]:<br>        r = r * <span class="hljs-number">10</span> + x<br>    <span class="hljs-keyword">return</span> r<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">dfs</span>(<span class="hljs-params">ps, qs, mod</span>):<br>    <span class="hljs-keyword">if</span> base10(ps) * base10(qs) == n:<br>        <span class="hljs-keyword">yield</span> base10(ps), base10(qs)<br>        <span class="hljs-keyword">return</span><br>    <span class="hljs-keyword">for</span> pp, qq <span class="hljs-keyword">in</span> product((<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>), (<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>)):<br>        p = base10(ps + [pp])<br>        q = base10(qs + [qq])<br>        <span class="hljs-keyword">if</span> p * q % mod == n % mod:<br>            <span class="hljs-keyword">yield</span> <span class="hljs-keyword">from</span> dfs(ps + [pp], qs + [qq], mod * <span class="hljs-number">10</span>)<br><br>p, q = <span class="hljs-built_in">next</span>(dfs([], [], <span class="hljs-number">1</span>))<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br>d = <span class="hljs-built_in">pow</span>(e, -<span class="hljs-number">1</span>, phi)<br>m = <span class="hljs-built_in">pow</span>(ciphertext, d, n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><span class="hljs-comment"># XYCTF&#123;7f4b2241951976ce5ef6df44503209059997e5085d1bc21f6bef4d9effb29fd0&#125;</span><br></code></pre></td></tr></table></figure><h2 id="crypto-factor3">Crypto-factor3</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><br>flag = <span class="hljs-string">b&#x27;XYCTF&#123;*****&#125;&#x27;</span><br>m = bytes_to_long(flag)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gainPrime</span>():<br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>x = random.getrandbits(<span class="hljs-number">256</span>)<br>y = random.getrandbits(<span class="hljs-number">256</span>)<br><span class="hljs-keyword">if</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>:<br><span class="hljs-keyword">continue</span><br>p = x ** <span class="hljs-number">3</span> + <span class="hljs-number">3</span> * y ** <span class="hljs-number">3</span><br><span class="hljs-keyword">if</span> p.bit_length() == <span class="hljs-number">768</span> <span class="hljs-keyword">and</span> p % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> isPrime(p):<br><span class="hljs-keyword">return</span> p<br><br>p, q = gainPrime(), gainPrime()<br>N = p * q<br>phi = (p ** <span class="hljs-number">2</span> + p + <span class="hljs-number">1</span>) * (q ** <span class="hljs-number">2</span> + q + <span class="hljs-number">1</span>)<br>d = getPrime(<span class="hljs-number">320</span>)<br>e = inverse(d, phi)<br>c = d**<span class="hljs-number">2</span>^m<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;N: <span class="hljs-subst">&#123;N&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;e: <span class="hljs-subst">&#123;e&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c: <span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><br>  <br><br>N: <span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br><br>e: <span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br><br>c: <span class="hljs-number">4450931337369461482106945992542133557585962894030505065110870389112565329875502952762182372926117037373210509516570958483606566274369840551132381128665744266165792377925899683228751870742727716</span><br></code></pre></td></tr></table></figure><p>ä¾ç„¶æ˜¯eå¾ˆå¤§ï¼Œè€ƒè™‘ä½¿ç”¨WienerAttackâ€”â€”å› ä¸ºå‹’è®©å¾·å®šç†ï¼Œæˆ‘ä»¬çŸ¥é“åªè¦ä¿è¯å¯¹äº <spanclass="math inline">\(\phi(N)\)</span>çš„è¿‘ä¼¼è¶³å¤Ÿç²¾ç¡®ï¼Œè¿åˆ†æ•°å°±å¯ä»¥è¦†ç›–åˆ° <spanclass="math inline">\(\frac{k}{d}\)</span> ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å‚ç…§ä»£ç ä¸­<span class="math inline">\(\phi(N)\)</span> çš„ç»“æ„ï¼Œæ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><br>e=<span class="hljs-number">494518390582436635999115147756676313570637682518235195828939117782099618734167908630788943568232122157772909140885391963441876427590731524706959546524212914108888799081844320513851526790475333924396837458796755678072486028072639014677580265244176441153444956871730684233063789931539669072735599696830757690822185323538738397827461580678488181113667710378657058297572328491762536595872579603698945272140918157163640403488075948987156585480146162739943419183496337465468187233821931312507662218106713861638334075899266373256620752680354704533272722692596941861606161634082613228896420520465402725359166156632884432690715903666803067996854084671477445131853993177110154928274312496230096270510089973592664248613332000290545537840595645944390047611474888693558676781309912289044962293014118087259307560444929227407113819165713213046898243995956550944640168932947118400215917515277554126694376415569909534496134700668701465649939</span><br>n=<span class="hljs-number">913125842482770239379848062277162627509794409924607555622246822717218133091223291889541294440266178282194506242444509803611492259403578922020590849630191477864719052980160940803309686069818208833547621252544423652489179493083138385424424384165228024273745733240109761707533778691158938848158094054261174692601673435971526522219273943464877956131040249169850420336023942653021547841666224446678539579529590840999008107782784268926145671962239929431694391039559247</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">ContinuedFraction</span>():<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, numerator, denumerator</span>):<br>        self.numberlist = []  <span class="hljs-comment"># number in continued fraction</span><br>        self.fractionlist = []  <span class="hljs-comment"># the near fraction list</span><br>        self.GenerateNumberList(numerator, denumerator)<br>        self.GenerateFractionList()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateNumberList</span>(<span class="hljs-params">self, numerator, denumerator</span>):<br>        <span class="hljs-keyword">while</span> numerator != <span class="hljs-number">1</span>:<br>            quotient = numerator // denumerator<br>            remainder = numerator % denumerator<br>            self.numberlist.append(quotient)<br>            numerator = denumerator<br>            denumerator = remainder<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">GenerateFractionList</span>(<span class="hljs-params">self</span>):<br>        self.fractionlist.append([self.numberlist[<span class="hljs-number">0</span>], <span class="hljs-number">1</span>])<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(self.numberlist)):<br>            numerator = self.numberlist[i]<br>            denumerator = <span class="hljs-number">1</span><br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(i):<br>                temp = numerator<br>                numerator = denumerator + numerator * self.numberlist[i - j - <span class="hljs-number">1</span>]<br>                denumerator = temp<br>            self.fractionlist.append([numerator, denumerator])<br><br>a = ContinuedFraction(e, n**<span class="hljs-number">2</span>+<span class="hljs-number">2</span>*n*iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]+n+iroot(n,<span class="hljs-number">2</span>)[<span class="hljs-number">0</span>]+<span class="hljs-number">1</span>)<br><span class="hljs-keyword">for</span> k, d <span class="hljs-keyword">in</span> a.fractionlist:<br>    <span class="hljs-keyword">if</span>(isPrime(d) <span class="hljs-keyword">and</span> d.bit_length()==<span class="hljs-number">320</span>):<br>        <span class="hljs-built_in">print</span>(d)<br><br><span class="hljs-comment"># d = 2109723047551375043305134722302342646596769444055829710618826161103186815230448177424794300667429</span><br></code></pre></td></tr></table></figure><h2 id="crypto-complex_dlp">Crypto-Complex_dlp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Complex</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, re, im</span>):<br>        self.re = re<br>        self.im = im<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__mul__</span>(<span class="hljs-params">self, c</span>):<br>        re_ = self.re * c.re - self.im * c.im<br>        im_ = self.re * c.im + self.im * c.re<br>        <span class="hljs-keyword">return</span> Complex(re_, im_)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__str__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> self.im == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(self.re)<br>        <span class="hljs-keyword">elif</span> self.re == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">abs</span>(self.im) == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;<span class="hljs-string">&#x27;-&#x27;</span> <span class="hljs-keyword">if</span> self.im &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;&#x27;</span>&#125;</span>i&quot;</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.im&#125;</span>i&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">f&quot;<span class="hljs-subst">&#123;self.re&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-string">&#x27;+&#x27;</span> <span class="hljs-keyword">if</span> self.im &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;-&#x27;</span>&#125;</span> <span class="hljs-subst">&#123;<span class="hljs-built_in">abs</span>(self.im)&#125;</span>i&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">complex_pow</span>(<span class="hljs-params">c, exp, n</span>):<br>    result = Complex(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">while</span> exp &gt; <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">if</span> exp &amp; <span class="hljs-number">1</span>:<br>            result = result * c<br>            result.re = result.re % n<br>            result.im = result.im % n<br>        c = c * c<br>        c.re = c.re % n<br>        c.im = c.im % n<br>        exp &gt;&gt;= <span class="hljs-number">1</span><br>    <span class="hljs-keyword">return</span> result<br><br>flag = flag.strip(<span class="hljs-string">b&quot;XYCTF&#123;&quot;</span>).strip(<span class="hljs-string">b&quot;&#125;&quot;</span>)<br>p = <span class="hljs-number">1127236854942215744482170859284245684922507818478439319428888584898927520579579027</span><br>g = Complex(<span class="hljs-number">3</span>, <span class="hljs-number">7</span>)<br>x = bytes_to_long(flag)<br><span class="hljs-built_in">print</span>(complex_pow(g, x, p))<br><span class="hljs-comment"># 5699996596230726507553778181714315375600519769517892864468100565238657988087817 + 198037503897625840198829901785272602849546728822078622977599179234202360717671908i</span><br></code></pre></td></tr></table></figure><p>å¤æ•°åŸŸä¸Šçš„DLPã€‚çœ‹åˆ°é¢˜ç›®æˆ‘çš„ç¬¬ä¸€ååº”æ˜¯æŠŠå¤æ•°çœ‹ä½œäºŒç»´çŸ©é˜µï¼Œè¿™æ ·å°±å¯ä»¥è½¬åŒ–åˆ°å®æ•°åŸŸä¸Šçš„çŸ©é˜µDLPï¼Œç„¶åå°†çŸ©é˜µå˜æ¢ä¸ºJordanæ ‡å‡†å‹å°±å¯ä»¥æ„‰å¿«åœ°ä¸€ç»´DLPäº†â€”â€”ä½†æ˜¯å®æ“åå‘ç°é¢˜ç›®çš„å¤æ•°å¯¹åº”çš„çŸ©é˜µç‰¹å¾å€¼æœ‰0ï¼Œå¯¼è‡´Jordanæ ‡å‡†å‹å¹¶ä¸å®¹æ˜“æ±‚å¾—ã€‚å…¶å®åœ¨é¢˜ç›®è¦æ±‚çš„ç¦»æ•£å¯¹æ•°çš„åŒä½™æ¨¡ç­‰å¼ä¸¤è¾¹å–æ¨¡é•¿å°±å¯ä»¥å¾ˆè½»æ¾åœ°å¤„ç†ä¸ºå®æ•°åŸŸä¸Šçš„DLPï¼Œä½†æ˜¯æˆ‘ä¸€æ—¶æ²¡æƒ³åˆ°æ¨¡Nçš„å®Œå…¨å‰©ä½™ç³»å¯¹åŠ æ³•å’Œä¹˜æ³•å°é—­ï¼Œåè€Œä¸€ç›´åœ¨è€ƒè™‘å¦‚ä½•åœ¨æ‰©åŸŸä¸Šç»§ç»­å°è¯•æ±‚è§£Jordanæ ‡å‡†å‹ã€‚ç›´åˆ°æˆ‘å¼€å§‹è€ƒè™‘å¦ä¸€é“Complex_RSAçš„æ—¶å€™æˆ‘æ‰æƒ³åˆ°å–æ¨¡é•¿çš„æ–¹æ³•â€”â€”æƒ³åˆ°è¿™é‡Œå°±è¿åˆƒè€Œè§£,è€Œæ­¤æ—¶è·ç¦»æˆ‘ç¬¬ä¸€æ¬¡å°è¯•æœ¬é¢˜å·²ç»è¿‡å»3å¤©äº†ã€‚expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>g = <span class="hljs-number">3</span>^<span class="hljs-number">2</span>+<span class="hljs-number">7</span>^<span class="hljs-number">2</span><br>c = <span class="hljs-number">5699996596230726507553778181714315375600519769517892864468100565238657988087817</span>^<span class="hljs-number">2</span> + <span class="hljs-number">198037503897625840198829901785272602849546728822078622977599179234202360717671908</span>^<span class="hljs-number">2</span><br>p = <span class="hljs-number">1127236854942215744482170859284245684922507818478439319428888584898927520579579027</span><br><span class="hljs-built_in">print</span>(long_to_bytes(discrete_log(mod(c,p),mod(g,p))))<br><span class="hljs-comment"># b&#x27;___c0mp13x_d1p_15_3@5y_f0r_y0u___&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="crypto-lcg_and_hnp">Crypto-LCG_and_HNP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> secrets <span class="hljs-keyword">import</span> flag<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">LCG</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, seed, a, b, p</span>):<br>        self.seed = seed<br>        self.a = a<br>        self.b = b<br>        self.p = p<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">next</span>(<span class="hljs-params">self</span>):<br>        self.seed = (self.seed * self.a + self.b) % self.p<br>        <span class="hljs-keyword">return</span> self.seed &gt;&gt; (self.p.bit_length() - <span class="hljs-number">8</span>)<br><br><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">128</span>)<br>a = random.randint(<span class="hljs-number">1</span>, p)<br>b = random.randint(<span class="hljs-number">1</span>, p)<br>seed = random.randint(<span class="hljs-number">1</span>, p)<br>out = []<br>lcg = LCG(seed, a, b, p)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    out.append(lcg.<span class="hljs-built_in">next</span>())<br>key = <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>    key += <span class="hljs-built_in">str</span>(lcg.<span class="hljs-built_in">next</span>())<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(key) &gt;= m:<br>        <span class="hljs-keyword">break</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;out.txt&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    f.write(<span class="hljs-string">f&quot;p=<span class="hljs-subst">&#123;p&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;a=<span class="hljs-subst">&#123;a&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;b=<span class="hljs-subst">&#123;b&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;out=<span class="hljs-subst">&#123;out&#125;</span>\n&quot;</span>)<br>    f.write(<span class="hljs-string">f&quot;c=<span class="hljs-subst">&#123;<span class="hljs-built_in">int</span>(key)^m&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>æ³„éœ²äº†30è½®çš„seedçš„é«˜ä½ã€‚æ³„éœ²çš„é«˜ä½éå¸¸å°‘ï¼Œç›´è§‰å‘Šè¯‰æˆ‘æ˜¯ç”¨ä¸äº†CopperSmithçš„ï¼Œé‚ç ”ç©¶äº†ä¸‹æ ¼æ”»å‡»ã€‚ç½—åˆ—ä¸€ä¸‹æˆ‘ä»¬çŸ¥é“çš„ä¿¡æ¯ã€‚è®°æ¯ä¸€è½®ä¸­å·²çŸ¥çš„é«˜ä½ä¸º <spanclass="math inline">\(h_i\)</span> ï¼ŒæœªçŸ¥çš„ä½ä½ä¸º <spanclass="math inline">\(l_i\)</span> ï¼Œæˆ‘ä»¬æœ‰ <spanclass="math display">\[(h_i+l_i)\equiv (a*(h_{i-1}+l_{i-1})+b)\bmodp\]</span> ç„¶åé€’æ¨ä¸€ä¸‹ï¼š <span class="math display">\[\begin{aligned}&amp; \left(h_2+l_2\right) \equiv a *\left(h_1+l_1\right)+b(\bmod m) \\&amp; l_2 \equiv a * l_1+a * h_1+b-h_2(\bmod m) \\ &amp; l_2 \equiv A_1* l_1+B_1(\bmod m) \text { ã€è®¾ } A_1=a ; B_1=a * h_1+b-h_2 \text { ã€‘ }\\ &amp; l_3 \equiv a * l_2+a * h_2+b-h_3(\bmod m) \\ &amp; l_3 \equiv a* A_1 * l_1+a * B_1+a * h_2+b-h_3(\bmod m) \\ &amp; l_3 \equiv A_2 *l_1+B_2(\bmod m) \text { ã€è®¾ } A_2=a * A_1 ; B_2=a * B_1+a * h_2+b-h_3\text { ã€‘ }\end{aligned}\]</span> æƒ³æ¢å¤seedå¯ä»¥å…ˆè€ƒè™‘æ¢å¤ <spanclass="math inline">\(l_1\)</span> ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªçº¿æ€§ç»„åˆåèƒ½ç»„åˆå‡º<span class="math inline">\(l_1\)</span> çš„æ ¼åŸºã€‚ é‚£ä¹ˆæ„é€ æ ¼Må¦‚ä¸‹ <spanclass="math display">\[M=\left[\begin{array}{cccccc}m &amp; &amp; &amp;&amp; &amp; \\ &amp; m &amp; &amp; &amp; &amp; \\ &amp; &amp; \ddots&amp; &amp; &amp; \\ &amp; &amp; &amp; m &amp; &amp; \\ A_1 &amp; A_2&amp; \ldots &amp; A_{29} &amp; 1 &amp; \\ B_1 &amp; B_2 &amp; \ldots&amp; B_{29} &amp; 0 &amp; 2^{128}\end{array}\right]\]</span>å¯¹Mè¿›è¡ŒLLLæ”»å‡»ï¼Œå°±æœ‰å¯èƒ½è¦†ç›–åˆ°ä¸€ä¸ªå½¢å¦‚ <spanclass="math inline">\([l_2,l_3,\dots,l_30,l_1,2^{128}]\)</span>çš„å‘é‡vï¼ˆå®¹æ˜“çœ‹å‡ºvåœ¨Mçš„è¡Œå‘é‡æ„æˆçš„æ ¼å†…ä¸”vçš„é•¿åº¦å¹¶ä¸å¾ˆå¤§ï¼‰</p><p>å–å¾— <span class="math inline">\(l_1\)</span>ä¹‹åå°±å¯ä»¥æ¢å¤seedï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python">p=<span class="hljs-number">183640370379099520304414468793633666661</span><br>a=<span class="hljs-number">36108041497607074474855679331694767924</span><br>b=<span class="hljs-number">65925932211985158779695144876342622462</span><br><br>h = [<span class="hljs-number">0</span>, <span class="hljs-number">34</span>, <span class="hljs-number">95</span>, <span class="hljs-number">100</span>, <span class="hljs-number">114</span>, <span class="hljs-number">16</span>, <span class="hljs-number">23</span>, <span class="hljs-number">17</span>, <span class="hljs-number">118</span>, <span class="hljs-number">115</span>, <span class="hljs-number">29</span>, <span class="hljs-number">73</span>, <span class="hljs-number">47</span>, <span class="hljs-number">12</span>, <span class="hljs-number">133</span>, <span class="hljs-number">78</span>, <span class="hljs-number">30</span>, <span class="hljs-number">30</span>, <span class="hljs-number">73</span>, <span class="hljs-number">87</span>, <span class="hljs-number">15</span>, <span class="hljs-number">85</span>, <span class="hljs-number">47</span>, <span class="hljs-number">20</span>, <span class="hljs-number">136</span>, <span class="hljs-number">6</span>, <span class="hljs-number">106</span>, <span class="hljs-number">74</span>, <span class="hljs-number">27</span>, <span class="hljs-number">116</span>, <span class="hljs-number">8</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(h)):<br>    h[i] &lt;&lt;= <span class="hljs-number">120</span><br>A = [<span class="hljs-number">1</span>]<br>B = [<span class="hljs-number">0</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-built_in">len</span>(h)-<span class="hljs-number">1</span>):<br>    A.append(a*A[i-<span class="hljs-number">1</span>] % p)<br>    B.append((a*B[i-<span class="hljs-number">1</span>]+a*h[i]+b-h[i+<span class="hljs-number">1</span>]) % p)<br>A = A[<span class="hljs-number">1</span>:]<br>B = B[<span class="hljs-number">1</span>:]<br><br><br>M = matrix(ZZ, <span class="hljs-number">31</span>, <span class="hljs-number">31</span>)<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">29</span>):<br>    M[i, i] = p<br>    M[<span class="hljs-number">29</span>, i] = A[i]<br>    M[<span class="hljs-number">30</span>, i] = B[i]<br>    M[i, <span class="hljs-number">29</span>] = M[i, <span class="hljs-number">30</span>] = <span class="hljs-number">0</span><br>M[<span class="hljs-number">29</span>, <span class="hljs-number">29</span>] =  <span class="hljs-number">1</span><br>M[<span class="hljs-number">30</span>, <span class="hljs-number">30</span>] = <span class="hljs-number">2</span>^<span class="hljs-number">128</span><br>M[<span class="hljs-number">29</span>, <span class="hljs-number">30</span>]= <span class="hljs-number">0</span><br><br><br><span class="hljs-comment"># print(M.LLL())</span><br><span class="hljs-comment"># 2^128 = 340282366920938463463374607431768211456</span><br>l1 = <span class="hljs-number">624231359211481698145444691346758315</span><br>h1 = h[<span class="hljs-number">1</span>]<br>s1 = l1+h1<br><span class="hljs-comment">#s1 = a*seed+b %p</span><br>seed = ((s1 - b)*inverse_mod(a,p))%p<br><span class="hljs-built_in">print</span>(seed)<br><span class="hljs-comment"># seed=98265113854859913689289076942864611315</span><br></code></pre></td></tr></table></figure><h2 id="crypto-fakersa">Crypto-fakeRSA</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-string">b&#x27;XYCTF&#123;******&#125;&#x27;</span><br>n = ZZ(bytes_to_long(flag))<br>p = getPrime(<span class="hljs-built_in">int</span>(<span class="hljs-number">320</span>))<br><span class="hljs-built_in">print</span>(p)<br><br>G = Zmod(p)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">function</span>(<span class="hljs-params">X, Y, Z</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">part</span>(<span class="hljs-params">a, b, c</span>):<br>        <span class="hljs-keyword">return</span> vector([<span class="hljs-number">9</span> * a - <span class="hljs-number">36</span> * c, <span class="hljs-number">6</span> * a - <span class="hljs-number">27</span> * c, b])<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">parts</span>(<span class="hljs-params">n</span>):<br>        Gx.&lt;a, b, c&gt; = G[]<br>        <span class="hljs-keyword">if</span> n == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> vector([a, b, c])<br>        mid = parts(n // <span class="hljs-number">2</span>)<br>        result = mid(*mid)<br>        <span class="hljs-keyword">if</span> n % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>: <span class="hljs-keyword">return</span> result<br>        <span class="hljs-keyword">else</span>: <span class="hljs-keyword">return</span> part(*result)<br>    <span class="hljs-keyword">return</span> parts(n)(X, Y, Z)<br><br><span class="hljs-built_in">print</span>(function(<span class="hljs-number">69</span>, <span class="hljs-number">48</span>, <span class="hljs-number">52</span>))<br><br><br><span class="hljs-comment">#1849790472911267366045392456893126092698743308291512220657006129900961168811898822553602045875909</span><br><span class="hljs-comment">#(1431995965813617415860695748430644570118959991271395110995534704629241309597572003500157255135707, 1011565891130611736600822618382801465506651972373410962205810570075870804325974377971089090196019, 784497518859893244278116222363814433595961164446277297084989532659832474887622082585456138030246)</span><br><br></code></pre></td></tr></table></figure><p>å°†çŸ©é˜µå¤„ç†æˆJordanæ ‡å‡†å‹å³å¯ã€‚æ€è·¯ä¸éš¾ï¼Œä¸»è¦æ˜¯ä¸äº†è§£é¢˜ç›®ä¸­çš„ä»£ç å†™æ³•æŠ€å·§ï¼Œæœ€ç»ˆé€šè¿‡å‡ æ¬¡å®éªŒæ¨æµ‹å‡ºäº†é¢˜ç›®è¦æ±‚ã€‚å®é™…ä¸Šé¢˜ç›®è¦æ±‚çš„æ˜¯æ»¡è¶³ <spanclass="math inline">\(A^{flag}\times\beta=\gamma\)</span> çš„flagå€¼ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p = <span class="hljs-number">1849790472911267366045392456893126092698743308291512220657006129900961168811898822553602045875909</span><br>A = [[<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">36</span>],[<span class="hljs-number">6</span>,<span class="hljs-number">0</span>,-<span class="hljs-number">27</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>]]<br>n = <span class="hljs-number">3</span><br>G = matrix(GF(p), n, n, A)<br>G_Jor, P = G.jordan_form(transformation=<span class="hljs-literal">True</span>)<br><span class="hljs-built_in">print</span>(G_Jor)<br>X=[<span class="hljs-number">69</span>,<span class="hljs-number">48</span>,<span class="hljs-number">52</span>]<br>Y=[<span class="hljs-number">1431995965813617415860695748430644570118959991271395110995534704629241309597572003500157255135707</span>,<span class="hljs-number">1011565891130611736600822618382801465506651972373410962205810570075870804325974377971089090196019</span>,<span class="hljs-number">784497518859893244278116222363814433595961164446277297084989532659832474887622082585456138030246</span>]<br>G_2=(~P*matrix(GF(p),<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,X))<br>G_3=(~P*matrix(GF(p),<span class="hljs-number">3</span>,<span class="hljs-number">1</span>,Y))<br><br>x_2=GF(p)(G_2[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>x_3=GF(p)(G_2[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>])<br>y_2=GF(p)(G_3[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])<br>y_3=GF(p)(G_3[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>])<br>a_1=y_3/x_3<br>a_2=a_1/GF(p)(<span class="hljs-number">3</span>)<br>flag=(y_2-a_1*x_2)/(a_2*x_3) <br><span class="hljs-built_in">print</span>(long_to_bytes(<span class="hljs-built_in">int</span>(flag)))<br><span class="hljs-comment"># b&#x27;XYCTF&#123;y0u_finally_f0und_t3h_s3cr3ts!!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="crypto-random_rr">Crypto-Random_rr</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br>flag=<span class="hljs-string">b&#x27;XYCTF&#123;uuid&#125;&#x27;</span><br>flag = bytes_to_long(flag)<br>n = <span class="hljs-number">472993274721871037103726599805149366727531552333249750035977291933239067588481589544777397613192273114354221827196579379954069925604091911249655707080927769808587176515295614018992848517984372306879552247519117116110554431341268358177159108949791969262793325836353834899335531293329721598226413212541536002401507477776699642647348576111445702197483449777741566350285229621935507081895389023444249054515395783080003733803406382744631528246608154546123270319561514117323480441428953306734274538511770278887429407127143049023747710881993279361892937905382946820141513009017756811296722630617325141162244806884220212939955235410280899112731530527048274396186038160728562551536558223235783656985493518204710943916486379681906506757757594165379493317173050550893487151879681122510523721157284728808336110950008840684602353984682117748018347433177541603140491131603068512706893984834735290809952944273565203183330739252949245209529232254867201402656024997949207918675051941911990640248052951780195402390132237903538546705181463959793972284823588987652138458328270662652334799233015314673544813649692428544375538627858921763941533600553536579901589575693816746953261108022490849251974419402753031545629158199093099096735356165044275617408697</span><br>rr = <span class="hljs-number">11898141078345200236264081467585899457224809417108457314508072413792599039332439547789237898270544336909458761754683941320649771736625000667170176071314483</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate</span>():<br>    fw = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;random&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">648</span>):<br>        fw.write(<span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>))+<span class="hljs-string">&quot;\n&quot;</span>)<br>    fw.close()<br>generate()<br>key = <span class="hljs-built_in">str</span>(random.getrandbits(<span class="hljs-number">32</span>))<br>key1= <span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(key)[<span class="hljs-number">0</span>])<br>ks = [randint(<span class="hljs-number">0</span>, rr**(i+key1-<span class="hljs-number">1</span>)) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>c1 = <span class="hljs-built_in">pow</span>(<span class="hljs-built_in">sum</span>(k*flag**i <span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ks)), <span class="hljs-number">127</span>, n)<br>c2 = <span class="hljs-built_in">pow</span>(flag, <span class="hljs-number">65537</span>, n)<br>ks = [<span class="hljs-built_in">pow</span>(<span class="hljs-number">69</span>, k+key, rr**(i+key1)) <span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(ks)]<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;ks = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c1 = &#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;c2 = &#125;</span>&quot;</span>)<br><span class="hljs-comment"># key = 3168111950</span><br></code></pre></td></tr></table></figure><p>Pythonå†…ç½®çš„éšæœºæ•°å‘ç”Ÿå™¨æ˜¯MT19937ï¼Œå› æ­¤è·å–è¾“å‡ºçš„624ä¸ª32bitéšæœºæ•°å°±å¯ä»¥æ¢æ˜éšæœºæ•°å‘ç”Ÿå™¨çš„å†…éƒ¨çŠ¶æ€ä»è€Œé¢„æµ‹éšåæ‰€æœ‰çš„éšæœºæ•°åºåˆ—ã€‚</p><p>æ­¤æ—¶æ‹¿åˆ°äº†keyï¼Œæ¥ä¸‹æ¥åªè¦æ¢å¤ä¸­é—´ä½¿ç”¨çš„ksï¼Œå†å¯¹å‰é¢ä¸¤ä¸ªå¼å­åšgcdå°±å¯ä»¥äº†ã€‚æˆ‘ä¸ç¡®å®šèƒ½å¦ç›´æ¥ç”¨randcracké¢„æµ‹kså»æ¢å¤ï¼Œæ‰€ä»¥é€‰æ‹©ä»æœ€åä¸€ä¸ªå¼å­é‡Œæ¢å¤ksï¼Œéœ€è¦å¤„ç†dlpã€‚</p><p>æœ€åä¸€ä¸ªå¼å­çš„æ¨¡æ•°å½¢å¼æ¯”è¾ƒç‰¹åˆ«ï¼Œå¯ä»¥ç”¨p-adicçš„discrete_logå»æ±‚è§£dlpã€‚æ„Ÿè°¢mapleä½¬çš„<ahref="https://blog.maple3142.net/2022/06/06/seetf-2022-writeups">blog</a>ï¼Œåˆå­¦åˆ°äº†æ–°çš„æ•°å­¦å¤„ç†æ‰‹æ³•ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint<br><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> *<br><br>n = <span class="hljs-number">472993274721871037103726599805149366727531552333249750035977291933239067588481589544777397613192273114354221827196579379954069925604091911249655707080927769808587176515295614018992848517984372306879552247519117116110554431341268358177159108949791969262793325836353834899335531293329721598226413212541536002401507477776699642647348576111445702197483449777741566350285229621935507081895389023444249054515395783080003733803406382744631528246608154546123270319561514117323480441428953306734274538511770278887429407127143049023747710881993279361892937905382946820141513009017756811296722630617325141162244806884220212939955235410280899112731530527048274396186038160728562551536558223235783656985493518204710943916486379681906506757757594165379493317173050550893487151879681122510523721157284728808336110950008840684602353984682117748018347433177541603140491131603068512706893984834735290809952944273565203183330739252949245209529232254867201402656024997949207918675051941911990640248052951780195402390132237903538546705181463959793972284823588987652138458328270662652334799233015314673544813649692428544375538627858921763941533600553536579901589575693816746953261108022490849251974419402753031545629158199093099096735356165044275617408697</span><br>rr = <span class="hljs-number">11898141078345200236264081467585899457224809417108457314508072413792599039332439547789237898270544336909458761754683941320649771736625000667170176071314483</span><br>ks = [<span class="hljs-number">1462227062794249126369859823370329795444295554631867449122519463903085153603985900680740216206168716423777588580245877886440288748604020630699018542826979566965387039050150069523167528973701117587082189067128448763762233651697690088165126309640643249893980922783446939093480513501423929380273397400708296781344423099729594996935151205635124630966978346265570102760841188859706856157965455490428917432012469015925570881840242441646984344205989934223312311722527845</span>, <span class="hljs-number">17436088264981004997841810232705191434707487036117316568031039310756229463817709762330626096875057666532776781413031682988478368320631200639484646124749334955850093397553177978996330881043557698983399584498223222105144624884205328876488334329130830465297477669138121963831402080876078357077714205039964108868193841782271495425644463200232523492344001660692840819160127541347575190224749912289543698786833926857916729347030739521501971908837887266088602825603179428932500122868635833564921115729380769315969449959847532694279060981180556955413680421245680949817931938812637093078177255366095925596232172597647804659446</span>, <span class="hljs-number">169559415577702492912881115171844374594897133030580223300760597578879930554761809414648409965790290108683744070236827542547112767931390381215817208191241194452401715396697138137182840759511035487717013487364495797652031544286820278750675326239062595892448739046788242584477837603604028584783800711126256213550041835365566067529075264741159242623075137208552904103323636912832758118607742414554050834861661347524996361121876885982545956793412777613516967651789645670837406737788560923095674100190720996844931263803247711890541497769408802573382496173181275896304033554412089516486158308042512557770316390458745235174270820619821158359708588836275104941171089532593072639298996037834372691067497283819036389853616602440038642702961597540965107104661813887585271108258467582</span>, <span class="hljs-number">353291124480685802122760873619558181197925748758526501461956322344713145481696018545548833112663130052221102526199589136442461136617134139228771440873303781403752812631064169836368616974931324935659661616432397250323791027357698736360780111349622044193849460721756463896782586060025792712427344165223388631274105033257953386232975622550466772244070538660725769821337872161112606157590652531598571409049763994992112562965984307203582687185746063109802744989804265169651236595150092278455325980064053498109201539606445526852506504951020231421164201055246981085535835484260199043182412639045612970769228962343363308833437852540654614315024696428638587640053405690902605225272716392141318356689485996722112797193445203157167283359129296847476836010747322296658815494204920904679373943240361056289263055689989853602794079068762252790541020355479732830748629340531275553956346072236216251442369981439899969148055895199797337493316</span>, <span class="hljs-number">15179303239962972288090709923258186951958171456436855682777477692171617505348532247047242658368307257431505429176030938743052282481669819891838891541215477308429612423006023438195430836574000543742809228546430000091179899316856488547218901706415026288318088205302049807334703045024896255849147262301854988225565498235577522563864689394270282449494777293613090615435735306391538191861818216934248371120219493426168505800995544058108910908179783162033445093246274431640068273309491502382851514221655427718436104350319852529981208352415296770552441024164515192550794244703092453886081781025084452892498434750021938722777929757172650087934502975720197724550995892550276217204632074271485875928952811717435969392225184804651569530492559664256153442664382496786312755369567453642365570522203867667064702855064117777248996452839510530112258447365219153330364325480082364302480271013963043808407808026617207478317657335771085499907980998058580300198585325142615450209133083897393551483195987009899057506802305527262738968147264513649676062280043385168050292062437784343481003416836360329</span>, <span class="hljs-number">104314025112423274137233712089887942843544143270638359212971052274128269239471444157192816218808079846611202214084249469627150795706839411653429768726632207799788014550224322493762432406192490957609286668132611092680358220234900446241372261756133560546933898911405464919838498505955386741631220042481687693247513434548162014035705016381807652211578605534090062861927303094187322830394428003720849259122728764020582018050036758593860110512593538102856625101436236685192028585785277359733026956010177985114124809725271266235518425292300207754430093643901348424098723963444965623388363705031341005891153453971749807676104809873756494951980451522602316873491452723525098105304097227244362803315664527459814806074055296007282695273078439762481309737546526713550861490435485841202437290236273820499123268038887900937637888673263245804550050225236201356152470642062093953920448272200600863673489805148880500648543349624355627609552339313652249538084845763001317045938369921466480729660920730443079784782692236767617383867121962635468379178835807692901877341892412552450901873955386866840632105626000662355131829735238309392134598804443268332424263236647235664725585301289855948091012922650578186399459695913486992557308313400835129903295472</span>, <span class="hljs-number">4343840077241661846268935044680587301922553038527003445558194299629246437770144538620877381238906692028249854972040151877119476048349008469539245051594012783879085195059417005760769680951795800991838280644405366143799108863486512837967757384337716585187068737628553329955797218927948991807398217726158890043209786493155396314350961622153611660511283644242391666275370968989005241503828383899735010790229677725184129352599961733027673035747501574385230757945287667652891580150423322079486963198642876365246595747082980621374167798723795545482544349625906607527172146616536749758514128592808962495027958181278487153055495228539745094046329616245517171769643273537017191271548980274132500153620316208900769372928143878394476769232210760910446165114726727346459588121745157883051053172477968719246421056145184230282266693069367823549866560055702512612897427682313787206166585448900167833527105055197710187205451619052189815465364328045147326853372540758120163941655690535948810941959546749120505801600233689886118090477238999842117697450804442045413189286597419777550661497797676126492038567180797469427287581550651480006192621101368344597554817693129617367587265330631435038864934907358392135820575836786357021588185619258824320681971817694708190104082162236078675439624893099574428154391060852816948575281188326664739692492957173855447270784701674993602965772572705572236661284175838750276</span>, <span class="hljs-number">33232188464261655563179500532261332740673268011927651630320348613939386668276216461522230721806580297413734568274970935459682942632905228878109266134442095157849521426423087852309281434787500339731212538950209119002423508188676963099974651225610558899243654721531277558550493327350452829753190227897808568073543678269898207509403265336445740620238191925668387207191570780928973245140015529624527394339504110166219539275461482559378890285009329265175900569903390034280071197123026951890243045598372762777194271518734277493717862068019851753397533687634966545727487904367806612431117675184708993348444665119927999157611733751268566184403876833185469516137451908620375918418813671459671015165252098516843945558856771686910403711604755349007547521956309000907909321344073563215005461926587582952949359614987174889724241132421264477252674765866525922832869625858802619129860030857164098812287559445509108640318149480136605636205337149260208047286736509632239281682602528730811378780178290081953095940304361016309200367801327179710042344212586894803008913891990437132132154254944818304511848018157641226316486358816741537666493766664969385708412966038685156129617636758707978377511764106375364810771789547724915964400747168477073598611228354770053945278770974453529085850122110633659583211141893829685722257824029598188511772787791704436267726687275674340238387313917520001746093685584958790950657401396602667943161883455431709467342749040393470692558305012064228847045344065542300917341497880086951027085764240682050347639183710265265174608568581</span>, <span class="hljs-number">444779920211605528457399163778798302264962864500581879449061229089239557061028178632115126869104894859226622560444516783454331855728643653865605416497057611218192216553619406318123596530221714071025603907837449777716507496519968322248412164964314856154515711925650355367893348523307966596574094376371033024957143232394835676102505384939927310874548633276763683911796494980021115548783946752097475837673376331732397502955289357489918575906500096508563791334858578196054364575510262549227364768636710590870090347574179185730720326430135005745433229085504757196383182089273767249820043995239845148428050144582143617569531992315827635029452027206779513658792594533984308575410806115812027902735755703109725290139038156207495514857551309765646867686889984088386887429907974093388131425361751082756577755914020028802552784669428525627343682049455098817841762010840270014859394810253384211716918791183946657609375093285440242734069437770190190813413589772304378568548089845839766313942144795085022405996403115650259032402819679689834193687730312737088900035185810701229565183457677574983602078058685068344436316207621825755389502057132478973466812474466361405511892936227130460055637816125221120263639554189413490859455156262013094121152711225170530206766029467454109467305401401846460468093777715624211347060013862325763649394914935407437210178038317290293919361423759769343159231891689139655490453425886071219512994202371899835337440763173124439640514220811318874946924703189200447691715469272243497270647235873464259786562267062001636730421451659510209634262617060501219332722128011149714434675517928550498574212874429311999930642838137400894349532393752915440919307741932816838690395606129263401130</span>, <span class="hljs-number">7602657349299010857087412189053904610014835470031847851883656349200899897074907434799227128793882909815738193292999732731888978083302895341590290406257165745016960805038897127665671830799203429105439046544232550057709873279272509500788880966204623301536523568757142788616714342396835348896652095993273120352216558215593487864297089604696564960677302089801831232789103069985778444311388865194583877243016764859298874263207514989622286824950955134805871171552294553075628653085978727480483509447782713038101591216015129434695340034230885326874585545666722007375755217543974918948104058213162198622707539613172458718150254646150294432030411829433714905174414616923009739539225989262351006787760054622647363592552091025438151580366414103445836645659713990402360169403016672502089016488614454624878982485618028646781661937237681350359808210590576468884385972827124881157769458685969004277110291444619196405001534224888721294643753150729204059438079951844348808565383170513314781032113884141668626087014977362543472261224194658720773278314480331562064521903562028929772245246023044918780612944818960063465178711539798601604042918647125400052489298307932451350609822767956789584605169244797260390089496546479886501231620453426723358141585623383732719446553408376039010770786422589076208046136110959032740167791347231308499822725649244370210435390174503003095419480360405606956944343844737311175070859345840892142099028930344584283138344997292575870767828146422997758547138227712103360348602516685557024226449188853398358276132193649977284120887692434143592539192811494203655959855535383027295793357853938962196086241223840647731695273486642076372427955673144634441281545597498351950046381851656586528708237353884336502685431879297832928729212632646314921058694911651155140211366665485536218812420299903213130769617228499207211355651173115373832276702819917</span>, <span class="hljs-number">84264285782731568162877315100957489042921709978064128681351268312087746569277269486245900009777400169887830271723552358655565447593550146955011831050100818215000508691318113595184405583164046098487595114378660143656870174865126611342542042359190092909153954755450866325242940723529598062222899187359928557844177883049590925651498994463750219753412624841866695746278533280094878847475236701017015819139013181859456526369446971330754812310385508018904191327621492159168820784532796330689921699298448074204812463376397381282323119448865011664447416851175564248969000702694318145335362835482058897168517488161967391334177372697703315388808719141005307789457461912851355132825731054246686755461163054191160703614564317990818604434605413936738139726767800963911739280012496306857434637923374480459728565199969705867209254398601345461449150134011614149873500167983320745189254670021733091744167981087834156449345560645456017335407633688885028006913440590401180339340613693275890333649989994343631183579024732181147263210054753733928915807504572214832934722959416211618552311628264441740006263506928574652072303741962304773970001278403931114817733924209744938397932123215729579525983133592585604481836441256004482294972680139829929612014077833332681473454850703790455910234390018139844986977475904490461864701830158535403553678623812164036013559496102371103327886019446045373299153105962515417300141416878319759519389540938146354852993808369804508844242989928184577744636058484630309125804687764207122455205953467056765480238519667329086954915863584834116160428194118255018588109352554311335461224660821734294806261011545470878130619510996578906865491369421849868743287382195889612248362671647411387033198694140556943015854769888065336118318462104334038850907108272666824691321243254155599118711741561988645703051401242347980726593263524750481061186510425684386819376145632247818469939222055128225225680599982324030716227856712465076900465158037591919290264095582887285060549164180202017670962738795868581166749</span>, <span class="hljs-number">86875322477430958180737121081750310417552562568937472111462285494068077044224883282734365519155742412567742579384640688864318774506290688726649362821127869025823526558190891391368772700819437828837459806248988365684079824273784568628472269256575474035185709547347651993828702097549741334374364807937523943589572886556418546138161477442285095981598112603569341799645993286627117775387075506854483018231019196901947857611575841702330988975450215180893407629689116208362182111134678579611569697431926172879405158644545853375597102146456828749129737059398592090470207221930164907529449914731078780527501106015075222892079609819142004929517650214077829963858911041047626149998836986070729125260139028680402532903187215589441565748744974914634384575746331436503499349361029226889115930910170650991829637232214683931349631413139076186550993209917767820494311457665926894684877305970805039969582722809409057884485422798810134923124618610122219627418825157655548696504402394251875250216209088386596839289090205455355830326463145513637140192806838161127837601889645337809125003492037067870634529636104813436961659217629590299188696646907180990318511335172435862882285594729483438730028804396906143686407113299921602779063868388165847291926366314379673487291861917979020712234162374569910970226596823115360201748087179946804305525598669650976080327154187180758461602309422875784085236535569730334773176739598656049048170461638432200220436248431274572686422522379720157015816524948018313551155878299198696729645812418550240418562460968434597425565276688472550697127256796390159826046074365566403255645195972270118195562599397495009632518911353576570958767630794735474661250425256764192128158589944999335063602995713281667673220224066976800182326927451684095263096450327503087613798593569273550869670074927576509772147487168451681956168877773772760560498198909642263656809675890678191288443016329637625633073593034921242604872479828009991046383160941673220022936977188891725330716968754725864852252393788824966035242075304806536640145214252474418277831012513594308952183851343958969850677298051187040013011759593833806518361877966381266531975488250988830914527197364101</span>, <span class="hljs-number">12512746540434506671622137154487272479684301796741804852784466276118318939301642459078381853231258719083628458347218300308117654564963998239910113998177176145693597297093613404613373790353962391872079537076763899617842035568892498763955045462691124784114867824842208398619557012590225397311703746359043524766454656517843775988786861851276648768563329960194176509861369794873055457605566481169738163028805838726245153501259733517437071411250664053003146288253452678594410757071147688309902950173685554263072263315677468119998237322488014934897657616287531839226555887811741614460852594517274931125186552830901907056814814364537922270306184144816527619368461860735029130410855453249885989873125086119053183377748071520492963343904276809950936122217011456932719335145019854799217844683275916251254411759723367406995497382110560047670724344385060716483035502136838796674166618447372318994376720742190789098253575402714952812659933854943786548064525033834188130429821475033759906784746466100360319090217901641302494652036828536156345999295944207311903908579168517843644212223034389569172093947663228241575508427027088548956357607118349234005954956185598117597472201788146015733232957686350215358611056864787006128071212201859644019363381882103578216957110324101802774053325622415064181605199128828290427210592657379567354577480538732546950307498243047731412124485919082022649710227773753299708907420377570860905912772090222116049362619789689065827376289781835174416236170541192824551498867290178284835242340226614885213085297034699023207334693204443834177633980478287732765627349487390651101805889417613406850491982522373652059294595205056982377527663490663856624298132703619405155068989422975395069609806200717991260670611916599446743505075260280455301127997860556855773088502432536965641419712974469765402344889497455850368646912720700712406187148014080534412935202873400913358906387215078903911309526903672652336133008199048483053203616435313691633319058270312626100467991257715266040851461069620411861732977165671779365665772314236597023035647614424138241559672376552675319414807273488451981119673616629216737966281726964723616994609707694019677386869057732381647985259361201436431774138127924914503212637589804812882400769493547225221791707699401249315407469433861394473469478007958068015775562155959407640271035</span>, <span class="hljs-number">8708772086314275150137563047822324600135662221530061604490923488781196834561031216119766508710300439592586098337033648172158478037428422016638015261006654452028325941079516640378163094114359263904509663697697446450829644183714138570138053299079111099978730162273301464139950471846002885912898793623780911069208262571511170830772519224286142285588233365329150597172851602037056835267890472296625561911616145092230018104567552026345101742597268103327522556484095066615892886223565058357363680363535631942614863586767642475310674520180258183502370763782154430809207907408245635540513317210636762204031484268471851140728225200408406477879491421034411771595550287534644492458168126531514396470443302572852034873709549055869547530655956369042654261333529517571359153739442787262860093740661118519451621018435524810049086927689546375333874177211297659402716374232772574921960004351227056283357373573456626553641214672035447396850649297539465342595024155246359918811294045883925114447310675847751632815638598802360958589640694941216735143869543493813631906641446867757344570346832228628926669569641235390679032157550781745139542693343976899951858605641387961226781860479580622706408871423958897669045935376111333791269969907893321496309204776813332733513920276388085041994007557204267637656364577970814757016037506402807507663275686948184629913418881333357288030576799576733495401166943446587740185387874828772125373722620767643073868513719861621143440955960613060364895903611801265463530162601221089578458698304546551933625165213065587195349408747310822367615685148092899114446129224352042234315865770543693346677200293484242331181710417082363209828386909100998998888639900536186820795298321286714108461675397032864388542110213210827364423163325349547591341479159200210127489502278231430650721377665744894470461939053982524090875574789651853588962397719426413835176058841208314719781852021952695059793831541054574871680705012400864629090745303863048197498118155019461006670125137061405464976922277176269488571398394629261276128473896794210626729855368774199524936087915252643083350806653978162434973122894687105799198912067140963567030871513363285565713597188757003358857092315759659368775879258759880919191003344516366609757523241375325301693755640462733509474415702644254270875174073203609818099246161951619877073996976627155333499346477458629618081495288947853190429723736471113704267980053978389993182103772852202476116179106939188158462552458652108321980165243577989</span>, <span class="hljs-number">600670032931697501164308145888014197492570434182237560158362504047400318743985557099146474331125213856150404793770533457208418057346330441677143608228832189090853249915025345091440471977572520377721353552421230209210878714408072035504562082229497678931477951277415656323261513473676851714174232119110952631892409156281805902829840067360861715042158260954202580085062540987292060373485291126788640037325353253582263912429148264582730931166497761524857603024286533377786733733569503217095911870554634981195459051734711257551318783862993538532061516918229242512785148483203666879172553287417202171558010581931339490420944579378230441427075256586289381172933294401587550551868745979621899498946185449116142910195187754784531077545817750030440559239594200572501795505647816820925940699189807911408560014741609936565474163109147615538288077368434085501495660339791023107653834631734799739401195331082524762689829404043854362928974818455326969933539941993127168162613893714556812406931262398133232164550840686759286879519200522303631666340760585955445333243578595829239195345013932609791828394260147075352440178009791316103080071026057431465935054583990885807722362958473601534263884483797804520563080119843829936517581710475224995487406412704094626227661853966476374689727423649602092208013642493973696165953898208578723428386172214500367650457610332358123936218429284291631085293746168516063238704669713654100448973473107547290896972051178145687724778934856166935295480879225802399479077346027327314330339492654814903821691676533513420126315351413897998334933276481425781316933061160336396245725800475529909180155168951048807842776329370733724945778641650510054608686950632422179126803289332576361096595524712081770649946303450447653874189205658344800236157548893404541684986435295108661952487239009695950009496079506381196591935645314690427759872790821975631216132209928929354223296595481820239561580620161078572691513920025180731146443551810374070796784563832569069540610771634802811283644303060748631402280436293606074124845116433560780371614622560694771710506136314406382632695962443912413902134325317328060708301892967007571381754948796760722223816096248930178117187568894324829422197591098693433015570587292619159140504205675563120383480457405492676888099039922054652604691220210221980510833810667665873272200431377635693722100801416566512889633584494029920362450447581541351127279435858414431885445382278645820452301854483001535497815948240428726604118517960146521827602352741617814422650606656703172306618878677224079000419335204662784233051630328692085443396990051814696765167700904476881356841198817297213897315038</span>, <span class="hljs-number">16802200282185468546709956092597774740677661549186109526956115242473121883967931163131646187704424819015848998645400207990914089013740921040117435052153841770979793783160919446710908856026577921822303736856837341534046856200378566367573847587481842033197417244157615430123019293064402352517730950287717412467467865654183120580805017956735624709774788608215096623799957840473617022005811932787883583498153009349216019520591315741115282954188920266939008472763372248700697866120997747281838993436471646694877967037584713292557154069090849429661358360669249141411401563354311865086301325223201338603660585063135197133579821848197298915130533944228373462645556131332664180638837298172981687095294316288287474397100963640912775346092923086826604630609655904543259441330900502644107449819662176812660489691326329405408557397950478553867742426469439899689820127149948041436799921133103166748621889384866646157787616184868217116001323368301878471584588973680319019047080248726830275150507574175166679909676797693790108124055103246880427997452475987304179562314626608037471679968401792562140826537740199515244895441348559877458197387323837253170889409923432265627983693113613925422770696270052261532295092167140744798998616784973950454662490861686686088097664631333759768155114942862532519746034900590201459240562835926241941887144381202153705241903628166984657567323072355632922438685555213721062141830979317585407175747781177680148572415131107678588710821046069788978524572240303124373546329950302755883009871688891897763945611072996185025629828607383345003927868697847599452468428107980542821610672736393669832455756995387290606284835293616942665638848969022879828703775592928644725559259945529304050112289143946763124018433851771902626785481385869955110673938215223622863613678412315324306153440766902206001688838913230436350171971289551619865068519200736270652193304810653015371888594169504114520468603987418351580463962583790787745908309177358777801427510313483309516938585851407176405272323275406264541269998648558076115710572739949113174179063104037408892800012305672645293826133157192205750448664938758484140537975600112928783731131731160554472918720908169457539285420601699964488745103603485765360051670848460168635009550254451173622724686795853530317243637913985666214527422655976232855531815124677038149005239212580323707459514903671850604938595975480625971419288321333482646971954799306704972896590507695031753549266109898497496991269990475759448688581247659517684220339086012734812415537965920455360852739093844076811759759173303373454199660054006117215442176739570999154607921395801738324345694513716171731402600767074759488172948500119306978382635362273371756452203795420879806823382694171689272398990752964743539328906992588078386684970091097095002524822271111900103</span>]<br>c1 = <span class="hljs-number">363788646363430038957594782766177313516930410013028761096125449525352900311987342432332707389678725464245570305442656091083147693929633253905472222223119105496597576680892700795690978029583841539541374381306488238546636925041645743837795052980068923686651284191050257037214462852085566417008362992641640639862428112228493556483476170926590723955399664612288121797929235261679990399185352352544286959163976884867676390120340127790862048627561021372508575978346406322179713972665443056495181281314029605259955375166316993493231524529034376084736285226932730392410446057610167031627686895389188357267336304140707750661551754532703726810046229782522509583068679068266026330534604220136448779670239303044844594369863033342562614954908580980797071779438702134548396966154384817728024762723793272143181635940946334888845065820620182286804643281323447179363272699368386379953273502775010659085362938622805062632668642982294663858335244396163857338508227323801751681995976156487970781553331051080424612021398707159108830544940316009623664909356175231889874464365926612039289520439021685692867423908585449824825323639525381296026274686349117857285659369998795553471936274903352010099265109629071229881541531543477669574187083631324785284254322</span><br>c2 = <span class="hljs-number">408184822131518156560324293475775283916865330287271026174896526350123511666895281956297307670862799857291692050125369779347444868678108319280695068081984027607535529170555137883873801205238074937937942433229726545428621408643537931796698659949811571615439710035675674461716185346635792745790874541046465708604310892716226150611709100803537856333225160587696062166931121471905405372834167788843039506170303362597157739646424300148724721973787617390725217064863182798206515059995025139870581046657455818390197378360718268577414540468313327849155326977072599665355467818781585456624519602844435476444300792593181233725708809256956289242348798772583396011536497809799519543692707372931861510836406771810916160714625641110048105945905698555148489134800297890071585166636593108936219686471652288476546797128397632673886639590166634763861905600305344338904568157848336645918449260801970498973364463883003344546391045331665345600454985730993059182020185438557159428617482719829271986950641093353253897984198499501965120625507862855814501340943227107501804839977088104677785444986972836309787440401273632064782837200999263612507784233705263545942160822597103292282242714942650302979883274746718391358487897324158260429570732440514025523470979</span><br>final = []<br><br><span class="hljs-comment">#part1 dlog by p-adic</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> trange(<span class="hljs-number">16</span>):<br>    R = Zp(rr, prec=i+<span class="hljs-number">3</span>)<br>    x = (R(ks[i]).log() / R(<span class="hljs-number">69</span>).log()).lift()<br>    final.append(x-<span class="hljs-number">3168111950</span>)<br><br><br><br><span class="hljs-comment">#part2 HGCD</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">HGCD</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">2</span> * b.degree() &lt;= a.degree() <span class="hljs-keyword">or</span> a.degree() == <span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span><br>    m = a.degree() // <span class="hljs-number">2</span><br>    a_top, a_bot = a.quo_rem(x^m)<br>    b_top, b_bot = b.quo_rem(x^m)<br>    R00, R01, R10, R11 = HGCD(a_top, b_top)<br>    c = R00 * a + R01 * b<br>    d = R10 * a + R11 * b<br>    q, e = c.quo_rem(d)<br>    d_top, d_bot = d.quo_rem(x^(m // <span class="hljs-number">2</span>))<br>    e_top, e_bot = e.quo_rem(x^(m // <span class="hljs-number">2</span>))<br>    S00, S01, S10, S11 = HGCD(d_top, e_top)<br>    RET00 = S01 * R00 + (S00 - q * S01) * R10<br>    RET01 = S01 * R01 + (S00 - q * S01) * R11<br>    RET10 = S11 * R00 + (S10 - q * S11) * R10<br>    RET11 = S11 * R01 + (S10 - q * S11) * R11<br>    <span class="hljs-keyword">return</span> RET00, RET01, RET10, RET11<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">GCD</span>(<span class="hljs-params">a, b</span>):<br>    <span class="hljs-built_in">print</span>(a.degree(), b.degree())<br>    q, r = a.quo_rem(b)<br>    <span class="hljs-keyword">if</span> r == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> b<br>    R00, R01, R10, R11 = HGCD(a, b)<br>    c = R00 * a + R01 * b<br>    d = R10 * a + R11 * b<br>    <span class="hljs-keyword">if</span> d == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> c.monic()<br>    q, r = c.quo_rem(d)<br>    <span class="hljs-keyword">if</span> r == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> d<br>    <span class="hljs-keyword">return</span> GCD(d, r)<br><br>PR.&lt;x&gt; = PolynomialRing(Zmod(n))<br>f1 = <span class="hljs-built_in">sum</span>(k*x**i <span class="hljs-keyword">for</span> i, k <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(final))^((<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">7</span>)-<span class="hljs-number">1</span>) - c1<br>f2 = x^((<span class="hljs-number">1</span>&lt;&lt;<span class="hljs-number">16</span>)+<span class="hljs-number">1</span>) - c2<br>f2 = f2 % f1<br>res = GCD(f1,f2)<br><br>m = -res.monic().coefficients()[<span class="hljs-number">0</span>]<br>flag = long_to_bytes(<span class="hljs-built_in">int</span>(m))<br><span class="hljs-built_in">print</span>(flag)<br><br></code></pre></td></tr></table></figure><h2 id="re-ç ¸æ ¸æ¡ƒ">Re-ç ¸æ ¸æ¡ƒ</h2><p>æœ¬é¢˜çº¯çº¯çš„éé¢„æœŸã€‚</p><p>é¦–å…ˆæŸ¥å£³å‘ç°æ˜¯åŒ—æ–—å£³ï¼Œä¸Šä¼ VTå‘ç°é¦–æ¬¡ä¸Šä¼ æ—¶é—´æ˜¯2019å¹´ã€‚è€ƒè™‘åˆ°è¿™è¿˜æ˜¯ä¸ªåœ¨CTFæ¯”èµ›é‡Œå‡ºç°çš„crackmeï¼Œæ‰€ä»¥å¾ˆå¯èƒ½æ˜¯ä¹‹å‰æŸæ¬¡æ¯”èµ›çš„é¢˜ç›®ã€‚ä»¥"åŒ—æ–—+crackme"ä¸ºå…³é”®è¯æ£€ç´¢å¾—åˆ°<ahref="https://blog.csdn.net/qq_42967398/article/details/94759944">è¿™ç¯‡æ–‡ç« </a></p><p>å¥½äº†ï¼Œè¿™ä¸‹å°±ä¸ç”¨æ‰‹åŠ¨è„±å£³äº†ï¼Œå¾ˆå®¹æ˜“å§ï¼ˆ</p><h2 id="re-ä»Šå¤•æ˜¯ä½•å¹´">Re-ä»Šå¤•æ˜¯ä½•å¹´</h2><p>ä¸çŸ¥é“æ˜¯ä»€ä¹ˆæ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‰”VTä¸Šçœ‹ä¸€çœ‹å‘ç°æ˜¯Loongarch.å…¶å®ç›´æ¥æŸ¥çœ‹é“¾æ¥çš„åº“ä¹Ÿèƒ½å‘ç°æ˜¯Loongarchã€‚</p><p>å‚ç…§<ahref="https://zhuanlan.zhihu.com/p/626169693">è¿™ç¯‡æ–‡ç« </a>é…ç½®QEMUç¯å¢ƒï¼Œè¿è¡Œåè·å¾—flagã€‚</p><h2 id="misc-tcpl">Misc-TCPL</h2><p>åŒæ ·çš„æ‰‹æ³•ï¼Œè¯†åˆ«å‡ºæ˜¯RISC-Væ¶æ„çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé…ç½®QEMUç¯å¢ƒè¿è¡Œå³å¾—ã€‚</p><p><ahref="https://decaf-lang.github.io/minidecaf-tutorial/docs/step0/riscv_env.html">ç¯å¢ƒé…ç½®æ–¹æ³•</a></p><h2 id="misc-zipç¥ä¹‹å¥—">Misc-ZIPç¥ä¹‹å¥—</h2><p>ç»å…¸æ˜æ–‡æ”»å‡»ï¼Œæ²¡ä»€ä¹ˆå¯è¯´çš„ã€‚</p><h2 id="misc-ç¾å¦™çš„æ­Œå£°">Misc-ç¾å¦™çš„æ­Œå£°</h2><p>é¢‘è°±å›¾é‡Œè—æœ‰å¯†ç ï¼Œæ‹¿å»DeepSoundè§£å¯†å³å¯ã€‚</p><h2 id="crypto-åæ–¹å‘çš„å¯†ç -æƒ…éš¾">*Crypto-åæ–¹å‘çš„å¯†ç  æƒ…éš¾</h2><p>å•¥æ¯”é¢˜ç›®ï¼Œflagé•¿åº¦è¶³è¶³æœ‰73å­—èŠ‚ï¼Œçˆ†ç ´çš„èŒƒå›´æ²¡è¦†ç›–åˆ°å¯¼è‡´èµ›åœºä¸Šæ²¡è§£å‡ºæ¥ã€‚æœ¬èº«æ˜¯å¾ˆæ˜¾ç„¶çš„äºŒå…ƒCopperSmithã€‚<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python">N = <span class="hljs-number">26278624299187148406559772770865336226934633734285979741424867540828670397865189685966828527168795621543490979182417570078991930822041468539855006585233692884235331084907340302530060261742100702658312435180527335101284800616106884692498603300926488358017928867672861988448488439356448543527810620591324774111321619391264173779312033252573140028630441135269056099074531502841259940379636699304810677716177080486265721322966814104627525953974143476452058638927511594884002185219080847495835727300670028011001853179659250270200020884333850083063514830095064730932997593930711871108436386821290545084229347398808220810263</span><br>c = <span class="hljs-number">3335299537518434350008670067273514020883265809787658909900831303201069228111667477512288715627313377374377192065531931991830331266940281529429758933125645068623703704431432931062515459304407129764836169638068667723468109909932687335727824459807903558617156661138991973933280805156893120951135488168923425258119689993859896540097318197048436676318334502053269738046279338047497258783747007084564814994803144049365117574904704816542523015746396519693505167963245600047742456478545640334467678554748227823020862550712083249012329745708139070338928730226897923885785783461594034339595106377701306570280371612953393097739</span><br><br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br> <br>    R = f.base_ring()<br>    N = R.cardinality()<br>    <br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br> <br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m+<span class="hljs-number">1</span>):<br>        base = N^(m-i) * f^i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br> <br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br> <br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br> <br>    B = B.dense_matrix().LLL()<br> <br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span>/factor)<br> <br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B*monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br>    <span class="hljs-keyword">return</span> []<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">hash</span>(<span class="hljs-params">x</span>):<br>    <span class="hljs-keyword">return</span> bytes_to_long(hashlib.sha512(x.encode()).digest() * <span class="hljs-number">2</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">boneh_durfee</span>():<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Boneh Durfee&#x27;</span>)<br>    P.&lt;x,y&gt; = PolynomialRing(Zmod(N))<br>    <span class="hljs-keyword">for</span> LEN <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">65</span>,<span class="hljs-number">80</span>):<br>        pad_len = <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(LEN)).bit_length()<br>        f=(y + <span class="hljs-built_in">hash</span>(<span class="hljs-built_in">str</span>(LEN)) * <span class="hljs-number">2</span>^(<span class="hljs-number">8</span> * (LEN-LEN//<span class="hljs-number">2</span>)) + x*(<span class="hljs-number">2</span>^(pad_len + <span class="hljs-number">8</span> * (LEN//<span class="hljs-number">2</span>))))^<span class="hljs-number">2</span>-c<br>        <span class="hljs-built_in">print</span>(small_roots(f, bounds = (<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(LEN//<span class="hljs-number">2</span>)),<span class="hljs-number">2</span>^(<span class="hljs-number">8</span>*(LEN-LEN//<span class="hljs-number">2</span>))), m=<span class="hljs-number">1</span>, d=<span class="hljs-number">4</span>))<br>    <br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    boneh_durfee()<br></code></pre></td></tr></table></figure></p>]]></content>
    
    
    <categories>
      
      <category>Writeups</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nazoä¹‹æ—…</title>
    <link href="/nazo%E4%B9%8B%E6%97%85.html"/>
    <url>/nazo%E4%B9%8B%E6%97%85.html</url>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡å¬è¯´<ahref="https://nazo.one-story.cn">nazo</a>æ˜¯åœ¨é«˜è€ƒåçš„æš‘å‡.å½¼æ—¶å› å‘æŒ¥å¤±å¸¸è€Œå’ŒåŒå­¦æ•´å¤©å¹æ°´èŠå¤©,å¶ç„¶ä»åˆ«äººå£ä¸­å¾—çŸ¥äº†è¿™ä¸ªè§£è°œç½‘ç«™--é—æ†¾çš„æ˜¯å½“æ—¶åšåˆ°ä¸€åŠè§‰å¾—æ— èŠå°±æç½®äº†.æœ€è¿‘æ°é€¢è€ƒå®Œéš¾å¾—çš„é—²æš‡,å¹²è„†å°±æ¡èµ·æ¥é€šä¸€æ¬¡.</p><h1 id="level-1-3">Level 1-3</h1><p>ç¬¬ä¸€å…³å°±è®©è¾“å…¥ç­”æ¡ˆ,ç„¶è€Œé¡µé¢ä¸Šæ‰¾ä¸åˆ°é—®é¢˜,å› æ­¤ä¸€ä¸ªè‡ªç„¶çš„æ€è·¯å°±æ˜¯ä¿®æ”¹URLä¸­çš„æ–‡ä»¶è·¯å¾„.å°†nazo-1ä¸­çš„æ•°å­—ä¾æ¬¡ä¿®æ”¹ä¸º2,3,4å³å¯è¿‡å…³.</p><h1 id="level-4">Level 4</h1><p>Level4ä¸­ç»§ç»­å°è¯•ä¸Šè¿°æ–¹æ³•ä¼šå¾—åˆ°å¤±è´¥çš„ç»“æœ,å› æ­¤æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°å‡†å¤‡æ£€æŸ¥å…ƒç´ ,ç„¶åå‘ç°ç­”æ¡ˆç›´æ¥å°±å†™åœ¨æ§åˆ¶å°é‡Œ<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">answer:</span> level-five<br></code></pre></td></tr></table></figure> è¿‡å…³.</p><h1 id="level-5">Level 5</h1><p>JavaScriptä¸­NaNè¡¨ç¤ºä¸æ˜¯ä»»ä½•ä¸€ä¸ªæ•°å­—çš„å…ƒç´ ,è‡ªç„¶ä¸èƒ½æ¯”è¾ƒç›¸ç­‰ä¸å¦.è¾“å…¥è¿”å›å€¼<code>false</code>,è¿‡å…³.</p><h1 id="level-6">Level 6</h1><p>Level6æ˜¯4è¡Œåˆ†è¡Œæ•°å­—,æç¤ºä¸º4ä¸ªå­—æ¯.æˆ‘é¦–å…ˆè€ƒè™‘åˆ°çš„å°±æ˜¯9é”®é”®ç›˜,ä½†æ˜¯å°è¯•è¾“å…¥åæ²¡èƒ½å¾—åˆ°ä»€ä¹ˆæœ‰ä»·å€¼çš„å­—ç¬¦--ç„¶åå‘ç°å…¶å®å°±æ˜¯å•çº¯çš„æŠŠæ•°å­—å¯¹åº”åˆ°9é”®é”®ç›˜ä¸Šå¾—åˆ°çš„å›¾æ¡ˆ.å…ˆå¡«å…¥H1I1,ä¸å¯¹;åé¢æƒ³åˆ°9é”®ä¸‹çš„å›¾æ¡ˆIä¹Ÿè®¸æ˜¯Z,å°è¯•<code>H1Z1</code>,è¿‡å…³.</p><h1 id="level-7">Level 7</h1><p>æ˜¾ç„¶è¿™ä¸€ä¸²å­—æ¯éƒ½æœ‰Yè½´æ–¹å‘çš„å¯¹ç§°è½´.å¡«å…¥<code>OTU</code>,è¿‡å…³.</p><h1 id="level-8">Level 8</h1><p>ç»™å‡ºäº†ä¸€ä¸ªé¢œæ–‡å­—è¯¢é—®"ä»–æ˜¯è°",æœç´¢å¾—åˆ°å¯¹åº”æ–‡å­—ä¸º"è¶…äººæ¥äº†".å¡«å…¥<code>superman</code>,è¿‡å…³.</p><h1 id="level-9">Level 9</h1><p>èƒŒæ™¯è‰²å˜æˆäº†è“è‰².ç›´æ¥æ£€æŸ¥å…ƒç´ å¾—åˆ°èƒŒæ™¯è‰²è‰²å·ä¸º#66CCFF,è¾“å…¥<code>66CCFF</code>,è¿‡å…³.</p><h1 id="level-10">Level 10</h1><p>å€’è¿‡æ¥å‘ç°è¦æ±‚æˆ‘ä»¬å»æ£€æŸ¥çŸ¥ä¹é¡µé¢çš„Console Log: <imgsrc="../assets/2023-05-12%2021.11.17.png" alt="çœ‹èµ·æ¥é•¿è¿™æ ·" />Hire,æŒ‰ç…§å€’åºå¡«å…¥,è¿‡å…³.</p><h1 id="level-11">Level 11</h1><p>ç»™å‡ºäº†ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€å¥è¯"è¶Šè¿‡é•¿åŸ,èµ°å‘ä¸–ç•Œ"--å¾—,è‚¯å®šæ˜¯è¦ç¿»å¢™çš„.Googleäº†ä¸‹è¿™ä¸ªå­—ç¬¦ä¸²,å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆæœ‰æ„ä¹‰çš„ç»“æœ(å‰é¢å¤§å¤šæ•°é¡µé¢éƒ½æ˜¯nazoæ”»ç•¥...)</p><p>æ²¡åŠæ³•,æ€»ä¸èƒ½ç‚¹è¿›æ”»ç•¥çœ‹å§,æç¤ºé‡Œè¯´"å…¨ä¸–ç•Œæœ€å¤§çš„xxç½‘ç«™",æ‰€ä»¥ç›®å…‰é”å®šäº†GitHub,YouTubeå’ŒPorn...(å¤§é›¾)</p><p>GitHubçš„URLæ²¡å•¥ä¸è¿™ä¸ªä¸²çš„ç›¸åŒç‚¹,ä½†æ˜¯YouTubeå°±ä¸åŒäº†,è§‚å¯Ÿä»¥ä¸‹èƒ½å‘ç°è¿™åº”è¯¥æ˜¯ä¸€ä¸ªè§†é¢‘çš„ID:<img src="../assets/2023-05-12%2021.20.05.png" /></p><p>å°†"v="åé¢çš„å­—æ®µæ›¿æ¢ä¸ºTKw4YRR17dgè®¿é—®åçœ‹åˆ°äº†ä¸€ä¸ªæ ‡é¢˜ä¸º"Nazo-Game:Fantastic"çš„è§†é¢‘,é‚£ä¹ˆç­”æ¡ˆåº”è¯¥å°±æ˜¯<code>Fantastic</code>äº†.è¾“å…¥,è¿‡å…³.</p><p>(è¿™ä¸ªè§†é¢‘è¿˜æ˜¯éå…¬å¼€çš„è§†é¢‘,ä½œè€…ä¸ºäº†é¿å…è¢«è½»æ˜“æ£€ç´¢åˆ°è¿˜æ˜¯æœ‰ç‚¹å°å¿ƒæ€çš„)</p><h1 id="level-12">Level 12</h1><p>(40.689241, -74.044515)è¿™ä¸ªé”®å€¼å¯¹ä¸€çœ‹å°±å¾ˆåƒç»çº¬åº¦.æ‰“å¼€GoogleMapè¾“å…¥,å®šä½åˆ°äº†è‡ªç”±å¥³ç¥åƒ...è¾“å…¥<code>statue_of_liberty</code>,è¿‡å…³.</p><h1 id="level-13">Level 13</h1><p>ä¸€æ®µæ–‡å­—ç¼©å†™,åŸå†…å®¹åº”è¯¥æ˜¯2 Levels Back BGM--ä¸¤å…³ä¹‹å‰,æ­£å¥½å°±æ˜¯Level11çš„é‚£ä¸ªè§†é¢‘.è¯„è®ºåŒºå‘ŠçŸ¥BGMåç§°ä¸º<code>longhorn</code>,è¾“å…¥,è¿‡å…³.</p><h1 id="level-14">Level 14</h1><p>JumpDollar,ä¹Ÿå°±æ˜¯<code>Jump $</code>,æç¤ºæ˜¯å››ä¸ªå­—æ¯ä¸”æ±‡ç¼–ç›¸å…³(å…¶å®ä¸æç¤ºä¹Ÿå¾ˆå®¹æ˜“æƒ³åˆ°æ˜¯æ±‡ç¼–).æ±‡ç¼–ä¸­$è¡¨ç¤ºPCæŒ‡å‘çš„åœ°å€,è·³è½¬åˆ°å½“å‰åœ°å€,æ˜æ˜¾æ„æŒ‡å¾ªç¯(loop).è¾“å…¥<code>loop</code>,è¿‡å…³.</p><h1 id="level-15">Level 15</h1><p>ç©ºç™½,æç¤ºä¹Ÿæ˜¯void.å°è¯•è¾“å…¥empty,nullç­‰å­—ä¸²å‡ä¸é€šè¿‡,æ— å¥ˆç»§ç»­æ‰“å¼€æ§åˆ¶å°æ£€æŸ¥å…ƒç´ .æ£€ç´¢å­—æ®µ<code>answer</code>,åœ¨<code>54f001c6bf2b13aa6cf4.js</code>è¿™ä¸ªè„šæœ¬ä¸­å‘ç°äº†è¿™ä¹ˆä¸€æ®µ:<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript"><span class="hljs-attr">mounted</span>: <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                    <span class="hljs-keyword">var</span> t = <span class="hljs-variable language_">this</span>,<br>                        e = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.content-slot&quot;</span>).<span class="hljs-title function_">getBoundingClientRect</span>().<span class="hljs-property">height</span>;<br>                    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">footerHeight</span> = e + <span class="hljs-number">120</span>, <span class="hljs-number">18</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">levelNum</span>)<br>                        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;keydown&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>                            <span class="hljs-number">90</span> == t.<span class="hljs-property">keyCode</span> &amp;&amp; t.<span class="hljs-property">ctrlKey</span> &amp;&amp; (<span class="hljs-variable language_">window</span>.<span class="hljs-property">location</span>.<span class="hljs-property">href</span> = <span class="hljs-string">&quot;./brainfuck&quot;</span>)<br>                        &#125;);<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">15</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">levelNum</span>)<br>                        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                            <span class="hljs-variable language_">document</span>.<span class="hljs-property">title</span> = <span class="hljs-string">&quot;answer: awesome&quot;</span><br>                        &#125;, <span class="hljs-number">3e3</span>);<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">4</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">levelNum</span>)<br>                        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;answer: level-five&quot;</span>);<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">22</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">levelNum</span>)<br>                        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>                            t.<span class="hljs-property">target</span>.<span class="hljs-property">innerWidth</span> &lt; <span class="hljs-number">320</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;TOBORRM&quot;</span> : <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;width: 320px;&quot;</span><br>                        &#125;);<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-number">25</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">levelNum</span>) &#123;<br>                        <span class="hljs-keyword">var</span> n = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span>;<br>                        <span class="hljs-variable language_">window</span>.<span class="hljs-property">innerWidth</span> &lt; <span class="hljs-number">950</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;ç­”é¢˜æ¡†è¢«ä½ æ— æƒ…çš„æŒ¤çˆ†äº†ã€‚è¯·åœ¨æ›´å¤§çš„å±å¹•ä¸Šè§‚çœ‹ã€‚&quot;</span> : <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span> = n,<br>                        <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&quot;resize&quot;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">t</span>) &#123;<br>                            t.<span class="hljs-property">target</span>.<span class="hljs-property">innerWidth</span> &lt; <span class="hljs-number">950</span> ? <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&quot;ç­”é¢˜æ¡†è¢«ä½ æ— æƒ…çš„æŒ¤çˆ†äº†ã€‚è¯·åœ¨æ›´å¤§çš„å±å¹•ä¸Šè§‚çœ‹ã€‚&quot;</span> : <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&quot;.question-text&quot;</span>).<span class="hljs-property">innerHTML</span> = n<br>                        &#125;)<br>                    &#125; <span class="hljs-keyword">else</span><br>                        <span class="hljs-number">48</span> === <span class="hljs-variable language_">this</span>.<span class="hljs-property">levelNum</span> &amp;&amp; (<span class="hljs-variable language_">this</span>.<span class="hljs-property">textArray</span>[<span class="hljs-number">0</span>] = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>), <span class="hljs-variable language_">window</span>.<span class="hljs-built_in">setInterval</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>                            t.<span class="hljs-property">textArray</span>[<span class="hljs-number">0</span>] = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>),<br>                            t.$forceUpdate()<br>                        &#125;, <span class="hljs-number">1e3</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">textArray</span>[<span class="hljs-number">1</span>] = <span class="hljs-string">&quot;ç©ºæ ¼ç”¨_ä»£æ›¿&quot;</span>)<br>                &#125;,<br></code></pre></td></tr></table></figure>ç°åœ¨å°±æ˜¯ç¬¬15å…³,é‚£ä¹ˆç­”æ¡ˆè‡ªç„¶å°±æ˜¯<code>awesome</code>äº†(è¿™é‡Œé¡ºä¾¿è¿˜å¾—åˆ°äº†å¦å¤–ä¸€äº›å…³å¡çš„ç­”æ¡ˆ...)</p><h1 id="level-16">Level 16</h1><p>çœ‹è¿‡<ç”Ÿæ´»å¤§çˆ†ç‚¸>çš„å¯¹è¿™ä¸ªé—®é¢˜åº”è¯¥èƒ½æ‰‹åˆ°æ“’æ¥,ä¸è¿‡è™½ç„¶æˆ‘æ²¡çœ‹è¿‡,ä½†æ˜¯æˆ‘åœ¨çŸ¥ä¹ä¸Šçœ‹åˆ°è¿‡ä¸€ç¯‡æ–‡ç« ä»‹ç»ä¸ºä»€ä¹ˆ73æ˜¯bestnumber,è¾“å…¥<code>number73</code>,è¿‡å…³~</p><p>é¡ºä¾¿é™„ä¸ŠçŸ¥ä¹ä¸Šçš„<ahref="https://www.zhihu.com/question/36276289/answer/553534541">è¿™ç¯‡å›ç­”</a>é¢,è¿™ä¸ªé—®é¢˜ä¼¼ä¹è¢«åˆ é™¤äº†,ä½†æ˜¯å›ç­”è¿˜èƒ½æœç´¢åˆ°...åœ¨çŸ¥ä¹æœç´¢Sheldonè´¨æ•°+Yifanå°±å¯ä»¥çœ‹åˆ°...</p><h1 id="level-17">Level 17</h1><p>é¢˜ç›®æ˜¯"å›åˆ°åŸç‚¹".è¿™ä¸ªåº”è¯¥æ˜¯50å…³é‡Œå›°æ‰°æˆ‘æ—¶é—´ç¬¬äºŒé•¿çš„ä¸€ä¸ªäº†(æœ€é•¿çš„æ˜¯Level28),åŸæœ¬ä»¥ä¸ºå›åˆ°åŸç‚¹æŒ‡çš„æ˜¯å›åˆ°ç¬¬ä¸€å…³,ä½†æ˜¯å¯¹ç€ç¬¬ä¸€å…³çš„å…ƒç´ å’Œé¡µé¢è„šæœ¬çœ‹äº†åŠä¸ªå°æ—¶ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆä¸œè¥¿,å°è¯•è¾“å…¥_start,main,entrypointç­‰"å…¥å£ç‚¹"ä¹Ÿä¸å¯¹,ä¹Ÿä¸æ˜¯æ•°å­¦ä¸­çš„å–æ¨¡,ç¯ç­‰å…·æœ‰å‘¨æœŸæ€§çš„å¯¹è±¡...ä¸€ç›´è¿™ä¹ˆå¡äº†ä¸€ä¸ªå°æ—¶å·¦å³,æ‘†å¼„æµè§ˆå™¨çš„èœå•æ æ—¶,çªç„¶çœ‹åˆ°"æ’¤é”€"æ“ä½œ,ç„¶åæƒ³åˆ°æ’¤é”€(Undo)ä¸æ˜¯ä¹Ÿå¯ä»¥"å›å»"å—,è¾“å…¥<code>Undo</code>,è¿‡å…³...</p><h1 id="level-18">Level 18</h1><p>è¿™ä¸€é¢˜æˆ‘å…¶å®æœ‰ç‚¹è·³å‘äº†.å› ä¸ºæˆ‘æ˜¯MacOSç”¨çš„Safariåšé¢˜,çœ‹åˆ°é¢˜ç›®åˆæ˜¯Undoå,è‡ªç„¶æƒ³åˆ°çš„æ˜¯Command+Zçš„å¿«æ·é”®,ç»“æœå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨...æ— å¥ˆåˆå›åˆ°Level15ä¸­è·å¾—çš„è„šæœ¬,å‘ç°æŒ‰ä¸‹<code>Control+Z</code>è€Œä¸æ˜¯<code>Command+Z</code>æ‰èƒ½åˆ°è¾¾Level19,å³./brainfuck(è§‚å¯Ÿä¸Šé¢æˆ‘ä»¬å¾—åˆ°çš„è„šæœ¬ä¹Ÿèƒ½çœ‹å‡ºç­”æ¡ˆ)</p><h1 id="level-19">Level 19</h1><p>é¢˜ç›®æ˜¯ä¸€ä¸²çœ‹ä¼¼æ— æ„ä¹‰çš„ç¬¦å·,å…¶å®æ˜¯URLé‡Œæç¤ºåˆ°çš„brainfuckè¿™ç§ç¼–ç¨‹è¯­è¨€.ç½‘ä¸Šæ‰¾äº†ä¸ªåœ¨çº¿ç¼–è¯‘è¿è¡Œç½‘ç«™,æ‹–è¿›å»å¾—åˆ°è¾“å‡ºç»“æœæ˜¯<code>she</code>.è¾“å…¥,è¿‡å…³.</p><h1 id="level-20">Level 20</h1><p>æå®¢å–œæ¬¢çš„ç©ç‰©ä¸”å’Œæ‰‹è¡¨ä¸€æ ·å¤§å°,çœ‹ç»™å‡ºçš„å›¾å½¢åº”è¯¥å°±æ˜¯æ‰‹è¡¨.ç®€å•æ£€ç´¢å¾—çŸ¥åº”ä¸ºMOTO360,è¾“å…¥<code>moto_360</code>,è¿‡å…³.</p><h1 id="level-21">Level 21</h1><p>é¢˜ç›®æè¿°è¯´ç»™å‡ºçš„æ˜¯8x8=64çš„ä¸€éƒ¨åˆ†,å›¾åƒæ˜¯2x3çš„é»‘ç™½äº¤é”™çš„æ£‹ç›˜.ä¸è¿‡ä¸çŸ¥é“ä¸ºå•¥,æˆ‘ç¬¬ä¸€ååº”æƒ³åˆ°äº†å·ç§¯æ»‘çª—,ç„¶åå¿ƒæƒ³8x8çš„å·ç§¯æ»‘çª—æ˜¯æœ‰ä»€ä¹ˆå¥‡æŠ€æ·«å·§å—...åæ¥æ„Ÿè§‰æ€è·¯åº”è¯¥æ˜¯èµ°åäº†,äºæ˜¯åœ¨æ‰“å¼€Bç«™æ„‰å¿«åœ°åˆ·è§†é¢‘(æ‘¸é±¼)çš„è¿‡ç¨‹ä¸­çœ‹åˆ°äº†çƒ‚æŸ¯æ¯,è¿›è€Œæƒ³åˆ°æ£‹ç›˜,è¿›è€Œæƒ³åˆ°é»‘ç™½æ£‹ç›˜åº”è¯¥æ˜¯å›½é™…è±¡æ£‹æ‰å¯¹.</p><p>2x3çš„æ£‹ç›˜æ­£å¥½æ˜¯é©¬çš„è¡Œèµ°èŒƒå›´,è¾“å…¥<code>Knight</code>(å›½é™…è±¡æ£‹ä¸­é©¬çš„åç§°),è¿‡å…³.</p><h1 id="level-22">Level 22</h1><p>çœ‹é¢˜ç›®æè¿°å¯ä»¥çŒœæµ‹å½“é¡µé¢å®½åº¦å°äº320pxæ—¶åº”è¯¥å°±ä¼šç»™å‡ºç­”æ¡ˆ.ç»§ç»­å›åˆ°Level15ä¸­çš„è„šæœ¬,å‘ç°ç­”æ¡ˆåº”è¯¥æ˜¯<code>TOBORRM</code>,è¾“å…¥,è¿‡å…³.</p><h1 id="level-23">Level 23</h1><p>é¢˜ç›®è¿˜æ˜¯ä¸€ä¸ªå›¾åƒ,ç›´æ¥ä»¥å›¾æœå›¾æ‰¾åˆ°ä¸€ä¸ªåä¸º<code>FSociety</code>çš„é»‘å®¢ç»„ç»‡,è¾“å…¥,è¿‡å…³.(è¿™é‡Œæœ€åˆæˆ‘ä»¥ä¸ºæ˜¯ã€ŠVå­—ä»‡æ€é˜Ÿã€‹é‡Œçš„ç»å…¸é¢å…·,ä½†æ˜¯åæ¥å‘ç°å…¶å®æœ‰æ‰€åŒºåˆ«...)</p><h1 id="level-24">Level 24</h1><p>ç”¨è¿‡abcjsè®°å½•ä¹è°±çš„åŒå­¦,æˆ–è€…ä»»ä½•ä¸€ä¸ªæœ‰ä¹ç†çŸ¥è¯†çš„åº”è¯¥éƒ½èƒ½å¾ˆå¿«æƒ³åˆ°è¿™ä¸ªä¸²å¯¹åº”çš„æ˜¯ä¸€æ®µéŸ³ä¹.ä¸è¿‡æˆ‘åœ¨AbletonLiveé‡Œè¯•ç€å†™äº†å†™æŒ‰abcjsè¯­æ³•å¾—åˆ°çš„ä¹å¥,å¹¶æ²¡æœ‰å¬å‡ºä»€ä¹ˆå¤´ç»ª...eefeè¿™ä¸ªå°äºŒåº¦çš„è¿›è¡Œæ€ä¹ˆå¬éƒ½å¯¹åº”ä¸ä¸Šæˆ‘è„‘å­ä¸­çš„ä»»ä½•ä¸€é¦–ä¹æ›².å¡äº†ä¸€é˜µå­ä¹‹åæƒ³åˆ°,å¦‚æœefç­‰å­—æ¯å¯¹åº”çš„å…¶å®ä¸æ˜¯éŸ³å,è€Œæ˜¯ç›¸å¯¹äºæŸä¸€ä¸ªæ ¹éŸ³çš„åç§»é‡å‘¢?</p><p>æ”¹å†™ä¸º556517-&gt;556587(å¤§å†™A,æš—ç¤ºçš„å¯èƒ½æ˜¯è·¨ä¸€ä¸ªå…«åº¦,æ‰€ä»¥1+7=8),è¯•ç€å¬äº†ä¸‹,è¿™ä¸å°±æ˜¯ç”Ÿæ—¥æ­Œå—...8ä¸ªå­—æ¯,<code>birthday</code>,è¾“å…¥,è¿‡å…³.</p><h1 id="level-25">Level 25</h1><p>å¾ˆé•¿çš„ä¸€æ®µé¢œæ–‡å­—,ç›´æ¥Googleå‘ç°æ˜¯ä¸€ç§åä¸ºAAencodeçš„åŠ å¯†æ–¹æ¡ˆ,è§£ç åå¾—åˆ°console.log('encode').è¾“å…¥<code>encode</code>,è¿‡å…³.</p><h1 id="level-26">Level 26</h1><p>ä¸€ä¸²æ•°å­—+ç©ºæ ¼,è¿˜æç¤º10 yearsago,ç›´æ¥è€ƒè™‘æ˜¯9é”®è¾“å…¥æ³•,æŒ‰9é”®è¾“å…¥åå¾—åˆ°<code>feelings</code>,è¾“å…¥,è¿‡å…³.</p><h1 id="level-27">Level 27</h1><p>8ä¸ªäºŒè¿›åˆ¶æ•°å­—,æ¯ä¸ªé•¿åº¦éƒ½ä¸º8,è§‚å¯Ÿäº†ä¸€ä¸‹æ„Ÿè§‰ä¸æ˜¯å¸¸è§çš„ç¼–ç ,æ‰€ä»¥è¿˜æ˜¯æƒ³åˆ°äº†8x8çš„å·ç§¯æ»‘çª—(æˆ‘æ˜¯å¯¹å·ç§¯é€ äº†ä»€ä¹ˆå­½...)</p><p>ä½†æ˜¯æ²¡æœ‰å¯ä¾›è¾“å…¥çš„çŸ©é˜µ,é‚£ä¹ˆè‚¯å®šæ˜¯è·Ÿå·ç§¯æ»‘çª—æ²¡å•¥å…³ç³»äº†,äºæ˜¯åˆæƒ³åˆ°ç±»ä¼¼çš„ç‚¹ç¯æ¸¸æˆ,è¯•ç€æŠŠ1å¯¹åº”çš„åœ°æ–¹æ¶‚é»‘:<img src="../assets/2023-05-12%2022.45.47.png" width = "190" height = "200" alt="åƒè±†äºº"/></p><p>ç„¶åå‘ç°åŸæ¥æ˜¯åƒè±†äººæ¸¸æˆ(Pac-man)çš„å›¾æ¡ˆ.è¾“å…¥<code>Pac-man</code>,è¿‡å…³.</p><h1 id="level-28">Level 28</h1><p>è¯´å®è¯æˆ‘æ˜¯è§‰å¾—è¿™ä¸€é¢˜å‡ºçš„å¹¶ä¸æ€ä¹ˆå¥½,è¿™ä¹Ÿæ˜¯æˆ‘è€—æ—¶æœ€é•¿çš„ä¸€é“é¢˜äº†.é¢˜ç›®æ˜¯å¾ˆå•çº¯çš„ä¸€ä¸ªä¸²:<img src="../assets/2023-05-12%2022.31.52.png"alt="è°èƒ½å‘Šè¯‰æˆ‘DHCæ˜¯ä¸ªå•¥" /></p><p>ä½†æ˜¯ä½¿ç”¨ä¸åŒçš„æœç´¢å¼•æ“/ä¸åŒçš„IPå±åœ°æœç´¢,å¾—åˆ°çš„ç»“æœæ˜¾ç„¶æ˜¯ä¸åŒçš„,DHCæœ¬èº«ä¹Ÿæœ‰å¤šç§æ„æ€...</p><p>æ€»ä¹‹,é¢˜ç›®è¦æ±‚çš„é¢„æœŸç­”æ¡ˆæ˜¯DHCè¿™ä¸€æ—¥æœ¬åŒ–å¦†å“å“ç‰Œçš„ä¸­æ–‡å®˜ç½‘é‡Œæä¾›çš„ä¸€ä¸ªç”µè¯å·ç ,æ˜¯<code>4008208820</code>.</p><h1 id="level-29">Level 29</h1><p>x+=2,ä½†æ˜¯æ²¡æœ‰æŒ‡æ˜è°æ˜¯x,å°è¯•31(29+2)ä¸è¡Œåæœæ–­å°è¯•<code>4008208822</code>(4008208820+2),è¿‡å…³.</p><h1 id="level-30">Level 30</h1><p>5B88 671B 5148950B,ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯4ä¸ª16è¿›åˆ¶æ•°å­—,ä½†æ˜¯æƒ³æ¥æƒ³å»è·Ÿæç¤ºä¸­çš„"èƒŒæ™¯å¹¶éçº¯ç™½"æ²¡å•¥è”ç³»,è½¬è€Œå°è¯•ç›´æ¥è§£ç .äº‹å®ä¸Šè¿™æ˜¯Unicodeç¼–ç ,å¯¹åº”çš„æ±‰å­—æ˜¯"å®ˆæœ›å…ˆé”‹".è¾“å…¥è‹±æ–‡å<code>overwatch</code>,è¿‡å…³.</p><p>(overwatchæ˜¯å–å­—é¢æ„æ€"è¿‡åº¦watch",æ‰€ä»¥æ‰ä¼šæç¤ºèƒŒæ™¯ä¸æ˜¯çº¯ç™½å—...)</p><h1 id="level-31">Level 31</h1><p>"ç¬¬ä¸€åªä¸­å›½ä¼é¹…çš„æ˜µç§°",æ£€ç´¢äº†ä¸€ä¸‹æ²¡æ‰¾åˆ°ä»€ä¹ˆæœ‰æ•ˆä¿¡æ¯.åæ¥æƒ³åˆ°ä¼é¹…ææ€•æ˜¯QQçš„çˆ±ç§°(QQçš„å›¾æ ‡å°±æ˜¯ä¼é¹…å˜›...),å°è¯•QQ/OICQ/I-seek-youç­‰å‡æ— æœ,æœ€ç»ˆå‘ç°é¢„æœŸè§£ç­”å…¶å®æ˜¯é©¬åŒ–è…¾çš„è‹±æ–‡å--<code>PONY</code>...</p><h1 id="level-32">Level 32</h1><p>é¢˜ç›®ç»™çš„æç¤ºå¾ˆæ˜æ˜¾,ç»´å‰å°¼äºšå¯†ç .ç›´æ¥æ‰¾åˆ°åœ¨çº¿è§£å¯†å·¥å…·å¾—åˆ°ç­”æ¡ˆæ˜¯<code>ANDRIOD</code>,è¾“å…¥,è¿‡å…³.</p><h1 id="level-33">Level 33</h1><p>Fix it,é‚£è‡ªç„¶æ˜¯æŠŠANDRIODæ”¹æˆæ­£ç¡®çš„æ‹¼å†™<code>Android</code>å’¯~</p><h1 id="level-34">Level 34</h1><p>ä¸€ä¸ªå›¾ç‰‡,é¢˜ç›®å‘ŠçŸ¥æç¤ºå›¾æœ‰å¹²æ‰°.æ‹¿åˆ°å›¾ç‰‡åçœ‹äº†çœ‹ä¿¡æ¯,å‘ç°æ˜¯ä½¿ç”¨PhotoShopåˆ›å»ºçš„,é‚£å°±æ‹–è¿›PSé‡Œæ“ä½œå˜›...</p><p>å»æ‰èƒŒæ™¯,ä½†æ˜¯é©¬èµ›å…‹å»ä¸æ‰,ç»§ç»­ä»¥å›¾æœå›¾,å¾—åˆ°: <imgsrc="../assets/1569843-20200621192504503-66474261.png" />é‚£å°±æ˜¯<code>ljn</code>.è¾“å…¥,è¿‡å…³.</p><h1 id="level-35">Level 35</h1><p>é¢˜ç›®è¦æ±‚"Find yourself on theInternet",è¿™ä¸ªè‡ªå·±è‚¯å®šæ˜¯ä¸éšåšé¢˜äººèº«ä»½å˜åŒ–çš„æŠ½è±¡çš„"è‡ªå·±".ç½‘ç»œä¸Šçš„è‡ªå·±çš„åœ°å€ä¸å°±æ˜¯<code>localhost</code>å˜›,è¾“å…¥,è¿‡å…³.</p><h1 id="level-36">Level 36</h1><p>Markus Alexej Persson'sdeath,ä¸æ‡‚,æ±‚åŠ©WikipediaçŸ¥é“æ˜¯ä¸ªæ¸¸æˆå½©è›‹,é¡¶ç€è¿™ä¸ªæ˜µç§°è¿›Minecraftå¦‚æœæ­»äº†ä¼šæ‰è½è‹¹æœ.è¾“å…¥<code>apple</code>,è¿‡å…³.</p><h1 id="level-37">Level 37</h1><p>ç›´æ¥æŠŠè¿™ä¸€ç³»åˆ—è¯æ±‡ç¿»è¯‘åæ‹¼æ¥èµ·æ¥,è¾“å…¥<code>supercalifragilisticexpialidocious</code>,è¿‡å…³.åæ¥æ£€ç´¢å¾—çŸ¥ã€Šsupercalifragilisticexpialidociousã€‹å…¶å®æ˜¯ä¸€é¦–<ahref="https://en.wikipedia.org/wiki/Supercalifragilisticexpialidocious">ç”µå½±æ’æ›²</a></p><h1 id="level-38">Level 38</h1><p>ç»å…¸Miscæ‰‹æ®µ.å›¾ç‰‡æ˜¯å‹ç¼©æ–‡ä»¶å›¾æ ‡,ä½†æ˜¯è¾“å…¥å‡ ä¸ªå¸¸ç”¨çš„å‹ç¼©è½¯ä»¶åéƒ½æ— æ³•é€šè¿‡,é‚£å°±ç›´æ¥æŠŠå›¾ç‰‡ä¸‹è½½ç„¶åè§£å‹~</p><p>å¾—åˆ°answer.txt,ä½†æ˜¯å†…å®¹å´æ˜¯åŒæ ·çš„'http://nazo.one-story.cn/supercalifragilisticexpialidocious.html',äºæ˜¯æƒ³åˆ°è¿™åº”è¯¥æ˜¯é€’å½’(<code>recursion</code>),è¾“å…¥,è¿‡å…³.</p><h1 id="level-39">Level 39</h1><p>ç»å…¸çš„ä¸€ä¸ªæ¼«ç”»äººè„¸,æœç´¢å¯çŸ¥å«<code>trollface</code>.è¾“å…¥è¿‡å…³.</p><h1 id="level-40">Level 40</h1><p>é¢˜ç›®æ˜¯ä¸€ä¸ª3è¡Œçš„åå­—å½¢æ•°è¡¨,ä½†æ˜¯å¹¶æ²¡æœ‰è§‚å¯Ÿå‡ºä»€ä¹ˆæ¯”è¾ƒæ˜¾ç„¶çš„æ•°å­—è§„å¾‹.ä¸è¿‡å¥½åœ¨æˆ‘å¯¹35è¿™ä¸ªæ•°å­—æ¯”è¾ƒæ•æ„Ÿ,è¿‡äº†ä¸€å°ä¼šå„¿æƒ³åˆ°è¿™åº”è¯¥æ˜¯å…ƒç´ å‘¨æœŸè¡¨ä¸­VIIæ—å…ƒç´ é‚£ä¸€åˆ—,é‚£ä¹ˆé—®å·å¤„å°±æ˜¯æ°¯å…ƒç´ (<code>Chlorine</code>),è¾“å…¥,è¿‡å…³.</p><h1 id="level-41">Level 41</h1><p>Google x Huawei,æœç´¢å¯çŸ¥ä¸¤è€…åˆä½œè¿‡Nexus6P.è¾“å…¥<code>Nexus_6P</code>,è¿‡å…³.</p><h1 id="level-42">Level 42</h1><p>é¢˜ç›®è¦æ±‚é‡å¤ã€Œfd 30 lt 60 fd 40 rt150ã€äº”æ¬¡,åº”è¯¥æ˜¯æŸç§æŒ‡ä»¤.æœç´¢å¾—çŸ¥æ˜¯ä¸€ç§ç”¨æ¥ç”»å›¾çš„è¯­è¨€,åä¸º<ahref="https://www.transum.org/software/Logo/">Logo</a></p><p>åœ¨Level 1ä¸‹ç”»äº†ç”»æ²¡å•¥å‘ç°,ç›´æ¥æ¢åˆ°Level 3,ç”»å‡ºæ¥é•¿è¿™æ ·: <imgsrc="../assets/2023-05-12%2023.21.42.png" /></p><p>ä½†æ˜¯è¾“å…¥å››è§’æ˜Ÿçš„å„ç§åç§°éƒ½ä¸å¯¹,åæ¥çœ‹åˆ°å››è§’æ˜Ÿçš„ä¸€ä¸ªåˆ«ç§°æ˜¯å¿è€…(ninja)é•–,å†ç»“åˆç”»å›¾ç½‘ç«™é‡Œçš„æµ·é¾Ÿå›¾æ¡ˆ,æƒ³åˆ°ä¼šä¸ä¼šæ˜¯å¿è€…ç¥é¾Ÿ?è¾“å…¥<code>ninja_turtle</code>,è¿‡å…³.</p><h1 id="level-43">Level 43</h1><p>ä¸€å¼ çº¯é»‘å›¾ç‰‡,çŒœåˆ°è‚¯å®šå…¶ä¸­æš—è—ç„æœº.ä¸‹è½½åˆ°æœ¬åœ°ä¸€é€šæ“ä½œè°ƒæ•´å¯¹æ¯”åº¦å’Œäº®åº¦:</p><p><img src="../assets/2023-05-13%2000.26.24.png" /></p><p>å‘ç°ç­”æ¡ˆæ˜¯<code>Dee.html</code>.è¾“å…¥,è¿‡å…³.</p><h1 id="level-44">Level 44</h1><p>ç›´æ¥æœå›¾æ— æœ,è§‚å¯Ÿå‘ç°é¢˜ç›®åº”è¯¥æ˜¯äº”å¼ å°æ——å­æ‹¼èµ·æ¥çš„,å•ä¸ªæœç´¢å‘ç°æ˜¯<ahref="https://zh.wikipedia.org/wiki/åœ‹éš›ä¿¡è™Ÿæ——">å›½é™…æµ·äº‹ä¿¡å·æ——</a>.å¯¹åº”çš„å­—ç¬¦ä¸²æ˜¯<code>poker</code>,è¾“å…¥è¿‡å…³.</p><h1 id="level-45">Level 45</h1><p>çœ‹èµ·æ¥åº”è¯¥æ˜¯æŸç§ç‰¹æ®Šçš„å­—æ¯ä¹¦å†™æ–¹å¼,Googleäº†ä¸‹å‘ç°æ˜¯<ahref="https://zh.wikipedia.org/zh-hans/Leet">Leet</a></p><p>é¢˜ç›®å¯¹åº”çš„æ–‡å­—æ˜¯: <figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ada">This <span class="hljs-keyword">is</span> an example <span class="hljs-keyword">of</span> leet <span class="hljs-keyword">at</span> its finest<br>The answer <span class="hljs-keyword">is</span> : <span class="hljs-type">sigma</span><br></code></pre></td></tr></table></figure> è¾“å…¥<code>sigma</code>,è¿‡å…³.</p><h1 id="level-46">Level 46</h1><p>è¿˜æ˜¯å›¾ç‰‡,ä»¥å›¾æœå›¾å¾—åˆ°<code>sanic</code>,è¾“å…¥è¿‡å…³.</p><p>æŒ‰æ£€ç´¢ç»“æœæ¥çœ‹å›¾ç‰‡é‡Œçš„æ˜¯åŠ¨æ¼«äººç‰©Sonic,è¢«ç§°ä¸ºSanicæˆ–è®¸æ˜¯ä¸ªæ¢—?ä¸è¿‡æˆ‘ä¸æ„Ÿå…´è¶£,å§‘ä¸”å°±æ²¡ç»†çœ‹.</p><h1 id="level-47">Level 47</h1><p>è¿˜æ˜¯å›¾ç‰‡,ç»§ç»­æœå›¾...</p><p>æœå›¾ç»“æœå‘Šè¯‰æˆ‘è¿™æ˜¯Excel 2000çš„ä¸€ä¸ªå½©è›‹,æŒ‰æ£€ç´¢ç»“æœæ‰€è¿°,ä½ åªéœ€:</p><ol type="1"><li><p>æ‰“å¼€ä¸€ä¸ªExcelæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶é€‰é¡¹ä¸­ç‚¹å‡»å¦å­˜ä¸ºç½‘é¡µ</p></li><li><p>åœ¨å¼¹å‡ºçš„ä¿å­˜å¯¹è¯æ¡†ä¸­å‹¾é€‰â€œæ·»åŠ äº¤äº’â€ï¼Œç‚¹å‡»ä¿å­˜</p></li><li><p>åŒå‡»æ‰“å¼€ä¿å­˜çš„ç½‘é¡µï¼Œå°†åæ ‡å®šä½åˆ° (2000,WC) ï¼Œé€‰ä¸­ç¬¬ 2000è¡Œï¼Œå¹¶æŒ‰<code>Tab</code>é”®ï¼Œå°†<code>WC</code>åˆ—å˜ä¸ºå½“å‰çš„æ´»åŠ¨åˆ—</p></li><li><p>åŒæ—¶æŒ‰ä½<code>Shift</code>,<code>ğ¶ğ‘¡ğ‘Ÿğ‘™</code>å’Œ<code>Alt</code>é”®ï¼Œå•å‡»Excelå·¥ä½œç°¿å·¦ä¸Šè§’çš„Officeæ ‡å¿—</p></li></ol><p>è¿™æ ·å°±è¿›å…¥äº†é¢˜ç›®ä¸­çš„èµ›è½¦æ¸¸æˆ.é‚£ä¹ˆåæ ‡å€¼å°±æ˜¯(2000,WC),è¾“å…¥<code>2000WC</code>,è¿‡å…³.</p><h1 id="level-48">Level 48</h1><p>ä¸€ä¸²æ•°å­—,çœ‹èµ·æ¥æ¯è¿‡1séƒ½ä¼šåŠ 1000,è‡ªç„¶æƒ³åˆ°<ahref="https://zh.wikipedia.org/wiki/UNIXæ—¶é—´">è¿™ä¸ªç©æ„å„¿</a>.å°è¯•å‡ æ¬¡åå‘ç°é¢„æœŸç­”æ¡ˆä¸ºæ—¶é—´æˆ³(<code>time_stamp</code>),è¾“å…¥,è¿‡å…³.</p><h1 id="level-49">Level 49</h1><p>ä¸€å¼ å›¾ç‰‡,Gitçš„å›¾æ ‡,å®¹æ˜“æƒ³åˆ°åº”è¯¥å’ŒLevel 38æ˜¯ç±»ä¼¼çš„éšå†™æ‰‹æ®µ.</p><p>è§£å‹åå¾—åˆ°ä¸€ä¸ªGitä»“åº“,å­˜æ”¾çš„answer.txté‡Œæ˜¾ç¤º<code>this is not a real answer</code>.gitè¿›è¿™ä¸ªä»“åº“æŸ¥è¯¢æ—¥å¿—,å‘ç°ä¸€å…±æäº¤è¿‡ä¸‰æ¬¡<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">branch</span><br><br><span class="hljs-attribute">answer</span>.txt | <span class="hljs-number">2</span> +-<br><span class="hljs-attribute">1</span> file changed, <span class="hljs-number">1</span> insertion(+), <span class="hljs-number">1</span> deletion(-)<br><br><span class="hljs-attribute">commit</span> <span class="hljs-number">09</span>d0e4c0cfc5d75c2f49b51928b241b9b9cda53d (master)<br><span class="hljs-attribute">Author</span>: Dieber &lt;<span class="hljs-number">451120068</span>@qq.com&gt;<br><span class="hljs-attribute">Date</span>: Fri Jul <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">46</span>:<span class="hljs-number">32</span> <span class="hljs-number">2018</span> +<span class="hljs-number">0800</span><br><br><span class="hljs-attribute">cover</span><br><br><span class="hljs-attribute">answer</span>.txt | <span class="hljs-number">2</span> +-<br><span class="hljs-attribute">1</span> file changed, <span class="hljs-number">1</span> insertion(+), <span class="hljs-number">1</span> deletion(-)<br><br><span class="hljs-attribute">commit</span> b91dbf1a5cd95e4ad2e7842991cb1c8773f78d41<br><span class="hljs-attribute">Author</span>: Dieber &lt;<span class="hljs-number">451120068</span>@qq.com&gt;<br><span class="hljs-attribute">Date</span>: Fri Jul <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">45</span>:<span class="hljs-number">52</span> <span class="hljs-number">2018</span> +<span class="hljs-number">0800</span><br><br><span class="hljs-attribute">first</span> commit<br><br><span class="hljs-attribute">answer</span>.txt | <span class="hljs-number">1</span> +<br><span class="hljs-attribute">1</span> file changed, <span class="hljs-number">1</span> insertion(+)<br></code></pre></td></tr></table></figure> é€æ¬¡å›æ»š,æœ€ç»ˆåœ¨firstcommitä¸­å‘ç°answer.txtä¸­çš„å†…å®¹ç»™å‡ºäº†æˆ‘ä»¬è¦çš„ç­”æ¡ˆ<code>answer:gitisawesome</code>.è¾“å…¥<code>gitisawesome</code>,è¿‡å…³~</p><h1 id="level-50">Level 50</h1><p>ï¼javascript'sauthor,æç¤ºè¯´æ˜åº”è¯¥æ˜¯è·Ÿä¸€é¦–æ­Œæœ‰å…³çš„.åœ¨å„ä¸ªå¹³å°æœç´¢äº†ä¸€éJavaScript,ç»“æœå¾—åˆ°çš„æ­Œæ‰‹åéƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆ...åæ¥å‘ç°æˆ‘åº”è¯¥æœç´¢/JavaScriptæ‰å¯¹...</p><p>ç½‘æ˜“äº‘å‘Šè¯‰æˆ‘ç­”æ¡ˆæ˜¯<code>W1-2</code>,è¾“å…¥,æå®š~</p><h1 id="æ—…ç¨‹æ„Ÿæƒ³">æ—…ç¨‹æ„Ÿæƒ³</h1><p>æ€»ä½“ä¸Šæ¥è¯´éš¾åº¦æœ‰ä½†æ˜¯ä¸é«˜,æœ‰äº›é¢˜ç›®è·ŸCTFé‡Œçš„Miscé¢˜ç›®æ€è·¯è¿˜æ˜¯æœ‰äº’é€šä¹‹å¤„çš„,å½“åšç¡å‰å°æ¸¸æˆè¿˜æ˜¯è›®ä¸é”™çš„.</p><p>(è™½ç„¶è¿˜æ˜¯è€—è´¹äº†æˆ‘4ä¸ªå°æ—¶çš„æ—¶é—´...)</p><p>å®Œç»“æ’’èŠ±~</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
      <category>æŠ€æœ¯</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è§£è°œ</tag>
      
      <tag>Game</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æ–¹æ³•-æ•°å€¼ç§¯åˆ†</title>
    <link href="/%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86.html"/>
    <url>/%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-%E6%95%B0%E5%80%BC%E7%A7%AF%E5%88%86.html</url>
    
    <content type="html"><![CDATA[<h2 id="é—®é¢˜å®šä¹‰">é—®é¢˜å®šä¹‰</h2><p>æ±‚ <spanclass="math inline">\(I(f)=\int_a^bf(x)\mathrm{d}x\)</span>ï¼Œä½†æ˜¯ <spanclass="math inline">\(f(x)\)</span> çš„åŸå‡½æ•°å¾ˆéš¾æ±‚ã€<spanclass="math inline">\(f(x)\)</span>æœªæ˜ç¡®ç»™å‡ºï¼ˆå¯èƒ½åªæ˜¯ä¸€å¼ ç¦»æ•£çš„æ•°è¡¨ï¼‰ï¼ŒåŒæ—¶å¯¹è®¡ç®—ç²¾åº¦æ²¡æœ‰è¿‡é«˜çš„è¦æ±‚ã€‚</p><h2 id="æœºæ¢°æ±‚ç§¯å…¬å¼">æœºæ¢°æ±‚ç§¯å…¬å¼</h2><p>å°è¯•ç”¨ç»™å®šçš„ä¸€ç³»åˆ—èŠ‚ç‚¹çš„å‡½æ•°å€¼ <span class="math inline">\(f(x_0),f(x_1), \cdots\)</span> æ¥çº¿æ€§ç»„åˆå‡ºç§¯åˆ†çš„è¿‘ä¼¼å€¼ï¼Œå³</p><p><span class="math display">\[Q(f)=\sum_{j=0}^nf(x_j)H_j\]</span></p><p>å…¶ä¸­ï¼Œ<span class="math inline">\(x_i(i=0, 1, \cdots, n)\)</span>æ˜¯ç»™å‡ºå‡½æ•°å€¼çš„ <span class="math inline">\((n+1)\)</span> ä¸ªèŠ‚ç‚¹ï¼Œ<spanclass="math inline">\(H_j\)</span> æ˜¯ä¸å‰é¢é‚£ <spanclass="math inline">\((n+1)\)</span> ä¸ªèŠ‚ç‚¹æœ‰å…³ï¼Œè€Œä¸ <spanclass="math inline">\(f(x)\)</span>æœ¬èº«æ— å…³çš„ä¸€ç³»åˆ—ç³»æ•°ã€‚æ˜¾ç„¶ï¼Œæœºæ¢°æ±‚ç§¯å…¬å¼çš„å…³é”®æ˜¯ä»ç»™å‡ºçš„ <spanclass="math inline">\(x_i\)</span> ç¡®å®š <spanclass="math inline">\(H_j\)</span>ã€‚</p><h3 id="ä»£æ•°ç²¾åº¦">ä»£æ•°ç²¾åº¦</h3><p>å¦‚æœä¸€ä¸ªæœºæ¢°æ±‚ç§¯å…¬å¼ï¼Œå®ƒç”¨åœ¨æ‰€æœ‰ä¸è¶…è¿‡ <spanclass="math inline">\(r\)</span> æ¬¡çš„å¤šé¡¹å¼ï¼ˆå³ <spanclass="math inline">\(f(x)\)</span> æ˜¯ä¸è¶…è¿‡ <spanclass="math inline">\(r\)</span> æ¬¡çš„å¤šé¡¹å¼ï¼‰ä¸Šæ—¶èƒ½ç²¾ç¡®æˆç«‹ï¼Œè€Œå¯¹äº<span class="math inline">\((r+1)\)</span>æ¬¡å¤šé¡¹å¼è‡³å°‘æœ‰ä¸€ä¸ªä¸èƒ½ç²¾ç¡®æˆç«‹ï¼Œç§°è¿™ä¸ªæ±‚ç§¯å…¬å¼æœ‰ <spanclass="math inline">\(r\)</span> æ¬¡ä»£æ•°ç²¾åº¦ã€‚</p><p>ä¾‹å¦‚ï¼Œæ¢¯å½¢å…¬å¼ <spanclass="math inline">\(I_1(f)=\frac{b-a}{2}(f(a)+f(b))\)</span> æœ‰ 1æ¬¡ä»£æ•°ç²¾åº¦ï¼š</p><ul><li><span class="math inline">\(f(x)=1\)</span> æ—¶ï¼Œç²¾ç¡®æˆç«‹ã€‚</li><li><span class="math inline">\(f(x)=x\)</span> æ—¶ï¼Œ<spanclass="math inline">\(\int_a^bx\mathrm{d}x=\frac{b^2-a^2}{2}=\frac{b-a}{2}(b+a)\)</span>ï¼Œç²¾ç¡®æˆç«‹ã€‚</li><li><span class="math inline">\(f(x)=x^2\)</span> æ—¶ï¼Œä¸ç²¾ç¡®æˆç«‹ã€‚</li></ul><h3 id="æ’å€¼å‹æ±‚ç§¯å…¬å¼">æ’å€¼å‹æ±‚ç§¯å…¬å¼</h3><p>å°† <span class="math inline">\(f(x)\)</span> åœ¨ <spanclass="math inline">\(x_0, x_1, \cdots, x_n\)</span> å¤„ Lagrangeæ’å€¼ï¼Œå¾—åˆ° <spanclass="math inline">\(L_n(x)=\sum_{j=0}^nl_j(x)f(x_j)\)</span>ï¼Œå–</p><p><span class="math display">\[H_j=\int\limits_a^bl_j(x)\mathrm{d}x\]</span></p><p>æ¥ä½œä¸ºæœºæ¢°æ±‚ç§¯å…¬å¼çš„ç³»æ•°ï¼Œå¯ä»¥è¯æ˜è¿™ä¸ªå…¬å¼è‡³å°‘æœ‰ <spanclass="math inline">\(n\)</span>æ¬¡ä»£æ•°ç²¾åº¦ã€‚äº‹å®ä¸Šï¼Œå¦‚æœä¸€ä¸ªæœºæ¢°æ±‚ç§¯å…¬å¼æœ‰ <spanclass="math inline">\(n\)</span>æ¬¡åŠä»¥ä¸Šçš„ä»£æ•°ç²¾åº¦ï¼Œå®ƒå¿…ç„¶æ˜¯æ’å€¼å‹çš„ã€‚</p><h2 id="ç­‰è·èŠ‚ç‚¹çš„-newton-cotes-å…¬å¼">ç­‰è·èŠ‚ç‚¹çš„ Newton-Cotes å…¬å¼</h2><p>å½“æ±‚ç§¯èŠ‚ç‚¹ç­‰è·æ—¶ï¼Œå°†åŒºé—´ <span class="math inline">\([a, b]\)</span>åˆ†æˆ <span class="math inline">\(n\)</span> ç­‰åˆ†ï¼Œè®° <spanclass="math inline">\(x_0=a\)</span>ï¼Œ<spanclass="math inline">\(x_i=a+ih\)</span>ï¼Œ<spanclass="math inline">\(i=0, 1, \cdots, n\)</span>ã€‚</p><p>è®° <span class="math inline">\(x=a+th\)</span>ï¼Œåˆ™</p><p><span class="math display">\[\begin{aligned}H_j &amp;= \int\limits_a^bl_j(x)\mathrm{d}x \\&amp;= \int\limits_a^b\prod_{i=0,i\neqj}^n\frac{(x-x_i)}{(x_j-x_i)}\mathrm{d}x \\&amp;= \int\limits_a^b\prod_{i=0, i\neqj}^n\frac{t-i}{j-i}\mathrm{d}(a+th) \\&amp;= \frac{(-1)^{n-j}h}{j!(n-j)!}\int\limits_a^b\prod_{i=0, i\neqj}^n(t-i)\mathrm{d}t\end{aligned}\]</span></p><p>å› ä¸º <span class="math inline">\(b-a=nh\)</span>ï¼Œå°†ä¸Šå¼é™¤ä»¥ <spanclass="math inline">\((b-a)\)</span>ï¼Œå¾—åˆ°</p><p><span class="math display">\[C_j=\frac{H_j}{b-a}=\frac{(-1)^{n-j}}{nj!(n-j)!}\int\limits_a^b\prod_{i=0,i\neq j}^n(t-i)\mathrm{d}t\]</span></p><p>ç§°ä¹‹ä¸ºã€ŒCotes ç³»æ•°ã€ã€‚ç”±æ­¤å¯ä»¥å¾—åˆ°ç­‰è·èŠ‚ç‚¹çš„ Newton-Cotes å…¬å¼ï¼š</p><p><span class="math display">\[Q_n(f)=(b-a)\sum_{j=0}^nC_jf(x_j)\]</span></p><h3 id="ç‰¹æ®Šæƒ…å†µ">ç‰¹æ®Šæƒ…å†µ</h3><ul><li><p>æ¢¯å½¢å…¬å¼ï¼š<span class="math inline">\(n=1, x_0=a,x_1=b\)</span>ï¼Œ</p><p><span class="math display">\[  Q_1(f)=\frac{b-a}{2}(f(a)+f(b))  \]</span></p></li><li><p>Simpson å…¬å¼ï¼ˆæŠ›ç‰©çº¿å…¬å¼ï¼‰ï¼š<span class="math inline">\(n=2,x_0=a, x_2=b, x_1=\frac{a+b}{2}\)</span>ï¼Œ</p><p><span class="math display">\[  Q_2(f)=\frac{b-a}{6}(f(a)+4f(\frac{a+b}{2})+f(b))  \]</span></p></li><li><p>Cotes å…¬å¼ï¼š<span class="math inline">\(n=4\)</span>ï¼Œ</p><p><span class="math display">\[  Q_4(f)=\frac{2h}{45}(7f(a)+32f(a+h)+12f(a+2h)+32f(a+3h)+7f(b))  \]</span></p></li></ul><h3 id="æ”¶æ•›æ€§">æ”¶æ•›æ€§</h3><p><strong>Newton-Cotes å…¬å¼å¹¶ä¸æ€»æ˜¯æ”¶æ•›äºç§¯åˆ†çš„çœŸå€¼ã€‚</strong></p><h3 id="æ•°å€¼ç¨³å®šæ€§">æ•°å€¼ç¨³å®šæ€§</h3><p>è®¾ <span class="math inline">\(f(x_i)\)</span> çš„è®¡ç®—å€¼ä¸º <spanclass="math inline">\(\tilde{f}(x_i)\)</span>ï¼Œä¸” <spanclass="math inline">\(|f(x_i)-\tilde{f}(x_i)|\leqslant\varepsilon\)</span>ï¼Œåˆ™</p><p><span class="math display">\[|\sum_{j=0}^nH_jf(x_j)-\sum_{j=0}^nH_j\tilde{f}(x_j)|=|\sum_{j=0}^nH_j(f(x_j)-\tilde{f}(x_j))|\leqslant\varepsilon\sum_{j=0}^n|H_j|\]</span></p><ul><li><p>å¦‚æœ <span class="math inline">\(H_j\)</span> å…¨æ˜¯æ­£æ•°ï¼Œæœ‰ <spanclass="math inline">\(|H_j|=H_j\)</span>ï¼Œé‚£ä¹ˆ</p><p><span class="math display">\[  \varepsilon\sum_{j=0}^n|H_j|=\varepsilon\sum_{j=0}^nH_j=(b-a)\varepsilon  \]</span></p><p>è¿™ä¸ªè¯¯å·®ä¸ä¼šå› ä¸º <span class="math inline">\(n\)</span>çš„å¢å¤§è€Œå¢å¤§ï¼Œæ•°å€¼ç¨³å®šã€‚</p></li><li><p>å¦‚æœ <span class="math inline">\(H_j\)</span> æœ‰æ­£æœ‰è´Ÿï¼Œåˆ™ <spanclass="math inline">\(\varepsilon\sum_{j=0}^n|H_j|\)</span> æ˜¯å¯èƒ½éš<span class="math inline">\(n\)</span>å˜å¤§è€Œæ— é™å¢é•¿çš„ï¼Œæ•°å€¼ä¸ç¨³å®šã€‚</p></li></ul><p><strong>åªæœ‰ <span class="math inline">\(n\leqslant7\)</span> å’Œ<span class="math inline">\(n=9\)</span> çš„ Newton-Cotes å…¬å¼ <spanclass="math inline">\(H_j\)</span> æ˜¯å…¨æ­£çš„ã€‚</strong></p><h3 id="ä»£æ•°ç²¾åº¦ä¸ä½™é¡¹">ä»£æ•°ç²¾åº¦ä¸ä½™é¡¹</h3><ul><li><p>å½“ <span class="math inline">\(n\)</span> ä¸ºå¥‡æ•°æ—¶ï¼ŒNC å…¬å¼æœ‰<span class="math inline">\(n\)</span> æ¬¡ä»£æ•°ç²¾åº¦ã€‚è®¾ <spanclass="math inline">\(f\in C^{n+1}[a, b]\)</span>ï¼Œåˆ™æ€»æ˜¯ <spanclass="math inline">\(\exists\xi\in(a, b)\)</span>ï¼Œä½¿å¾—</p><p><span class="math display">\[  I(f)-Q(f)=E(f)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\int\limits_a^bp_{n+1}(x)\mathrm{d}x  \]</span></p></li><li><p>å½“ <span class="math inline">\(n\)</span> ä¸ºå¶æ•°æ—¶ï¼ŒNC å…¬å¼æœ‰<span class="math inline">\((n+1)\)</span> æ¬¡ä»£æ•°ç²¾åº¦ã€‚è®¾ <spanclass="math inline">\(f\in C^{n+2}[a, b]\)</span>ï¼Œåˆ™æ€»æ˜¯ <spanclass="math inline">\(\exists\xi\in(a, b)\)</span>ï¼Œä½¿å¾—</p><p><span class="math display">\[  I(f)-Q(f)=E(f)=\frac{f^{(n+2)}(\xi)}{(n+2)!}\int\limits_a^bxp_{n+1}(x)\mathrm{d}x  \]</span></p></li></ul><p>å¸¸ç”¨ NC å…¬å¼çš„ä½™é¡¹ï¼ˆä¹Ÿå°±æ˜¯è¯¯å·®ï¼‰ï¼š</p><ul><li>æ¢¯å½¢å…¬å¼ï¼ˆ<span class="math inline">\(n=1,h=b-a\)</span>ï¼‰ï¼š<spanclass="math inline">\(-\frac{h^3}{12}f&#39;&#39;(\eta)\)</span>ï¼›</li><li>Simpson å…¬å¼ï¼ˆ<spanclass="math inline">\(n=2,h=\frac{b-a}{2}\)</span>ï¼‰ï¼š<spanclass="math inline">\(-\frac{h^5}{90}f^{(4)}(\eta)\)</span>ï¼›</li><li>Cotes å…¬å¼ï¼ˆ<spanclass="math inline">\(n=4,h=\frac{b-a}{4}\)</span>ï¼‰ï¼š<spanclass="math inline">\(-\frac{8h^7}{945}f^{(6)}(\eta)\)</span>ã€‚</li></ul><h2 id="å¤åŒ–çš„-newton-cotes-å…¬å¼">å¤åŒ–çš„ Newton-Cotes å…¬å¼</h2><p>æ‰€è°“ã€Œå¤åŒ–ã€ï¼Œæ˜¯æŒ‡å°†åŒºé—´ <span class="math inline">\([a, b]\)</span>è¿›è¡Œ <span class="math inline">\(n\)</span>ç­‰åˆ†åï¼Œåœ¨æ¯ä¸ªå°åŒºé—´ä¸Šç”¨ä¸€äº›ç®€å•çš„æ±‚ç§¯å…¬å¼ï¼ˆä¾‹å¦‚æ¢¯å½¢å…¬å¼æˆ– Simpsonå…¬å¼ï¼‰ï¼Œç„¶åè¿›è¡Œæ±‚å’Œã€‚</p><h3 id="å¤åŒ–çš„æ¢¯å½¢å…¬å¼">å¤åŒ–çš„æ¢¯å½¢å…¬å¼</h3><p>è®° <span class="math inline">\(h=\frac{b-a}{n}\)</span>ï¼Œ<spanclass="math inline">\(x_i=x_0+ih\)</span>ã€‚</p><p><span class="math display">\[\begin{aligned}T_n&amp;=\sum_{i=0}^{n-1}\frac{h}{2}(f(x_i)+f(x_{i+1})) \\&amp;= \frac{h}{2}(f(a)+2\sum_{i=1}^{n-1}f(x_i)+f(b))\end{aligned}\]</span></p><p>å¦‚æœåœ¨ <span class="math inline">\(T_n\)</span>çš„åŸºç¡€ä¸Šï¼Œå°†æ¯ä¸ªåŒºé—´å¹³åˆ†ï¼Œå³ <span class="math inline">\([x_i,x_{i+1}]\to[x_i, x_{i+\frac{1}{2}}], [x_{i+\frac{1}{2}},x_{i+1}]\)</span>ï¼Œå¾—åˆ° <span class="math inline">\(2n\)</span>ç­‰åˆ†çš„å¤åŒ–æ¢¯å½¢å…¬å¼ <spanclass="math inline">\(T_{2n}=\frac{h}{4}\sum_{i=0}^{n-1}(f(x_i)+2f(x_{i+\frac{1}{2}})+f(x_{i+1}))\)</span>ã€‚</p><p>è®° <spanclass="math inline">\(U_n=h\sum_{i=0}^{n-1}f(x_{i+\frac{1}{2}})\)</span>ï¼Œæœ‰</p><p><span class="math display">\[T_{2n}=\frac{1}{2}(T_n+U_n)\]</span></p><p>è¿™æä¾›äº†ä¸€ç§è®¡ç®—é«˜é˜¶å¤åŒ–æ¢¯å½¢å…¬å¼çš„æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œè¦è®¡ç®— <spanclass="math inline">\(T_8\)</span>ï¼Œåªè¦æŒ‰ <spanclass="math inline">\(T_1\to T_2\to T_4\to T_8\)</span>çš„é¡ºåºç®—å°±å¯ä»¥äº†ã€‚</p><h3 id="å¤åŒ–çš„-simpson-å…¬å¼">å¤åŒ–çš„ Simpson å…¬å¼</h3><p>è®° <span class="math inline">\(h=\frac{b-a}n\)</span>ï¼Œ<spanclass="math inline">\(x_i=x_0+ih\)</span>ã€‚</p><p><span class="math display">\[\begin{aligned}S_n&amp;=\frac{h}6\sum_{i=0}^{n-1}(f(x_i)+4f(x_{i+\frac{1}{2}})+f(x_{i+1}))\\ &amp;=\frac{h}6(f(a)+4\sum_{i=0}^{n-1}f(x_{i+\frac{1}{2}})+2\sum_{i=1}^{n-1}f(x_i)+f(b))\\&amp;=\frac{1}{3}T_n+\frac{2}{3}U_n=\frac{4T_{2n}-T_n}{3}\end{aligned}\]</span></p><p>å³ï¼Œç”¨é«˜ä¸€é˜¶çš„å¤åŒ–æ¢¯å½¢å…¬å¼å°±å¯ä»¥è®¡ç®—å‡ºå¤åŒ– Simpsonå…¬å¼ã€‚è¿™ç§è®¡ç®—æ–¹å¼æ¯”è¾ƒæ–¹ä¾¿ã€‚</p><h3 id="å¤åŒ–çš„-cotes-å…¬å¼">å¤åŒ–çš„ Cotes å…¬å¼</h3><p><span class="math display">\[C_n=\frac{h}{90}(7f(a)+32\sum_{i=0}^{n-1}f(x_{i+\frac{1}{4}})+12\sum_{i=0}^{n-1}f(x_{i+\frac{1}{2}})+32\sum_{i=0}^{n-1}f(x_{i+\frac{3}{4}})+14\sum_{i=1}^{n-1}f(x_i)+7f(b))\]</span></p><p>ä½¿ç”¨ <span class="math inline">\(S_{2n}\)</span> å’Œ <spanclass="math inline">\(S_n\)</span> è¡¨ç¤ºï¼š</p><p><span class="math display">\[C_n=\frac{4^2S_{2n}-S_{n}}{4^2-1}\]</span></p>]]></content>
    
    
    <categories>
      
      <category>è¯¾ç¨‹ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Computation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®¡ç®—æ–¹æ³•:æ’å€¼ä¸æ•°å€¼é€¼è¿‘</title>
    <link href="/%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-%E6%8F%92%E5%80%BC%E4%B8%8E%E6%95%B0%E5%80%BC%E9%80%BC%E8%BF%91.html"/>
    <url>/%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95-%E6%8F%92%E5%80%BC%E4%B8%8E%E6%95%B0%E5%80%BC%E9%80%BC%E8%BF%91.html</url>
    
    <content type="html"><![CDATA[<h2 id="å¤šé¡¹å¼æ’å€¼">å¤šé¡¹å¼æ’å€¼</h2><p>å¤šé¡¹å¼æ’å€¼è¦åšçš„å°±æ˜¯,æ‰¾ä¸€ä¸ªå¤šé¡¹å¼ <spanclass="math inline">\(y(x)=a_0+a_1x+a_2x^2+\cdots+a_nx^n\)</span>æ¥è¿‘ä¼¼ä»»æ„å‡½æ•° <span class="math inline">\(f(x)\)</span>ã€‚</p><p>ä¸ºäº†è®©æ’å€¼å°½é‡ç²¾ç¡®ï¼Œæˆ‘ä»¬è®© <span class="math inline">\(y(x)\)</span>ç»è¿‡æ‰€æœ‰çš„ <spanclass="math inline">\(x_i\)</span>ï¼ˆæ’å€¼èŠ‚ç‚¹ï¼‰ã€‚è¿™æ ·å°±å¾—åˆ°ï¼š</p><p><span class="math display">\[\left\{\begin{aligned}a_0+a_1x_0+a_2x_0^2+\cdots+a_nx_0^n&amp;=f(x_0)\\a_0+a_1x_1+a_2x_1^2+\cdots+a_nx_1^n&amp;=f(x_1)\\&amp;\vdots \\a_0+a_1x_n+a_2x_n^2+\cdots+a_nx_n^n&amp;=f(x_n)\\\end{aligned}\right.\]</span></p><p>æ˜¾ç„¶è¿™ä¸ªæ–¹ç¨‹ç»„çš„è§£æ˜¯å”¯ä¸€çš„ï¼Œå³ï¼šå¤šé¡¹å¼æ’å€¼å…·æœ‰å”¯ä¸€æ€§ã€‚Lagrangeæ’å€¼ã€Newtonæ’å€¼ç­‰åªæ˜¯å¾—åˆ°è¿™ä¸ªæ–¹ç¨‹ç»„çš„è§£çš„ä¸åŒæ–¹å¼ï¼Œæœ€ç»ˆå¾—åˆ°çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="lagrange-æ’å€¼">Lagrange æ’å€¼</h2><h3 id="è®¡ç®—">è®¡ç®—</h3><p><span class="math display">\[L(x)=\sum_{j=0}^nf(x_j)l_j(x)\]</span></p><p>å…¶ä¸­</p><p><span class="math display">\[\begin{aligned}l_j(x)&amp;=\frac{(x-x_0)(x-x_1)\cdots(x-x_{j-1})(x-x_{j+1})\cdots(x-x_n)}{(x_j-x_0)(x_j-x_1)\cdots(x_j-x_{j-1})(x_j-x_{j+1})\cdots(x_j-x_n)}\\&amp;= \prod_{i=0, i\neq j}^n\frac{x-x_i}{x_j-x_i}\end{aligned}\]</span></p><p>äº‹å®ä¸Šï¼Œ<span class="math inline">\(l_j(x)\)</span> çš„æœ¬è´¨å°±æ˜¯ <spanclass="math display">\[\left\{\begin{aligned}&amp;0, x\neq x_j\\ &amp;1, x=x_j\end{aligned}\right.\]</span> ç±»ä¼¼å¸ƒå°”å‡½æ•°.</p><p>è¢«æ’å‡½æ•°å¯ä»¥è¡¨ç¤ºä¸º <spanclass="math inline">\(f(x)=L(x)+E(x)\)</span>ï¼Œå…¶ä¸­ <spanclass="math inline">\(E(x)\)</span> å³ä¸ºè¯¯å·®ï¼ˆåˆå«ã€Œæ’å€¼ä½™é¡¹ã€ï¼‰ã€‚</p><h3 id="è¯¯å·®-ä½™é¡¹">è¯¯å·® / ä½™é¡¹</h3><p><span class="math display">\[E(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}p_{n+1}(x),p_{n+1}(x)=(x-x_0)(x-x_1)\cdots(x-x_n)\]</span></p><p>å…¶ä¸­ <span class="math inline">\(\xi\in(a, b)\)</span>ã€‚</p><p>å®¹æ˜“å¾—åˆ°è¯¯å·®ä¸Šé™ <spanclass="math inline">\(|E(x)|\leqslant\frac{\max\limits_{a&lt;x&lt;b}f^{(n+1)}(x)}{(n+1)!}p_{n+1}(x)\)</span>ã€‚äº‹å®ä¸Šï¼Œå› ä¸ºå¤šé¡¹å¼æ’å€¼æ˜¯å”¯ä¸€çš„ï¼Œæ‰€æœ‰å¤šé¡¹å¼æ’å€¼çš„è¯¯å·®å’Œä¸Šé™éƒ½æ˜¯è¿™ä¸ªä¸œè¥¿ã€‚</p><h2 id="newton-æ’å€¼">Newton æ’å€¼</h2><h3 id="è®¡ç®—-1">è®¡ç®—</h3><p>å°† <span class="math inline">\(n\)</span>æ¬¡æ’å€¼å¤šé¡¹å¼å†™æˆå¦‚ä¸‹çš„å½¢å¼ï¼š</p><p><span class="math display">\[y(x)=a_0+a_1(x-x_0)+a_2(x-x_0)(x-x_1)+\cdots+a_n(x-x_0)(x-x_1)\cdots(x-x_{n+1})\]</span></p><p>å…¶ä¸­ï¼š</p><p><span class="math display">\[\begin{aligned}a_0 &amp;= f(x_0)\\a_1 &amp;= \frac{f(x_1)-f(x_0)}{x_1-x_0} \\a_2 &amp;=\frac{\frac{f(x_2)-f(x_0)}{x_2-x_0}-\frac{f(x_1)-f(x_0)}{x_1-x_0}}{x_2-x_1}\\&amp;\cdots\end{aligned}\]</span></p><p>ä¸ºäº†ä¾¿äºè¡¨ç¤ºï¼Œå¼•å…¥å·®å•†çš„å®šä¹‰ã€‚</p><h3 id="å·®å•†">å·®å•†</h3><p><span class="math display">\[\begin{aligned}f[x_0 x_1] &amp;= \frac{f(x_1)-f(x_0)}{x_1-x_0} \\f[x_0x_1x_2] &amp;= \frac{f[x_0x_2]-f[x_0x_1]}{x_2-x_1} \\f[x_0x_1x_2x_3] &amp;= \frac{f[x_0x_1x_3]-f[x_0x_1x_2]}{x_3-x_2} \\&amp;\cdots \\f[x_0x_1\cdots x_k] &amp;= \frac{f[x_0x_1\cdotsx_{k-2}x_k]-f[x_0x_1\cdots x_{k-2}x_{k-1}]}{x_k-x_{k-1}}\end{aligned}\]</span></p><p>ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡ç§°ã€Œä¸€é˜¶å·®å•†ã€ã€ŒäºŒé˜¶å·®å•†ã€â€¦â€¦ã€Œ<spanclass="math inline">\(k\)</span> é˜¶å·®å•†ã€ã€‚å¯ä»¥è¯æ˜ï¼Œ<spanclass="math inline">\(a_k=f[x_0x_1\cdots x_k], k=0, 1, 2, \cdots,n\)</span>ã€‚</p><p>ç”¨å·®å•†è¡¨ç¤ºçš„ Newton æ’å€¼å¤šé¡¹å¼ï¼š</p><p><span class="math display">\[N_n(x)=f(x_0)+f[x_0x_1](x-x_0)+f[x_0x_1x_2](x-x_0)(x-x_1)+\cdots+f[x_0x_1\cdotsx_n](x-x_0)\cdots(x-x_{n-1})\]</span></p><h3 id="è¯¯å·®-ä½™é¡¹-1">è¯¯å·® / ä½™é¡¹</h3><p><span class="math display">\[E(x)=f[x_0x_1\cdots x_nx](x-x_0)(x-x_1)\cdots(x-x_n)\]</span></p><p>ç”±äºå¤šé¡¹å¼æ’å€¼çš„å”¯ä¸€æ€§ï¼Œè¿™ä¸ªå¼å­çš„å€¼å’Œ Lagrangeæ’å€¼çš„ä½™é¡¹æ˜¯ç›¸ç­‰çš„ï¼Œç”±æ­¤å¯ä»¥å¾—åˆ°å·®å•†å’Œå¯¼æ•°çš„å…³ç³»ï¼š</p><p><span class="math display">\[f[x_0x_1\cdots x_j]=\frac{f^{(j)}(\xi_j)}{j!}\]</span></p><p>å…¶ä¸­ <span class="math inline">\(\xi_j\in(x_0, x_j)\)</span>ã€‚</p><h2 id="å·®åˆ†ä¸ç­‰è·èŠ‚ç‚¹çš„æ’å€¼">å·®åˆ†ä¸ç­‰è·èŠ‚ç‚¹çš„æ’å€¼</h2><h3 id="å·®åˆ†">å·®åˆ†</h3><ul><li><span class="math inline">\(k\)</span> é˜¶å‘å‰å·®åˆ†ï¼š<spanclass="math inline">\(\Delta^kf(x)=\Delta^{k-1}f(x+h)-\Delta^{k-1}f(x)\)</span>ï¼›</li><li>0 é˜¶å‘å‰å·®åˆ†ï¼š<spanclass="math inline">\(\Delta^0f(x)=f(x)\)</span>ï¼›</li><li><span class="math inline">\(k\)</span> é˜¶å‘åå·®åˆ†ï¼š<spanclass="math inline">\(\nabla^kf(x)=\nabla^{k-1}f(x)-\nabla^{k-1}f(x-h)\)</span>ï¼›</li><li>0 é˜¶å‘åå·®åˆ†ï¼š<spanclass="math inline">\(\nabla^0f(x)=f(x)\)</span>ï¼›</li><li><span class="math inline">\(k\)</span> é˜¶ä¸­å¿ƒå·®åˆ†ï¼š<spanclass="math inline">\(\delta^kf(x)=\delta^{k-1}f(x+\frac{h}{2})-\delta^{k-1}f(x-\frac{h}{2})\)</span>ï¼›</li><li>0 é˜¶ä¸­å¿ƒå·®åˆ†ï¼š<spanclass="math inline">\(\delta^0f(x)=f(x)\)</span>ã€‚</li></ul><p>å‘å‰å·®åˆ†ä¸å·®å•†çš„å…³ç³»ï¼š<span class="math inline">\(f[x_0x_1\cdotsx_k]=\frac{\Delta^kf_0}{k!h^k}=\frac{\nabla^kf_k}{k!h^k}\)</span>ã€‚</p><h3 id="newton-å‘å‰æ’å€¼å…¬å¼">Newton å‘å‰æ’å€¼å…¬å¼</h3><p>ç”¨å·®åˆ†ä»£æ›¿ Newton æ’å€¼å…¬å¼ä¸­çš„å·®å•†ï¼š</p><p><span class="math display">\[\begin{aligned}N_n(x) =\Delta^0f_0&amp;+\frac{\Delta^1f_0}{h}(x-x_0)+\frac{\Delta^2f_0}{2!h^2}(x-x_1)(x-x_0)+\cdots\\ &amp;+\frac{\Delta^nf_0}{n!h^n}(x-x_{n-1})(x-x_{n-2})\cdots(x-x_0)\end{aligned}\]</span></p><p>ç”¨ <span class="math inline">\(x_0+th\)</span> ä»£æ›¿ <spanclass="math inline">\(x\)</span>ï¼š</p><p><span class="math display">\[\begin{aligned}N_n(x_0+th) &amp;= \Delta^0f_0+\Delta^1f_0t+\Delta^2f_0\frac{t(t-1)}{2!}+\cdots+\Delta^nf_0\frac{t(t-1)\cdots(t-(n-1))}{n!} \\&amp;= \sum_{j=0}^n\Delta^jf_0\frac{t(t-1)(t-2)\cdots(t-(j-1))}{j!} \\&amp;= \sum_{j=0}^n\Delta^jf_0\mathrm{C}_t^j\end{aligned}\]</span></p><p>ï¼ˆç»„åˆæ•°å…¬å¼ï¼š<spanclass="math inline">\(\mathrm{C}_n^m=\frac{n!}{m!(n-m)!}=\frac{n(n-1)(n-2)\cdots(n-(m-1))}{m!}\)</span>ã€‚å¹¿ä¹‰çš„ç»„åˆæ•°ä¸­<span class="math inline">\(n\)</span> å¯ä»¥æ˜¯è´Ÿæ•°ã€å°æ•°ï¼‰</p><h3 id="newton-å‘åæ’å€¼å…¬å¼">Newton å‘åæ’å€¼å…¬å¼</h3><p>èµ·å§‹ç‚¹é€‰ <spanclass="math inline">\(x_n\)</span>ï¼Œä½¿ç”¨å‘åçš„å·®åˆ†ï¼Œå¯ä»¥æ¨å‡ºä¸‹é¢çš„Newton å‘åæ’å€¼å…¬å¼ã€‚</p><p><span class="math display">\[\begin{aligned}N_n(x_n+th)&amp;=\sum_{j=0}^{n}\nabla^jf_n\frac{t(t+1)\cdots(t+j-2)(t+j-1)}{j!} \\&amp;=\sum_{j=0}^n\nabla^jf_n\mathrm{C}_{t+j-1}^{j}\end{aligned}\]</span></p><h2 id="å‡½æ•°çš„æœ€ä½³å¹³æ–¹é€¼è¿‘">å‡½æ•°çš„æœ€ä½³å¹³æ–¹é€¼è¿‘</h2><h3 id="é—®é¢˜æè¿°">é—®é¢˜æè¿°</h3><p>å…ˆæ¥çœ‹è¿ç»­æƒ…å†µ.ç»™å®šå‡½æ•° <span class="math inline">\(f(x)\in C[a,b],x\in[a, b];\phi_0,\phi_1,\cdots,\phi_n\)</span>æ˜¯<spanclass="math inline">\(C[a,b]\)</span>ä¸Šn+1ä¸ªçº¿æ€§æ— å…³å‡½æ•°ï¼Œæ‰¾ä¸€ä¸ª <spanclass="math inline">\(\phi^*(x)\in\Phi(x)=\mathrm{span}\{\phi_0(x),\phi_1(x), \cdots, \phi_n(x)\}\)</span>ï¼Œä½¿å¾—</p><p><span class="math display">\[\int\limits_a^b\rho(x)(f(x)-\phi^*(x))^2\mathrm{d}x=\min_{\phi(x)\in\Phi(x)}\int\limits_a^b\rho(x)(f(x)-\phi(x))^2\mathrm{d}x\]</span></p><p>å³å·¦ä¾§çš„ç§¯åˆ†å¼å–å¾—æœ€å°å€¼ã€‚å¼ä¸­ <spanclass="math inline">\(\rho(x)\)</span> æ˜¯æƒå‡½æ•°ï¼Œæ»¡è¶³ï¼š</p><ul><li><span class="math inline">\(\rho(x)\geqslant 0, \forall x\in[a,b]\)</span>ï¼›</li><li><span class="math inline">\(\int_a^b\rho(x)x^k\mathrm{d}x\)</span>å­˜åœ¨ï¼Œ<span class="math inline">\(\forall k=0, 1, 2,\cdots\)</span>ï¼›</li><li>å¯¹ä»»ä½•éè´Ÿå‡½æ•° <span class="math inline">\(f(x)\)</span>ï¼Œè‹¥ <spanclass="math inline">\(\int_a^bf(x)\rho(x)\mathrm{d}x=0\)</span>ï¼Œåˆ™<span class="math inline">\(f(x)\equiv0\)</span>ã€‚</li></ul><h3 id="æ±‚è§£">æ±‚è§£</h3><p>è®° <spanclass="math inline">\(\phi^*(x)=a_0\phi_0(x)+a_1\phi_1(x)+\cdots+a_n\phi_n(x)\)</span>ã€‚</p><p>è®° <span class="math inline">\(||f-\phi^*||_2^2=F(a_0, a_1, \cdots,a_n)=\int_a^b\rho(x)(f(x)-\phi^*(x))^2\mathrm{d}x\)</span>ã€‚ä»¤ <spanclass="math inline">\(\frac{\partial F}{\partial a_j}=0\)</span>ï¼Œæœ‰</p><p><span class="math display">\[\begin{aligned}\int\limits_a^b\rho(x)f(x)\phi_j(x)\mathrm{d}x =a_0\int\limits_a^b\rho(x)\phi_0(x)\phi_j(x)\mathrm{d}x&amp;+a_1\int\limits_a^b\rho(x)\phi_1(x)\phi_j(x)\mathrm{d}x+\cdots\\&amp;+ a_n\int\limits_a^b\rho(x)\phi_n(x)\phi_j(x)\mathrm{d}x\end{aligned}\]</span></p><p>è®° <span class="math inline">\((f, g)\)</span> ä¸º <spanclass="math inline">\(\int_a^b\rho(x)f(x)g(x)\mathrm{d}x\)</span>ã€‚ä»¤<span class="math inline">\(F\)</span>çš„æ‰€æœ‰åå¯¼ä¸ºé›¶ï¼Œå¾—åˆ°ä¸‹é¢çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š</p><p><span class="math display">\[\left[\begin{matrix}(\phi_0,\phi_0) &amp; (\phi_1, \phi_0) &amp; \cdots &amp; (\phi_n,\phi_0) \\(\phi_0,\phi_1) &amp; (\phi_1, \phi_1) &amp; \cdots &amp; (\phi_n,\phi_1) \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\(\phi_0,\phi_n) &amp; (\phi_1, \phi_n) &amp; \cdots &amp; (\phi_n,\phi_n) \\\end{matrix}\right]\left[\begin{matrix}a_0 \\ a_1 \\\vdots\\a_n\end{matrix}\right]=\left[\begin{matrix}(f, \phi_0)\\(f, \phi_1)\\\vdots \\(f, \phi_n) \\\end{matrix}\right]\]</span></p><p>æ±‚è§£è¿™ä¸ªæ–¹ç¨‹ç»„ï¼Œå³å¯å¾—åˆ°æœ€ä½³å¹³æ–¹é€¼è¿‘æ—¶çš„ç³»æ•°ã€‚</p><h3 id="è¯¯å·®">è¯¯å·®</h3><p>è®° <span class="math inline">\(f-\phi^*(x)=\delta\)</span>ï¼Œè®° <spanclass="math inline">\(||\delta||_2^2\)</span>ä¸ºã€Œå¹³æ–¹è¯¯å·®ã€ï¼Œè®°å®ƒçš„å¹³æ–¹æ ¹ <spanclass="math inline">\(||\delta||_2\)</span> ä¸ºã€Œå‡æ–¹è¯¯å·®ã€ã€‚</p><p><span class="math display">\[\begin{aligned}||\delta||_2^2&amp;=||f-\phi^*||_2^2=(f, f)-(\phi^*, f)\\&amp;=||f||_2^2-\sum_{j=0}^na_j^*(\phi_j, f)\end{aligned}\]</span></p><h3 id="æ­£äº¤å‡½æ•°ä¸æ­£äº¤å¤šé¡¹å¼">æ­£äº¤å‡½æ•°ä¸æ­£äº¤å¤šé¡¹å¼</h3><p>å¯¹ <span class="math inline">\(f(x),g(x)\in C[a, b]\)</span>ï¼Œè®°<spanclass="math inline">\((f,g)=\int_a^b\rho(x)f(x)g(x)\mathrm{d}x\)</span>ï¼Œè‹¥<span class="math inline">\((f,g)=0\)</span>ï¼Œç§° <spanclass="math inline">\(f(x)\)</span>ã€<spanclass="math inline">\(g(x)\)</span> åœ¨ <spanclass="math inline">\([a,b]\)</span> ä¸Šå¸¦æƒ <spanclass="math inline">\(\rho(x)\)</span> æ­£äº¤ï¼Œè®°ä½œ <spanclass="math inline">\(f\bot g\)</span>ã€‚</p><p>å¦‚æœå‡½æ•°åºåˆ— <spanclass="math inline">\(\{\phi_j\}_0^{+\infty}\)</span> åœ¨ <spanclass="math inline">\([a, b]\)</span> ä¸Šä¸¤ä¸¤å¸¦æƒ <spanclass="math inline">\(\rho(x)\)</span> æ­£äº¤ï¼Œç§° <spanclass="math inline">\(\{\phi_j\}\)</span> ä¸º <spanclass="math inline">\([a, b]\)</span> ä¸Šå¸¦æƒ <spanclass="math inline">\(\rho(x)\)</span> çš„æ­£äº¤å‡½æ•°æ—ã€‚</p><p>ä¾‹å¦‚ï¼š<span class="math inline">\(1, \sin x, \cos x, \sin 2x, \cos2x, \cdots\)</span> æ˜¯åœ¨ <span class="math inline">\([-\pi,\pi]\)</span>ä¸Šå¸¦æƒ <span class="math inline">\(\rho(x)\equiv1\)</span>çš„æ­£äº¤å‡½æ•°æ—ï¼Œå› ä¸º</p><p><span class="math display">\[\begin{aligned}(1, 1)&amp;=\int\limits_{-\pi}^{\pi}\mathrm{d}x=2\pi\\(\sin nx, \sin mx)&amp;=\int\limits_{-\pi}^\pi\sin nx\sinmx\mathrm{d}x=\left\{\begin{aligned}&amp;\pi,m=n\\&amp;0, m\neqn\end{aligned}\right. \\(\cos nx, \cos mx)&amp;=\int\limits_{-\pi}^\pi\cos nx\cosmx\mathrm{d}x=\left\{\begin{aligned}&amp;\pi,m=n\\&amp;0, m\neqn\end{aligned}\right. \\(\cos nx, \sin mx)&amp;=\int\limits_{-\pi}^\pi\cos nx\sinmx\mathrm{d}x=0 \\\end{aligned}\]</span></p><p>å¦‚æœ <span class="math inline">\(\phi_n(x)\)</span> ä¸ºé¦–é¡¹ç³»æ•°éé›¶çš„<span class="math inline">\(n\)</span> æ¬¡å¤šé¡¹å¼ï¼Œç§° <spanclass="math inline">\(\{\phi_j\}\)</span> ä¸ºæ­£äº¤å¤šé¡¹å¼æ—ã€‚</p><p><img src="../assets/Untitled.png" /></p><p>ä½¿ç”¨æ­£äº¤å¤šé¡¹å¼æ—ä½œä¸º <span class="math inline">\(\Phi(x)\)</span>è¿›è¡Œæœ€ä½³å¹³æ–¹é€¼è¿‘ï¼Œè¿™æ ·å¾—åˆ°çš„å·¦ä¾§çŸ©é˜µæ˜¯å¯¹è§’é˜µã€‚</p><h3 id="æ›²çº¿æ‹Ÿåˆæœ€å°äºŒä¹˜æ³•">æ›²çº¿æ‹Ÿåˆï¼ˆæœ€å°äºŒä¹˜æ³•ï¼‰</h3><p>æ›²çº¿æ‹Ÿåˆå³æ˜¯ç¦»æ•£æƒ…å†µçš„æœ€ä½³å¹³æ–¹é€¼è¿‘é—®é¢˜ã€‚ç»™å®šå·²çŸ¥ <spanclass="math inline">\((m+1)\)</span> ä¸ªæ•°æ®ç‚¹çš„ç¦»æ•£å‡½æ•° <spanclass="math inline">\(f(x), x\in[a, b]\)</span>ï¼Œæ‰¾ä¸€ä¸ª <spanclass="math inline">\(\phi^*(x)\in\Phi(x)=\mathrm{span}\{\phi_0(x),\phi_1(x), \cdots, \phi_n(x)\}\)</span>ï¼Œä½¿å¾—</p><p><span class="math display">\[||f-\phi^*||_2^2=F(a_0, a_1,\cdots,a_n)=\min_{\phi\in\Phi}\sum_{j=0}^m\rho(x_j)(f(x_j)-\phi(x_j))^2\]</span></p><p>å®šä¹‰ç¦»æ•£æƒ…å†µçš„å†…ç§¯</p><p><span class="math display">\[(f,g)=\sum_{i=0}^m\rho(x_i)f(x_i)g(x_i)\]</span></p><p>ä½¿ç”¨ä¸å‰æ–‡ç›¸åŒçš„è§£æ³•ï¼Œå¯ä»¥è§£å‡ºç³»æ•° <spanclass="math inline">\(a_i,i=0, 1, \cdots, n\)</span>ã€‚</p><p>åŒæ ·å¯ä»¥å®šä¹‰ç¦»æ•£æƒ…å†µä¸‹çš„å¹³æ–¹è¯¯å·®</p><p><span class="math display">\[||\delta||_2^2=||f-\phi^*||_2^2=\sum_{i=0}^m\rho(x_i)(f_i-\phi(x_i))^2\]</span></p><p>ä»¥åŠå‡æ–¹è¯¯å·®</p><p><span class="math display">\[||\delta||_2=\sqrt{||\delta||_2^2}=\sqrt{\sum_{i=0}^m\rho(x_i)(f_i-\phi(x_i))^2}\]</span></p><p>ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨æ›²çº¿æ‹Ÿåˆè¿™é‡Œçš„ã€Œå‡æ–¹è¯¯å·®ã€æ²¡æœ‰ã€Œå‡ã€ï¼Œå³ä¸ç”¨å°†æ ¹å·é‡Œçš„ä¸œè¥¿ä¹˜ä»¥<span class="math inline">\(\frac{1}{m}\)</span>ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>è¯¾ç¨‹ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Computation</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é¢å‘å¯¹è±¡è¯¾ç¨‹ç¬¬ä¸€ç« :JavaåŸºç¡€</title>
    <link href="/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AF%BE%E7%A8%8B%E7%AC%AC%E4%B8%80%E7%AB%A0-Java%E5%9F%BA%E7%A1%80.html"/>
    <url>/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E8%AF%BE%E7%A8%8B%E7%AC%AC%E4%B8%80%E7%AB%A0-Java%E5%9F%BA%E7%A1%80.html</url>
    
    <content type="html"><![CDATA[<h1 id="java-åŸºç¡€">Java åŸºç¡€</h1><p>å› ä¸º Java è¯­è¨€å’Œ C/C++åœ¨å¾ˆå¤šè¯­æ³•ä¸Šç›¸ä¼¼ç”šè‡³å®Œå…¨ä¸€è‡´ï¼ˆä¾‹å¦‚å„ç§æ§åˆ¶è¯­å¥ï¼‰ï¼Œå› æ­¤è¿™é‡Œåªåˆ—å‡º Java ä¸C å®¶æ—ä¸åŒçš„è¯­è¨€ç‰¹æ€§ã€‚</p><h2 id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</h2><h3 id="åŸºæœ¬æ•°æ®ç±»å‹">åŸºæœ¬æ•°æ®ç±»å‹</h3><p>Java ä¸€å…±æœ‰ 8 ç§ã€ŒåŸºæœ¬æ•°æ®ç±»å‹ã€ã€‚</p><table><thead><tr class="header"><th>ç±»å‹</th><th>ç©ºé—´</th><th>èŒƒå›´</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr class="odd"><td>byte</td><td>1 å­—èŠ‚</td><td><span class="math inline">\(-128 \text{--} 127\)</span></td><td></td></tr><tr class="even"><td>short</td><td>2 å­—èŠ‚</td><td><span class="math inline">\(-2^{15}\text{--}2^{15}-1\)</span></td><td></td></tr><tr class="odd"><td>int</td><td>4 å­—èŠ‚</td><td><span class="math inline">\(-2^{31}\text{--}2^{31} - 1\)</span></td><td></td></tr><tr class="even"><td>long</td><td>8 å­—èŠ‚</td><td><span class="math inline">\(-2^{63}\text{--}2^{63} - 1\)</span></td><td>å£°æ˜å¸¸é‡è¦åŠ ã€ŒLã€</td></tr><tr class="odd"><td>float</td><td>4 å­—èŠ‚</td><td>â€”â€”</td><td>å£°æ˜å¸¸é‡è¦åŠ ã€ŒFã€</td></tr><tr class="even"><td>double</td><td>8 å­—èŠ‚</td><td>â€”â€”</td><td>æµ®ç‚¹æ•°çš„é»˜è®¤ç±»å‹</td></tr><tr class="odd"><td>char</td><td>16 å­—èŠ‚</td><td>UTF-16</td><td></td></tr><tr class="even"><td>boolean</td><td>â€”â€”</td><td>false æˆ– true</td><td>ä¸èƒ½ç”¨ 0 å’Œé 0 ä»£æ›¿</td></tr></tbody></table><h3 id="å¼•ç”¨ç±»å‹">å¼•ç”¨ç±»å‹</h3><p>ç±» <code>class</code>ã€æ¥å£ <code>interface</code>å’Œæ•°ç»„éƒ½æ˜¯å¼•ç”¨ç±»å‹ã€‚</p><h2 id="è¾“å…¥è¾“å‡º">è¾“å…¥è¾“å‡º</h2><h3 id="è¾“å…¥">è¾“å…¥</h3><p>Java çš„æ ‡å‡†è¾“å…¥æµæ˜¯ä¸€ä¸ª <code>InputStream</code>å¯¹è±¡ï¼Œæœ‰ä¸¤ç§å¸¸ç”¨çš„è¯»å–æ–¹å¼ï¼š</p><ul><li><p>ç”¨è¯»å­—ç¬¦æµçš„æ–¹æ³•å°† <code>System.in</code> è¯»åˆ°ä¸€ä¸ª<code>BufferedReader</code> ä¸­ã€‚</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">BufferedReader</span> <span class="hljs-variable">stdin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BufferedReader</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InputStreamReader</span>(System.in));<br>stdin.readLine() <span class="hljs-comment">// &lt;= å¾—åˆ°ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure></p></li><li><p>ç”¨ <code>java.util.Scanner</code> å¯¹ <code>System.in</code>è¿›è¡Œå°è£…ã€‚</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Scanner</span> <span class="hljs-variable">stdin</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Scanner</span>(System.in);<br>stdin.nextLine() <span class="hljs-comment">// &lt;= å¾—åˆ°ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²</span><br></code></pre></td></tr></table></figure></p></li></ul><h3 id="è¾“å‡º">è¾“å‡º</h3><ul><li><code>System.out.print()</code> ä¸æ¢è¡Œè¾“å‡ºã€‚</li><li><code>System.out.println()</code> æ¢è¡Œè¾“å‡ºã€‚</li><li><code>System.out.printf()</code> æ ¼å¼åŒ–è¾“å‡ºï¼Œè¯­æ³•åŒ C æ ‡å‡†åº“çš„<code>printf()</code>ã€‚</li></ul><h2 id="æ•°ç»„">æ•°ç»„</h2><p>Java ä¸­çš„ã€Œæ•°ç»„ã€æ˜¯ç¡®å®šé•¿åº¦çš„ï¼Œä¸€ç»åˆ›å»ºå°±ä¸èƒ½å†åŠ é•¿äº†ã€‚</p><h3 id="å£°æ˜å’Œåˆ›å»º">å£°æ˜å’Œåˆ›å»º</h3><p>åœ¨åˆ›å»ºæ•°ç»„æ—¶ï¼Œè¦ä¹ˆæŒ‡å®šé•¿åº¦ï¼Œè¦ä¹ˆç»™å‡ºæ‰€æœ‰çš„é¡¹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">3</span>]; <span class="hljs-comment">// æŒ‡å®šé•¿åº¦</span><br><span class="hljs-type">double</span>[] anotherArray = <span class="hljs-keyword">new</span> <span class="hljs-title class_">double</span>[]&#123; <span class="hljs-number">2.1</span>, <span class="hljs-number">4.5</span>, <span class="hljs-number">4.2</span> &#125;; <span class="hljs-comment">// æŒ‡å®šé¡¹</span><br></code></pre></td></tr></table></figure><h3 id="é•¿åº¦å’Œç´¢å¼•">é•¿åº¦å’Œç´¢å¼•</h3><p>å¯ä»¥ä½¿ç”¨ <code>arr.length</code> å¾—åˆ°ä¸€ä¸ªæ•°ç»„çš„é•¿åº¦ã€‚æ•°ç»„çš„ä¸‹æ ‡ä» 0å¼€å§‹ï¼Œåˆ° <code>length - 1</code> ç»“æŸã€‚</p><h3 id="æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹">æ•°ç»„æ˜¯å¼•ç”¨ç±»å‹</h3><p>æ‰€è°“ã€Œå¼•ç”¨ç±»å‹ã€ï¼Œå¯ä»¥ç†è§£ä¸º Cå®¶æ—ä¸­çš„ã€ŒæŒ‡é’ˆã€ã€‚ä¸‹é¢çš„ä»£ç è§£é‡Šäº†ã€Œå¼•ç”¨ã€çš„æœ¬è´¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123; <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-number">5</span> &#125;;<br>System.out.println(arr[<span class="hljs-number">2</span>]);       <span class="hljs-comment">// æ‰“å° 2</span><br>arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[]&#123; <span class="hljs-number">7</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">9</span> &#125;;    <span class="hljs-comment">// ç°åœ¨ arr æŒ‡å‘äº†ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œæ—§çš„æ•°ç»„ä¼šè¢« JVM å›æ”¶</span><br>System.out.println(arr[<span class="hljs-number">2</span>]);       <span class="hljs-comment">// æ‰“å° 6</span><br></code></pre></td></tr></table></figure><h3 id="æ•°ç»„ä¸­çš„å¼•ç”¨ç±»å‹">æ•°ç»„ä¸­çš„å¼•ç”¨ç±»å‹</h3><p>æ€è€ƒä¸‹é¢ä»£ç çš„è¾“å‡ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">String[] name = &#123; <span class="hljs-string">&quot;HIT&quot;</span>, <span class="hljs-string">&quot;SZ&quot;</span>, <span class="hljs-string">&quot;C++&quot;</span> &#125;;<br><span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> name[<span class="hljs-number">2</span>];<br>name[<span class="hljs-number">2</span>] = <span class="hljs-string">&quot;Java&quot;</span>;<br>System.out.println(name[<span class="hljs-number">2</span>]);<br>System.out.println(s);<br></code></pre></td></tr></table></figure><p>ç»“æœä¸º</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">Java</span><br><span class="hljs-comment">C</span><span class="hljs-literal">++</span><br></code></pre></td></tr></table></figure><p>å†…å­˜æ˜ å°„å›¾ï¼š</p><figure><img src="../assets/basicOfJava_1.png" alt="basicOfJava_1" /><figcaption aria-hidden="true">basicOfJava_1</figcaption></figure><h3 id="å¤šç»´æ•°ç»„">ã€Œå¤šç»´ã€æ•°ç»„</h3><p>æ²¡æœ‰æ‰€è°“çš„ã€Œå¤šç»´æ•°ç»„ã€ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ã€Œæ•°ç»„çš„æ•°ç»„ã€ã€‚ä¾‹å¦‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[][] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">5</span>][];<br></code></pre></td></tr></table></figure><p>æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º 5 çš„ã€Œæ•°ç»„ã€æ•°ç»„ï¼Œå®ƒå†…éƒ¨çš„ 5ä¸ªæ•°ç»„å› ä¸ºç°åœ¨è¿˜æ²¡æœ‰åˆå§‹åŒ–ï¼Œæ‰€ä»¥é•¿åº¦å¯ä»¥ä¸ç»™å‡ºã€‚æˆ‘ä»¬å½“ç„¶ä¹Ÿå¯ä»¥åœ¨å®šä¹‰ç»™å‡ºæ‰€æœ‰çš„é¡¹ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">int</span>[][] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[][]&#123; &#123; <span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">2</span>&#125;, &#123;<span class="hljs-number">2</span>, <span class="hljs-number">1</span>&#125;, &#123;<span class="hljs-number">9</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>&#125; &#125;;<br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶ï¼Œå¤šç»´æ•°ç»„ä¸­çš„æ¯ä¸€è¡Œä¸ä¸€å®šè¦ä¸€æ ·é•¿ã€‚</p><h2 id="å¼‚å¸¸">å¼‚å¸¸</h2><p>Java çš„å¼‚å¸¸æ•è·ç»“æ„ä¸º <code>try</code> - <code>catch</code> -<code>finally</code>ã€‚å…¶ä¸­ <code>catch</code> å’Œ <code>finally</code>å¯ä»¥åªå‡ºç°ä¸€ä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">try</span> &#123;<br><span class="hljs-comment">// åšç‚¹å•¥</span><br>&#125; <span class="hljs-keyword">catch</span> (<span class="hljs-comment">/** å¼‚å¸¸ **/</span>) &#123;<br>    <span class="hljs-comment">// å‡ºç°å¼‚å¸¸æ—¶åšçš„äº‹</span><br>&#125; <span class="hljs-keyword">finally</span> &#123;<br>    <span class="hljs-comment">// ä¸ç®¡å‡ºç°å¼‚å¸¸ä¸å¦éƒ½è¦åšçš„äº‹</span><br>&#125;<br></code></pre></td></tr></table></figure><h2 id="ç±»ä¸å¯¹è±¡">ç±»ä¸å¯¹è±¡</h2><h3 id="å¯¹è±¡">å¯¹è±¡</h3><ol type="1"><li>å®šä¹‰ï¼šå®¢è§‚å­˜åœ¨çš„å…·ä½“å®ä½“ï¼Œå…·æœ‰æ˜ç¡®å®šä¹‰çš„çŠ¶æ€å’Œè¡Œä¸º</li><li>ç‰¹å¾ï¼šæ ‡è¯†ç¬¦ã€å±æ€§ã€æ“ä½œ<ol type="1"><li>å±æ€§ï¼šä¸å¯¹è±¡å…³è”çš„å˜é‡ï¼Œæè¿°å¯¹è±¡çš„é™æ€ç‰¹æ€§</li><li>æ“ä½œï¼šä¸å¯¹ç›¸å…³è”çš„å‡½æ•°ï¼Œæè¿°å¯¹è±¡çš„åŠ¨æ€ç‰¹æ€§</li></ol></li></ol><h3 id="ç±»">ç±»</h3><ol type="1"><li>ä¸å¯¹è±¡<ol type="1"><li>ç±»æ˜¯å¯¹è±¡çš„æŠ½è±¡ï¼Œæ˜¯åˆ›å»ºå¯¹è±¡çš„æ¨¡æ¿</li><li>å¯¹è±¡æ˜¯ç±»çš„å…·ä½“äº‹ä¾‹</li><li>åŒä¸€ä¸ªç±»å¯ä»¥å®šä¹‰å¤šä¸ªå¯¹è±¡</li></ol></li><li>äºŒè€…æ¯”è¾ƒ<ol type="1"><li>ç±»æ˜¯é™æ€çš„ï¼Œåœ¨ç¨‹åºè®¾è®¡çš„æ—¶å€™å°±å®šä¹‰å¥½äº†</li><li>å¯¹è±¡æ˜¯åŠ¨æ€çš„ï¼Œåœ¨ç¨‹åºæ‰§è¡Œçš„æ—¶å€™å¯ä»¥è¢«åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤</li></ol></li></ol><h3 id="ç±»çš„æ„é€ ">ç±»çš„æ„é€ </h3><p>ç±»çš„è®¿é—®æƒé™ï¼š</p><figure><img src="../assets/basicOfJava_2.png" alt="basicOfJava_2" /><figcaption aria-hidden="true">basicOfJava_2</figcaption></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">// è§ä¸Šè¡¨</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br><span class="hljs-keyword">private</span> String name;    <span class="hljs-comment">// private: åªæœ‰æœ¬ç±»èƒ½è®¿é—®ã€‚</span><br><span class="hljs-keyword">protected</span> <span class="hljs-type">int</span> age;      <span class="hljs-comment">// protected: åŒ…å¤–ä¸èƒ½è®¿é—®ã€‚ä½†å¦‚æœå­ç±»åœ¨åŒ…å¤–ï¼Œä¹Ÿèƒ½è®¿é—®ã€‚</span><br><span class="hljs-type">int</span> id;                 <span class="hljs-comment">// default: åŒ…å¤–ä¸èƒ½è®¿é—®ã€‚å¦‚æœå­ç±»åœ¨åŒ…å¤–ï¼Œä¹Ÿä¸èƒ½è®¿é—®ã€‚</span><br> <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> gender;  <span class="hljs-comment">// public: è°éƒ½å¯ä»¥è®¿é—®</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> &#123;<br><span class="hljs-built_in">this</span>.name = name;<br><span class="hljs-built_in">this</span>.age = age;<br>id = <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name)</span> &#123;<br><span class="hljs-built_in">this</span>(name, <span class="hljs-number">22</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="é™æ€ç±»">é™æ€ç±»</h3><ol type="1"><li>é™æ€æˆå‘˜å±äºç±»æ‰€æœ‰è€Œä¸æ˜¯æŸä¸€å…·ä½“å¯¹è±¡æ‰€æœ‰</li><li>åŠ è½½æ—¶é—´<ol type="1"><li>é™æ€æˆå‘˜åœ¨ç±»åŠ è½½çš„æ—¶å€™è¢«é™æ€åœ°åˆ†é…åœ°å€ç©ºé—´å’Œæ–¹æ³•çš„å…¥å£åœ°å€</li><li>é™æ€å±æ€§å½“ä¸”ä»…å½“åœ¨ç±»åˆæ¬¡åŠ è½½çš„æ—¶å€™åˆå§‹åŒ–</li></ol></li><li>å®ä¾‹<ol type="1"><li>éé™æ€å¯¹è±¡åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™åˆå§‹åŒ–ï¼Œå­˜åœ¨å¤šä¸ªå®ä¾‹å‰¯æœ¬ï¼Œå„ä¸ªå¯¹è±¡ä¹‹é—´çš„å‰¯æœ¬ä¸äº’ç›¸å½±å“</li><li>é™æ€å¯¹è±¡è¢«æ‰€æœ‰çš„å¯¹è±¡å…±äº«ï¼Œåœ¨å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªå‰¯æœ¬</li></ol></li><li><code>static</code>å±æ€§æ˜¯å…¨å±€å±æ€§ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ç±»åè®¿é—®ï¼Œæ‰€ä»¥åˆå«ç±»å±æ€§</li><li>è°ƒç”¨é™åˆ¶<ol type="1"><li><code>static</code> æ–¹æ³•ä¸å¯è®¿é—®é <code>static</code> çš„æ–¹æ³•ï¼šé<code>static</code> çš„å¯¹è±¡å¿…é¡»è¦å®ä¾‹åŒ–æ‰èƒ½è®¿é—®è°ƒ</li><li>é <code>static</code> çš„æ–¹æ³•å¯ä»¥è®¿é—® <code>static</code>çš„æ–¹æ³•ï¼šé€šè¿‡ç±»åè®¿é—®</li></ol></li><li>é™æ€å—<ol type="1"><li><p>å¯ä»¥æ”¾åœ¨ç±»çš„ä»»ä½•åœ°æ–¹ï¼Œç±»ä¸­å¯ä»¥æœ‰å¤šä¸ª <code>static</code>å—</p></li><li><p>è¯­æ³•ï¼š</p><p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br><span class="hljs-keyword">static</span> &#123;<br>totalNum = <span class="hljs-number">10000</span>;<br>System.out.println(<span class="hljs-string">&quot;static block run!&quot;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></p></li><li><p>ç”Ÿå‘½å‘¨æœŸï¼šåœ¨ç±»åŠ è½½çš„æ—¶å€™æ‰§è¡Œä¸”åªæ‰§è¡Œä¸€æ¬¡</p></li><li><p>ç”¨æ³•ï¼šç”¨äºåˆå§‹åŒ–é™æ€å˜é‡å’Œè°ƒç”¨é™æ€æ–¹æ³•</p></li></ol></li><li>é™æ€æ˜¯å¦ç ´åäº†é¢å‘å¯¹è±¡çš„ç‰¹æ€§ï¼Ÿ<ol type="1"><li>é™æ€å±äºç±»è€Œéå…·ä½“å¯¹è±¡</li><li>å…·æœ‰ä¸€å®šç¨‹åº¦ä¸Šçš„å…¨å±€æ€§ï¼šåˆå§‹åŒ–æ—¶åŠ è½½åˆ°å†…å­˜ï¼Œå¹¶ä¸”æ‰€æœ‰å¯¹è±¡æœ‰è®¿é—®æƒé™</li><li>ä¿æŒç±»çš„å°è£…æ€§</li></ol></li></ol>]]></content>
    
    
    <categories>
      
      <category>è¯¾ç¨‹ç¬”è®°</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Programming</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é”è¯„é“ƒèŠ½ä¹‹æ—…</title>
    <link href="/%E9%94%90%E8%AF%84%E9%93%83%E8%8A%BD%E4%B9%8B%E6%97%85.html"/>
    <url>/%E9%94%90%E8%AF%84%E9%93%83%E8%8A%BD%E4%B9%8B%E6%97%85.html</url>
    
    <content type="html"><![CDATA[<h1 id="é“ƒèŠ½ä¹‹æ—…æ‰€ä¼ è¾¾çš„">é“ƒèŠ½ä¹‹æ—…æ‰€ä¼ è¾¾çš„</h1><p>ç§°<é“ƒèŠ½ä¹‹æ—…>ä¸ºæ–°æµ·è¯šä¸‰éƒ¨æ›²ä¹‹ä¸‰å®åœ¨æ˜¯å¾ˆæœ‰é“ç†.æ²¿è¢­ç€ä¸€è´¯çš„ç¾éš¾æå†™çš„æ–‡è„‰,é“ƒèŠ½å¯¹äºç¾éš¾çš„æå†™ä¼¼ä¹æ›´ä¸ºç¿”å®,ç¾éš¾ç”šè‡³æˆä¸ºäº†æœ¬ç‰‡å‰§æƒ…çš„æ ¸å¿ƒé©±åŠ¨åŠ›,å¯¹ç¾éš¾ä¸­æƒ…æ„Ÿçš„è¡¨è¾¾ä¹Ÿæˆä¸ºäº†æœ¬ç‰‡è¡¨è¾¾çš„æ ¸å¿ƒ--ä¸åŒäºå‰ä¸¤éƒ¨ä»…ä»…ç€çœ¼äºå¯¹çˆ±æƒ…çš„æå†™,äººä¸äººä¹‹é—´çš„æ›´æ³›åŒ–çš„æƒ…æ„Ÿåœ¨æœ¬ç‰‡ä¸­è¢«æ˜¾å¼åœ°æ¨åˆ°äº†å°å‰.ä¸è®ºæ˜¯å…³é—¨æ—¶å€™ç”·ä¸»æ˜ç¡®çš„æ˜­å‘Š,å¸Œæœ›åœ¨å½“ä¸‹çš„å¹¸ç¦èƒ½å»¶ç»­æ›´ä¹…;æˆ–æ˜¯å¥³ä¸»åœ¨å…³é—¨æ—¶å¯¹åœŸåœ°ä¸Šæ›¾æœ‰çš„ç”Ÿç”Ÿä¸æ¯çš„æƒ³è±¡;äº¦æˆ–æ˜¯é—¨åçš„å¸¸ä¸–ä¸­å®é™çš„ç”Ÿæ´»,å½±ç‰‡ä¸­å‡ºç°çš„ç§ç§è¦ç´ éƒ½åœ¨è¯•å›¾è®¨è®ºç€è¿™ä»½ç¾éš¾ä¸­çš„æ³›åŒ–çš„æ„Ÿæƒ….å®ƒå…³ä¹äººä¸äººä¹‹é—´çš„ä¸€åˆ‡æƒ…æ„Ÿ,æˆ–è€…è¯´,æ­£æ˜¯äººä¸äººä¹‹é—´æœ´ç´ çš„æ¸©æƒ….</p><p>å‡ ä¹å¯ä»¥æ–­è¨€çš„æ˜¯,æ­£æ˜¯ä¸ºäº†å¤„ç†è¿™æ ·çš„æ›´æ³›åŒ–çš„æ„Ÿæƒ…,æ–°æµ·æ‰ä¼šé€‰æ‹©å…¬è·¯ç‰‡(è‡³å°‘ç®—æ˜¯æœ‰å…¬è·¯è¦ç´ çš„ç‰‡å­?)è¿™ç§å½¢å¼ä»¥åŠå…¶å¸¦æ¥çš„å´­æ–°çš„å±•å¼€æ–¹å¼.æ­£æ˜¯å¦‚æ­¤æ‰è®©æ›´å¤šäººçš„ç›¸é‡æˆä¸ºå¯èƒ½,æ‰è®©äººåœ¨æ— æƒ…çš„ç¾éš¾é¢å‰å¾—ä»¥å…ˆéªŒåœ°è®¤è¯†åˆ°æƒ…æ„Ÿçš„æ¸©åº¦.è€Œå¯¹äºæ„Ÿæƒ…çš„åéªŒå¼çš„è®¤çŸ¥åˆ™æ˜¯ç”±ç”·å¥³ä¸»è¿™æ¡çº¿æ¥å¤„ç†çš„.ä¸¤ç§ä¸åŒå±æ€§çš„å…³ç³»,åˆ†åˆ«å‹¾å‹’ç€å¯¹äºæ„Ÿæƒ…çš„å…ˆéªŒçš„å’ŒåéªŒçš„è®¤çŸ¥.</p><h1 id="ä¼ è¾¾åˆ°äº†å—">ä¼ è¾¾åˆ°äº†å—</h1><p>äº‹å®ä¸Š,ä¸¤æ¡ä¸åŒçš„å‹¾å‹’è·¯çº¿éƒ½æ²¡æœ‰å¾ˆå¥½åœ°å®Œæˆä½¿å‘½.å¯¹æƒ…æ„Ÿçš„åéªŒå¼çš„è®¤çŸ¥è¦æƒ³æˆç«‹,é¦–å…ˆè¦æ±‚çš„æ˜¯è¿™ä»½æƒ…æ„Ÿè¦å…ˆéªŒåœ°å­˜åœ¨--è€Œç‰‡ä¸­ç”·å¥³ä¸»å…³ç³»å…¶å®æ˜¯å¾ˆç¨€è–„çš„.è¯šç„¶å½±ç‰‡æœ‰ç€"å¥³ä¸»åœ¨å°æ—¶å€™åœ¨å¸¸ä¸–ä¸­å°±è§è¿‡ç”·ä¸»"è¿™ç§å™äº‹è¯¡è®¡,ä½†æ˜¯è¿™å¹¶ä¸èƒ½å¼¥è¡¥æ‹çˆ±çš„"å•è–„".ä¸€æ®µå…³ç³»å¦‚æœè¦æ›´é¦¥éƒ,åŠ¿å¿…éœ€è¦ä¸€äº›ç§å¯†çš„å™äº‹ç©ºé—´,åƒæ˜¯<å›å>ä¸­ä¸¤äººé•¿æœŸçš„äº’æ¢èº«ä½“ä½“éªŒå¯¹æ–¹çš„ç§å¯†ç”Ÿæ´»,æˆ–æ˜¯<å¤©æ°”>ä¸­åªå±äºä¸¤äººçš„å¥‹æ–—å†ç¨‹.è€Œè¿™æ ·çš„ç§å¯†ç©ºé—´åœ¨é“ƒèŠ½ä¸­æ˜¯å‡ ä¹ä¸å­˜åœ¨çš„.ç›¸æ¯”äº<å›å><å¤©æ°”>ä¸­æ–°æµ·å®æ„¿ç”¨ä¸€ä¸ªç”šè‡³å¤šä¸ªåœºæ™¯å»å•ç‹¬å‘ˆç°ä¸»è§’é—´çš„äº’åŠ¨,æ–°æµ·å´è®©é“ƒèŠ½çš„ç”·ä¸»åœ¨å¼€åœº15åˆ†é’Ÿåå³é™·å…¥æ‰çº¿çŠ¶æ€,åæœŸä¹Ÿåªæ˜¯ä¸€ç›´ä¸ºäº†è¿½å¯»å¤§è‡£è€Œå¥”å¿™.è™½ç„¶æœ¬ç‰‡çš„æ‹çˆ±çš„ç¡®å¹³æ·¡,ä½†æ˜¯åœ¨è¿™æ ·çš„å¥”å¿™ä¹‹å,å´æ˜¯å¥³ä¸»çš„"æˆ‘è¦å»æ‰¾å–œæ¬¢çš„äººäº†"è¿™æ ·ä¸€å¥å°è¯ç›´æ¥ç‚¹æ˜äº†äº²å¯†å…³ç³»,è¿™ç§å…³ç³»çš„åšåº¦æ˜¾ç„¶æ˜¯ä¸è¶³çš„.</p><p>å…ˆéªŒå¼è®¤çŸ¥çš„æƒ…æ„Ÿå¤„ç†å¾—ä¹Ÿæœ‰åŒæ ·çš„ç¼ºä¹åšåº¦çš„é—®é¢˜.å…¬è·¯æ—…é€”ä¸Šçš„ç›¸é‡è™½ç„¶ç›´ç™½åœ°è¯•å›¾å±•ç°äººä¸äººä¹‹é—´çš„æ¸©æƒ…,ä½†æ˜¯å½±åƒä¸Šçš„å¤„ç†æ˜¯å¦‚æ­¤æ³›åŒ–,ä¸‰å¹•åœºæ™¯éƒ½åªæ˜¯ç‚¹åˆ°ä¸ºæ­¢.æ–°æµ·è¯šå½“ç„¶æ˜¯å†…æ•›çš„,ä½†æ˜¯å†…æ•›ä¸æ„å‘³ç€èœ»èœ“ç‚¹æ°´,ä¸æ„å‘³ç€ä¸»è§’è‡ªèº«æƒ…æ„Ÿå¯¹è§‚ä¼—æƒ…æ„Ÿçš„å¼•å¯¼å®Œå…¨å¤±ä½.ä¸ºä»€ä¹ˆæ˜¯å¤±ä½çš„å‘¢?å…³é—¨æ—¶æ¶Œå…¥é“ƒèŠ½è€³ä¸­çš„æ˜¯æ³›æ³›çš„è¨€è¯­å’Œå£°éŸ³,äººé—´çš„æ¸©æƒ…ç¼ºå°‘ä¸€ä¸ªç¡®åˆ‡çš„æƒ…æ„Ÿè½åœ°ç‚¹;å§¨å¦ˆå¯¹é“ƒèŠ½çš„çˆ±ä¹Ÿæ˜¯æ³›æ³›è€Œè°ˆ--å§¨å¦ˆä¸ºäº†é“ƒèŠ½åšçš„ç‰ºç‰²å‡ ä¹åªæœ‰åœ¨ä¸€æ¬¡äº‰åµä¸­è‰è‰äº¤ä»£äº†äº‹,åŒæ ·ç¼ºå°‘ç¡®åˆ‡çš„æƒ…æ„Ÿè½åœ°ç‚¹;å¦ˆå¦ˆå¯¹é“ƒèŠ½çš„çˆ±æ›´æ˜¯å‡ æ— ç¬”å¢¨,ç¾éš¾ä¸­æœ€äº²å¯†çš„äººä¹‹é—´çš„æƒ…æ„Ÿæ›´æˆä¸ºäº†æ— æ³•è½åœ°çš„ç©ºä¸­æ¥¼é˜.å½“æ„Ÿæƒ…æ— æ³•é”šå®šåœ¨ä¸€ä¸ªç¡®åˆ‡çš„æ—¶ç©ºä½ç½®,åªèƒ½æµäºæ³›æ³›,æ„Ÿæƒ…çš„åšåº¦å¿…ç„¶æ˜¯ä¸è¶³çš„.</p><p>å…³é”®åœºæ™¯çš„ç¼ºå¤±,è®©å…¨ç‰‡å¯¹ç¾éš¾çš„è¡¨è¾¾åŒæ ·æµ…å°è¾„æ­¢.åœ¨<å›å>ä¸­,æˆ‘ä»¬æœ‰é™¨çŸ³å‘ä¸Šä¸»è§’çš„ç›¸è§;åœ¨<å¤©æ°”>ä¸­,æˆ‘ä»¬æœ‰ç”·å¥³ä¸»çš„å¤©ç©ºå è½å’Œç”·ä¸»çš„é•¿è·ç¦»å¥”è·‘--ä½†é“ƒèŠ½ä¸­ç¼ºå°‘è¿™ä¹ˆä¸€ä¸ªå…·æœ‰åŠ›åº¦çš„åœºæ™¯.å”¯ä¸€çš„åŠ›åº¦å¯èƒ½ä¹Ÿåªæ˜¯æ¥è‡ªäºé“ƒèŠ½å›åˆ°è€å®¶æŒ–å‡ºçš„æ—¥è®°ä¸­å†™æœ‰3.11çš„é‚£ä¸€é¡µ,è€Œä¸”ä¹Ÿæ˜¯ä¸¥é‡ä¸è¶³çš„--å°½ç®¡å½±ç‰‡ä¸­ä¸æ—¶ç©¿æ’ç€æ¶‚é»‘æ—¥è®°çš„ç”»é¢,ä½†æ˜¯é“ƒèŠ½æ‰¾åˆ°æ—¥è®°çš„è¿‡ç¨‹æ˜¯å¦‚æ­¤é¡ºåˆ©æˆç« --æ²¡æœ‰ä»»ä½•çŠ¹è±«å’Œæ¨¡ç³Š.æ¶‚é»‘æ—¥è®°æœ¬èº«æ˜¯äººè„‘å¯¹åˆ›ä¼¤æ€§ç»å†ä¸å¯é¿å…çš„æ¨¡ç³ŠåŒ–çš„å…·è±¡,åŒ…æ‹¬å‰æ–‡é“ƒèŠ½å¯¹æ¤…å­ç¼ºè…¿çš„åŸå› çš„é—ªçƒå…¶è¾ä¹Ÿä½“ç°ç€è¿™ç§æ¨¡ç³Š,ä½†æ˜¯æ‰¾åˆ°æ—¥è®°çš„è¿‡ç¨‹å´æ²¡æœ‰ä»»ä½•æ¨¡ç³Š,ç”šè‡³åœ¨æ‰¾åˆ°æ—¥è®°åä¹Ÿæ²¡æœ‰ä»»ä½•å¯¹è¿‡å¾€è®°å¿†çš„ç¡®è®¤,3.11å°±è¿™æ ·è¢«ç›´æ¥ç³Šè„¸--ç¼ºå°‘äº†å¯¹è®°å¿†ç¢ç‰‡çš„æ•´ç†,ç¼ºå°‘äº†ç§äººåŒ–çš„æƒ…æ„Ÿä½“éªŒ,ç¼ºå°‘äº†å½±åƒä¸Šçš„è“„åŠ›å’Œè§’è‰²æƒ…æ„Ÿçš„å€¾æ³»,å•å•é€šè¿‡ä¸€ä¸ªåœºå¤–çš„ç¬¦å·,å¸¦å‡ºçš„è¡¨è¾¾åŠ›åº¦çœŸçš„è¶³å¤Ÿå—?æˆ‘çš„è¯„æ–­æ˜¯å¦å®šçš„.è€Œä½œä¸ºå…¨ç‰‡ç¾éš¾çš„é›†ä¸­è±¡å¾çš„3.11å°±è¿™æ ·è¢«è½»ææ·¡å†™,å…¨ç‰‡çš„å…³é”®åœºæ™¯ç”±æ­¤ä¸å¤å­˜åœ¨.</p><p>æˆ‘ä»¬ç”šè‡³è¿˜å¯ä»¥æ‰¹è¯„ç‰‡å­çš„æ¼”å‡ºæ‰‹æ®µ.3DLOçš„å¼•å…¥è®©æ›´å¤æ‚çš„é•œå¤´æˆä¸ºå¯èƒ½,æ¼”å‡ºä¸Šçš„å¥‡è§‚è‡ªç„¶ä¹Ÿå¤šäº†ä¸å°‘--é“ƒèŠ½å¼€å¤´å¥”è·‘çš„è·Ÿæ‘‡,æ¤…å­è¿½é€çŒ«çŒ«æ—¶çš„å¤šä¸ªè¿åŠ¨é•œå¤´...ä½†æ˜¯å¥‡è§‚å¤šäº†å°±ä¸€å®šå¥½å—?å¦‚æœå¥‡è§‚æ²¡æœ‰åœ°åŸºæ”¯æ’‘,é‚£ä¹ˆå¥‡è§‚çš„æ³›æ»¥å°±åªä¼šåƒå¯¹ç€è§‚ä¼—å–Š"ç‹¼æ¥äº†"ä¸€èˆ¬,æœ€ç»ˆä½¿å¾—å¥‡è§‚ä¹Ÿæ— æ³•è°ƒåŠ¨è§‚ä¼—çš„æ³¨æ„åŠ›.å½“ç„¶æœ¬ç‰‡ä¸å°‘å¥‡è§‚é€ çš„éƒ½ä¸é”™,ä½†æ˜¯æ€»å½’æ˜¯æœ‰é‚£ä¹ˆå‡ ä¸ªç¼ºå°‘åœ°åŸº(æ¯”å¦‚å¼€å¤´çš„è·Ÿæ‘‡).è€Œä¸”æˆ‘ä»¬è¿˜æ²¡æœ‰è¯´åˆ°è¿™äº›å¥‡è§‚ç”»é¢ä¸Šçš„ä¸åè°ƒ.</p><h1 id="é“ƒèŠ½èƒŒåçš„å…¶ä»–">é“ƒèŠ½èƒŒåçš„å…¶ä»–</h1><p>å°½ç®¡é—­é—¨å¸ˆåœ¨ç«­åŠ›é¿å…èš“å„çš„å‘ç”Ÿ,ä½†<é“ƒèŠ½>ä¸­å´æ”¾ç½®äº†ä¸€ä¸ªä¸å¯æ”¹å˜ä¸å¯é¿å…çš„"3.11".ç”±æ­¤æˆ‘ä»¬å¯ä»¥æ–­è¨€,<é“ƒèŠ½>æŸç§ç¨‹åº¦ä¸Šæ˜¯å¯¹äºç¾éš¾çš„å†è®¤çŸ¥--ä¸<ä½ çš„åå­—>ä¸­è¯•å›¾æŒ½å›ç¾éš¾ä¸­å¤±å»çš„çˆ±äºº,<å¤©æ°”ä¹‹å­>ä¸­ä¸»åŠ¨é€‰æ‹©çˆ±äººæ‹¥æŠ±ç¾éš¾ä¸åŒçš„æ˜¯,<é“ƒèŠ½>ä¸­çš„æ ¸å¿ƒç¾éš¾,ä¹Ÿå³"3.11,"é¦–å…ˆæ˜¯è¢«æ”¾åœ¨ä¸€ä¸ªä¸å¯å¤„ç½®çš„åœ°ä½çš„.å› æ­¤å½±ç‰‡çš„æ‰€æœ‰æƒ…èŠ‚éƒ½æ˜¯åœ¨æ¥å—è¿™ä¸€äº‹å®çš„åŸºç¡€ä¸ŠåŠ ä»¥å±•å¼€,è€Œå®Œå…¨ä¸åŒäºå‰ä½œä¸­çš„"åæŠ—"è¦ç´ .</p><p><é“ƒèŠ½>ä¸­çš„æ–°æµ·åœ¨å°½åŠ›å‘Šè¯‰è§‚ä¼—,æ¥å—ç¾éš¾å¹¶åšå®šåœ°ç”Ÿæ´»ä¸‹å»æ‰æ˜¯é¢å¯¹ç¾éš¾çš„è§£è¯,é¢†æ‚Ÿäº†è¿™ä¸€ç‚¹åæˆ‘ä»¬å°±èƒ½æ˜ç™½ä¸ºä»€ä¹ˆ3æ¡è…¿çš„è‰å¤ªæ¤…å­ä¾ç„¶èƒ½çµæ´»åœ°å¥”è·‘,å³ä½¿æ˜¯å¤±å»äº†æ›¾ç»æ‹¥æœ‰çš„ä¸€æ¡è…¿--å³ä½¿ç¾åå¤±å»äº†æ›¾ç»æ‹¥æœ‰çš„ç¾å¥½ç”Ÿæ´»,æˆ‘ä»¬ä¾ç„¶èƒ½æ¥å—è¿™ä¸€äº‹å®,æˆ‘ä»¬ç”Ÿæ´»å¦‚å¸¸,ç¤¾ä¼šè¿è½¬å¦‚å¸¸.</p><p>ä½†æ˜¯è¿™ç§å¦‚å¸¸çš„èƒŒåå¹¶éä¸å­˜åœ¨éšå¿§.ç¾éš¾å¸¦æ¥çš„ä¼¤ç—›çœŸçš„å°±èƒ½éšç€æ—¶é—´æµé€,éšç€ä¸€ä»½è½»ææ·¡å†™çš„"æ¥å—"ä¹‹å¿ƒ,è€Œæ•£å…¥è®°å¿†çš„é•¿æ²³ç›´è‡³æ— å½±æ— è¸ªå—?æ–°æµ·çš„å›ç­”å½“ç„¶æ˜¯å¦å®šçš„,æ­£å¦‚ä»–è‡ªè¿°çš„é‚£æ ·,"3.11"ä¾ç„¶æ˜¯ä»–åˆ›ä½œè¿‡ç¨‹ä¸­çš„æŒç»­ä½éŸ³;æ­£å¦‚å½±ç‰‡ä¸­é‚£åº§æ¸¸ä¹åœº,å§‹ç»ˆåœç•™åœ¨äººä»¬å¿ƒä¸­æ— æ³•æŠ¹å»;æ­£å¦‚é“ƒèŠ½æ¶‚é»‘çš„ä¸€é¡µé¡µæ—¥è®°,æ€»æ˜¯åœ¨æ¢¦ä¸­é—¯å…¥å¥¹çš„æ€ç»ª.</p><p>ä¸å¦‚è¯´é“ƒèŠ½æ‰§æ„å›è€å®¶æ­£æ˜¯ä¸ºäº†å¯»æ±‚ä¸€ä»½å’Œè§£,äº‹å®ä¸Šç¾éš¾ä¸­çš„å¹¸å­˜è€…æˆ–è®¸éƒ½éœ€è¦è¿™ä»½å’Œè§£.é“ƒèŠ½åœ¨é—¨ä¸­çœ‹åˆ°çš„è¾½é˜”çš„å¸¸ä¸–,é‚£é‡Œé¢å¹¶ä¸æ˜¯æ‚²ä¼¤,è€Œæ˜¯å¤±å»äº†æƒ…æ„Ÿçš„è®°å¿†.è¿™ç§éº»æœ¨æ˜¯å€¼å¾—è­¦æƒ•çš„.å¯ä»¥çŒœæµ‹,è¦çŸ³çš„èº«ä½“ä¹‹æ‰€ä»¥å†·è‹¥å†°éœœ,æ­£æ˜¯å› ä¸ºå¯¹å¤±å»çš„å“€å¹åŒ–ä½œäº†æ— è¾¹çš„éº»æœ¨ä¸è™šæ— .å¹¸å­˜è€…ä¹Ÿå¥½,è¦çŸ³ä¹Ÿå¥½,éƒ½éœ€è¦åœ¨å¯¹ç¾éš¾çš„åå¤å®¡è§†ä¸­ç¡®è®¤ç”Ÿçš„å¯è´µ,ä»è€Œè®©ç”Ÿçš„åŠ¨åŠ›æ”¯æ’‘è‡ªå·±åœ¨æ­¤æ—¶æ­¤åœ°å¤šåœç•™ä¸€åˆ»ç”šè‡³ä¸€ç§’.</p><p><é“ƒèŠ½>å…³æ³¨çš„æ­£æ˜¯è¿™ç§"åç¾éš¾"çš„ç–—æ„ˆ,æ˜¯ç—›è‹¦èƒŒåæ›´æ·±åˆ»çš„åˆ›ä¼¤çš„å¼¥åˆè¿‡ç¨‹.æ–°æµ·ç»™å‡ºçš„å›ç­”,ä¸æ˜¯éšç€æ—¶é—´è¯•ç€é—å¿˜,è€Œæ˜¯åœ¨è¿½æ€ä¸å®¡è§†ä¸­,äº†è§£ç”Ÿçš„å¯è´µ;å½±ç‰‡ä¸­çš„ç¾éš¾ä¸å†æ˜¯ä¸€ç§éœ€è¦é¿è®³çš„è‹¦éš¾,è€Œæ˜¯éœ€è¦ç¡®è®¤çš„äººç”Ÿå¿…ç„¶.</p><p>å¯¹æ–°æµ·æ¥è¯´,è¿™ä½•å°ä¸æ˜¯ä¸€ç§è¿›æ­¥å‘¢?</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
      <category>åŠ¨ç”»</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŠ¨ç”»è¯„è®º</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
